import{r as c,a as bt,R as ft}from"./react-vendor-wGySg1uH.js";import{i as yt,g as vt,d as he,a as nt,s as Me,b as _e,c as jt,e as wt}from"./firebase-vendor-DArFBOnq.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var lt={exports:{}},We={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var St=c,Nt=Symbol.for("react.element"),Et=Symbol.for("react.fragment"),Rt=Object.prototype.hasOwnProperty,Dt=St.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ct={key:!0,ref:!0,__self:!0,__source:!0};function ot(t,s,r){var a,n={},l=null,m=null;r!==void 0&&(l=""+r),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(m=s.ref);for(a in s)Rt.call(s,a)&&!Ct.hasOwnProperty(a)&&(n[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:Nt,type:t,key:l,ref:m,props:n,_owner:Dt.current}}We.Fragment=Et;We.jsx=ot;We.jsxs=ot;lt.exports=We;var e=lt.exports,ze={},Qe=bt;ze.createRoot=Qe.createRoot,ze.hydrateRoot=Qe.hydrateRoot;const Pe="workout_tracker_";class Fe extends Error{constructor(s,r,a){super(s),this.name="StorageError",this.operation=r,this.key=a}}function kt(){try{const t="__storage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch{return!1}}function He(t){return`${Pe}${t}`}function it(t,s=null){try{const r=He(t),a=localStorage.getItem(r);if(a===null)return s;try{return JSON.parse(a)}catch{return a}}catch(r){throw console.error(`Storage get error for key "${t}":`,r),new Fe(`Failed to get item: ${r.message}`,"get",t)}}function ct(t,s){try{const r=He(t),a=JSON.stringify(s);return localStorage.setItem(r,a),!0}catch(r){throw console.error(`Storage set error for key "${t}":`,r),r.name==="QuotaExceededError"?new Fe("Storage quota exceeded. Please clear some data.","set",t):new Fe(`Failed to set item: ${r.message}`,"set",t)}}function Ft(t){try{const s=He(t);return localStorage.removeItem(s),!0}catch(s){throw console.error(`Storage remove error for key "${t}":`,s),new Fe(`Failed to remove item: ${s.message}`,"remove",t)}}function Tt(){try{return Object.keys(localStorage).forEach(s=>{s.startsWith(Pe)&&localStorage.removeItem(s)}),!0}catch(t){throw console.error("Storage clear error:",t),new Fe(`Failed to clear storage: ${t.message}`,"clear",null)}}function At(){try{return Object.keys(localStorage).filter(s=>s.startsWith(Pe)).map(s=>s.replace(Pe,""))}catch(t){throw console.error("Storage getAllKeys error:",t),new Fe(`Failed to get keys: ${t.message}`,"getAllKeys",null)}}function dt(){try{let t=0;return Object.keys(localStorage).forEach(r=>{if(r.startsWith(Pe)){const a=localStorage.getItem(r);a&&(t+=r.length+a.length)}}),t*2}catch(t){return console.error("Storage size calculation error:",t),0}}function Lt(){const t=dt();return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(2)} KB`:`${(t/(1024*1024)).toFixed(2)} MB`}function Pt(t){try{const s=He(t);return localStorage.getItem(s)!==null}catch(s){return console.error(`Storage hasKey error for "${t}":`,s),!1}}function Mt(t){const s={};return t.forEach(r=>{try{s[r]=it(r)}catch(a){console.error(`Error getting key "${r}":`,a),s[r]=null}}),s}function _t(t){try{return Object.entries(t).forEach(([s,r])=>{ct(s,r)}),!0}catch(s){return console.error("Error setting multiple items:",s),!1}}function It(t,s=null){try{return t()}catch(r){return console.error("Storage operation failed:",r),s}}const ie={isAvailable:kt,get:it,set:ct,remove:Ft,clear:Tt,getAllKeys:At,getSize:dt,getSizeFormatted:Lt,hasKey:Pt,getMultiple:Mt,setMultiple:_t,safe:It},J={LOCAL_RECOVERY_RATE:.2,SYSTEMIC_RECOVERY_RATE:.25,RIR_DECAY_CONSTANT:.3,PRIMARY_MUSCLE_MULTIPLIER:1,SECONDARY_MUSCLE_MULTIPLIER:.5,TERTIARY_MUSCLE_MULTIPLIER:.25,AXIAL_LOAD_MULTIPLIER:1.15,COMPOUND_SYSTEMIC_MULTIPLIER:1.2,RIR_MISS_FATIGUE_PENALTY:.15,SORENESS_FATIGUE_WEIGHT:.4,PERCEIVED_FATIGUE_WEIGHT:.3,STIMULUS_DECAY_RATE:.14,PROGRESSION_THRESHOLD:.85,DELOAD_THRESHOLD:.5,DELOAD_TRACKING_DAYS:7,DELOAD_MIN_CONDITIONS:2,PERFORMANCE_ERROR_THRESHOLD:-1,PERFORMANCE_ERROR_SESSIONS:2,USE_EPLEY_FORMULA:!0,BASE_FATIGUE_PER_SET:.033,MAX_FATIGUE_THRESHOLD:.6},Ke={RIR_PROGRESSION_THRESHOLD:1,OPTIMAL_SETS_PER_WEEK:15,MAX_WEEKLY_STIMULUS:25},ce={USER_ID:"userId",USERNAME:"username",ACTIVE_PROGRAM:t=>`ap_${t}`,CURRENT_DAY_INDEX:t=>`cdi_${t}`,THEME_PREFERENCE:"theme",LAST_SYNC:"lastSync"},ee={EXERCISES:"exercises",WORKOUTS:"workouts",PROGRAMS:"programs",FATIGUE:"fatigue",USER_PREFERENCES:"preferences"},$t={apiKey:"AIzaSyC_nkyWikwTCHDIBOvpXkEvk7Cfl8w5GLE",authDomain:"workout-tracker-e57d4.firebaseapp.com",projectId:"workout-tracker-e57d4",storageBucket:"workout-tracker-e57d4.firebasestorage.app",messagingSenderId:"20708564104",appId:"1:20708564104:web:e7457b6f3fc63cd271933d"},Ot=yt($t),de=vt(Ot);class te extends Error{constructor(s,r,a){super(s),this.name="DatabaseError",this.operation=r,this.collection=a}}async function Ut(t,s){try{const r=he(de,t,"data");return await Me(r,{items:s,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved to ${t}:`,s.length,"items"),!0}catch(r){throw console.error(`âŒ Save error for ${t}:`,r),new te(`Failed to save collection: ${r.message}`,"save",t)}}async function Wt(t){try{const s=await jt(wt(de,t));let r=[];return s.forEach(a=>{a.id==="data"&&a.data().items&&(r=a.data().items)}),console.log(`âœ… Loaded from ${t}:`,r.length,"items"),r}catch(s){throw console.error(`âŒ Load error for ${t}:`,s),new te(`Failed to load collection: ${s.message}`,"load",t)}}async function Ht(t,s,r){if(!r)throw new te("User ID is required","saveUserData",t);try{const a=he(de,t,r);if(s===null)return await nt(a),console.log(`âœ… Deleted user data from ${t} for user ${r}`),!0;const n=Array.isArray(s)?{items:s,userId:r,updatedAt:new Date().toISOString()}:{...s,userId:r,updatedAt:new Date().toISOString()};await Me(a,n);const l=Array.isArray(s)?s.length:"object";return console.log(`âœ… Saved user data to ${t} for user ${r}:`,l,Array.isArray(s)?"items":""),!0}catch(a){throw console.error(`âŒ Save user data error for ${t}:`,a),new te(`Failed to save user data: ${a.message}`,"saveUserData",t)}}async function Bt(t,s){if(!s)throw new te("User ID is required","loadUserData",t);try{const r=he(de,t,s),a=await _e(r);if(a.exists()){const n=a.data();if(n.items&&Array.isArray(n.items))return console.log(`âœ… Loaded user data from ${t} for user ${s}:`,n.items.length,"items"),n.items;const{userId:l,updatedAt:m,...o}=n;return console.log(`âœ… Loaded user data from ${t} for user ${s}:`,"object"),o}else return console.log(`â„¹ï¸ No data found in ${t} for user ${s}`),null}catch(r){throw console.error(`âŒ Load user data error for ${t}:`,r),new te(`Failed to load user data: ${r.message}`,"loadUserData",t)}}async function Gt(t,s){if(!s)throw new te("User ID is required","getUserData",t);try{const r=he(de,t,s),a=await _e(r);if(a.exists()){const n=a.data(),{userId:l,updatedAt:m,...o}=n;return console.log(`âœ… Loaded user data from ${t} for user ${s}`),o}else return console.log(`â„¹ï¸ No data found in ${t} for user ${s}`),null}catch(r){throw console.error(`âŒ Get user data error for ${t}:`,r),new te(`Failed to get user data: ${r.message}`,"getUserData",t)}}async function Vt(t,s){if(!t)throw new te("User ID is required","saveFatigueState",ee.FATIGUE);try{const r=he(de,ee.FATIGUE,t);return await Me(r,{...s,userId:t,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved fatigue state for user ${t}`),!0}catch(r){throw console.error("âŒ Save fatigue state error:",r),new te(`Failed to save fatigue state: ${r.message}`,"saveFatigueState",ee.FATIGUE)}}async function Yt(t){if(!t)throw new te("User ID is required","loadFatigueState",ee.FATIGUE);try{const s=he(de,ee.FATIGUE,t),r=await _e(s);if(r.exists()){const a=r.data();return console.log(`âœ… Loaded fatigue state for user ${t}`),a}else return console.log(`â„¹ï¸ No fatigue state found for user ${t}`),{}}catch(s){throw console.error("âŒ Load fatigue state error:",s),new te(`Failed to load fatigue state: ${s.message}`,"loadFatigueState",ee.FATIGUE)}}async function zt(t,s){if(!t)throw new te("User ID is required","saveActiveProgram","activeProgram");try{const r=he(de,"activeProgram",t);return s===null?(await nt(r),console.log(`âœ… Cleared active program for user ${t}`),!0):(await Me(r,{...s,userId:t,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved active program for user ${t}:`,s.programId),!0)}catch(r){throw console.error("âŒ Save active program error:",r),new te(`Failed to save active program: ${r.message}`,"saveActiveProgram","activeProgram")}}async function qt(t){if(!t)throw new te("User ID is required","loadActiveProgram","activeProgram");try{const s=he(de,"activeProgram",t),r=await _e(s);if(r.exists()){const a=r.data();return console.log(`âœ… Loaded active program for user ${t}`),a}else return console.log(`â„¹ï¸ No active program found for user ${t}`),null}catch(s){throw console.error("âŒ Load active program error:",s),new te(`Failed to load active program: ${s.message}`,"loadActiveProgram","activeProgram")}}async function Kt(t,s){if(!t)throw new te("User ID is required","saveSettings",ee.USER_PREFERENCES);try{const r=he(de,ee.USER_PREFERENCES,t);return await Me(r,{...s,userId:t,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved settings for user ${t}`),!0}catch(r){throw console.error("âŒ Save settings error:",r),new te(`Failed to save settings: ${r.message}`,"saveSettings",ee.USER_PREFERENCES)}}async function Xt(t){if(!t)throw new te("User ID is required","loadSettings",ee.USER_PREFERENCES);try{const s=he(de,ee.USER_PREFERENCES,t),r=await _e(s);if(r.exists()){const a=r.data();return console.log(`âœ… Loaded settings for user ${t}`),a}else return console.log(`â„¹ï¸ No settings found for user ${t}`),null}catch(s){throw console.error("âŒ Load settings error:",s),new te(`Failed to load settings: ${s.message}`,"loadSettings",ee.USER_PREFERENCES)}}const X={saveCollection:Ut,loadCollection:Wt,saveUserData:Ht,loadUserData:Bt,getUserData:Gt,saveFatigueState:Vt,loadFatigueState:Yt,saveActiveProgram:zt,loadActiveProgram:qt,saveSettings:Kt,loadSettings:Xt};async function Oe(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(a)).map(m=>m.toString(16).padStart(2,"0")).join("")}function ut(){const[t,s]=c.useState(null),[r,a]=c.useState(""),[n,l]=c.useState(!1),[m,o]=c.useState(!0);c.useEffect(()=>{(()=>{try{const g=ie.get(ce.USER_ID),f=ie.get(ce.USERNAME);g&&f&&(s(g),a(f),l(!0))}catch(g){console.error("Auth initialization error:",g)}finally{o(!1)}})()},[]);const i=async(d,g,f=!1)=>{if(!d||!d.trim())return{success:!1,error:"Username is required"};if(!g)return{success:!1,error:"Password is required"};const C=d.trim();try{if(f)return await S(C,g);{const j=C.toLowerCase().replace(/[^a-z0-9]/g,"_"),h=await X.getUserData("users",j);if(!h)return{success:!1,error:"Username not found. Please register first."};const F=await Oe(g);return h.passwordHash!==F?{success:!1,error:"Incorrect password"}:(ie.set(ce.USER_ID,j),ie.set(ce.USERNAME,C),s(j),a(C),l(!0),{success:!0})}}catch(j){return console.error("Login error:",j),{success:!1,error:"Failed to login. Please try again."}}},S=async(d,g)=>{if(!d||d.trim().length<3)return{success:!1,error:"Username must be at least 3 characters"};if(!g||g.length<6)return{success:!1,error:"Password must be at least 6 characters"};const f=d.trim(),C=f.toLowerCase().replace(/[^a-z0-9]/g,"_");try{if(await X.getUserData("users",C))return{success:!1,error:"Username already exists"};const h=await Oe(g),F={username:f,passwordHash:h,createdAt:new Date().toISOString()};return await X.saveUserData("users",F,C),ie.set(ce.USER_ID,C),ie.set(ce.USERNAME,f),s(C),a(f),l(!0),{success:!0}}catch(j){return console.error("Registration error:",j),{success:!1,error:"Failed to register. Please try again."}}};return{userId:t,username:r,isAuthenticated:n,isLoading:m,login:i,register:S,logout:()=>{try{return ie.remove(ce.USER_ID),ie.remove(ce.USERNAME),t&&(ie.remove(ce.ACTIVE_PROGRAM(t)),ie.remove(ce.CURRENT_DAY_INDEX(t))),s(null),a(""),l(!1),!0}catch(d){throw console.error("Logout error:",d),new Error("Failed to logout. Please try again.")}},changePassword:async(d,g)=>{if(!t)return{success:!1,error:"Not authenticated"};if(!d)return{success:!1,error:"Current password is required"};if(!g||g.length<6)return{success:!1,error:"New password must be at least 6 characters"};try{const f=await X.getUserData("users",t);if(!f)return{success:!1,error:"User not found"};const C=await Oe(d);if(f.passwordHash!==C)return{success:!1,error:"Current password is incorrect"};const j=await Oe(g),h={...f,passwordHash:j,passwordUpdatedAt:new Date().toISOString()};return await X.saveUserData("users",h,t),{success:!0}}catch(f){return console.error("Change password error:",f),{success:!1,error:"Failed to change password"}}},updateUsername:d=>{if(!d||!d.trim())throw new Error("Username is required");try{const g=d.trim();return ie.set(ce.USERNAME,g),a(g),!0}catch(g){throw console.error("Update username error:",g),new Error("Failed to update username.")}},checkAuth:()=>n&&t!==null}}function qe(t){const s=typeof t=="string"?new Date(t):t,r=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0");return`${r}-${a}-${n}`}function Jt(t,s={}){const r=typeof t=="string"?new Date(t+"T12:00:00"):t,a={year:"numeric",month:"long",day:"numeric"};return r.toLocaleDateString("en-US",{...a,...s})}function Qt(t=new Date){const s=t.getFullYear(),r=t.getMonth(),a=new Date(s,r,1),n=new Date(s,r+1,0),l=[],m=a.getDay();for(let o=0;o<m;o++)l.push(null);for(let o=1;o<=n.getDate();o++)l.push(new Date(s,r,o));return l}function Zt(t=new Date){const s=new Date(t);s.setDate(t.getDate()-t.getDay()),s.setHours(0,0,0,0);const r=new Date(s);return r.setDate(s.getDate()+7),{start:s,end:r}}function es(t){const s={};return t.forEach(r=>{const a=r.date;s[a]||(s[a]=[]),s[a].push(r)}),s}function gt(t,s,r){const a=typeof s=="string"?new Date(s):s,n=typeof r=="string"?new Date(r):r;return t.filter(l=>{const m=new Date(l.date);return m>=a&&m<=n})}function Be(){return qe(new Date)}const ae=["Chest","Back","Shoulders","Biceps","Triceps","Quads","Hamstrings","Glutes","Calves","Abs","Forearms","Traps"];function ts(t){return(t.w||0)*(t.r||0)}function mt(t){return!t.sets||!Array.isArray(t.sets)?0:t.sets.reduce((s,r)=>s+ts(r),0)}function ss(t,s=new Date){const{start:r,end:a}=Zt(s),n=gt(t,r,a);let l=0,m=0;const o=new Set,i={},S={};return n.forEach(x=>{if(x.sets&&Array.isArray(x.sets)){const E=mt(x);l+=E,m+=x.sets.length,x.prim&&x.prim.forEach(p=>{o.add(p),i[p]=(i[p]||0)+E});const b=x.name||"Unknown";S[b]=(S[b]||0)+1}}),{workouts:n.length,totalVolume:l,totalSets:m,musclesWorked:Array.from(o),volumePerMuscle:i,exerciseCount:S,avgVolumePerWorkout:n.length>0?l/n.length:0}}function rs(t){const[s,r]=c.useState([]),[a,n]=c.useState(!1),[l,m]=c.useState(null),o=c.useCallback(async()=>{if(!t){r([]);return}n(!0),m(null);try{const u=await X.loadUserData(ee.WORKOUTS,t);r(u||[])}catch(u){console.error("Failed to load workouts:",u),m(u.message),r([])}finally{n(!1)}},[t]),i=c.useCallback(async u=>{if(!t)throw new Error("User ID required to save workouts");try{return await X.saveUserData(ee.WORKOUTS,u,t),r(u),!0}catch(y){return console.error("Failed to save workouts:",y),m(y.message),!1}},[t]),S=c.useCallback(async u=>{try{const A=[{...u,timestamp:Date.now(),createdAt:new Date().toISOString()},...s];return await i(A)}catch(y){return console.error("Failed to add workout:",y),m(y.message),!1}},[s,i]),x=c.useCallback(async(u,y)=>{try{const B=[...u.map(z=>({...z,date:y,timestamp:Date.now(),createdAt:new Date().toISOString()})),...s];return await i(B)}catch(A){return console.error("Failed to add session:",A),m(A.message),!1}},[s,i]),E=c.useCallback(async(u,y)=>{console.log("ðŸ”µ UPDATE SESSION CALLED"),console.log("  Input session:",u),console.log("  Input date:",y),console.log("  Session length:",u.length),console.log("  Current workouts in state:",s.length);try{const A=s.filter(I=>I.date!==y);console.log("  Other workouts (different dates):",A.length);const B=u.map(I=>{var le;console.log("  Processing exercise:",I);const G=`${I.id}_${y}`,Y=(le=s.find(se=>se.date===y&&se.id===I.id))==null?void 0:le.timestamp,Q={id:I.id,name:I.name,sets:I.sets||[],date:y,timestamp:Y||I.timestamp||Date.now(),createdAt:I.createdAt||new Date().toISOString()};return I.muscles&&(Q.muscles=I.muscles),I.type&&(Q.type=I.type),I.prim&&(Q.prim=I.prim),I.sec&&(Q.sec=I.sec),I.ter&&(Q.ter=I.ter),I.axial!==void 0&&(Q.axial=I.axial),I.prescribedSets!==void 0&&(Q.prescribedSets=I.prescribedSets),I.prescribedReps!==void 0&&(Q.prescribedReps=I.prescribedReps),I.prescribedRir!==void 0&&(Q.prescribedRir=I.prescribedRir),I.prescribedWeight!==void 0&&(Q.prescribedWeight=I.prescribedWeight),console.log("  Cleaned exercise:",Q),Q});console.log("  Session workouts prepared:",B),console.log("  Session workouts count:",B.length);const z=[...B,...A];console.log("  Total workouts to save:",z.length);const k=await i(z);return console.log("  âœ… SAVE RESULT:",k),k}catch(A){return console.error("  âŒ Failed to update session:",A),m(A.message),!1}},[s,i]),b=c.useCallback(async u=>{try{const y=s.filter(A=>A.timestamp!==u);return await i(y)}catch(y){return console.error("Failed to delete workout:",y),m(y.message),!1}},[s,i]),p=c.useCallback(async u=>{try{const y=s.filter(k=>k.date===u),A=s.filter(k=>k.date!==u),B={};y.forEach(k=>{const I=B[k.id];(!I||k.timestamp>I.timestamp)&&(B[k.id]=k)});const z=[...Object.values(B),...A];return console.log(`Removed ${y.length-Object.keys(B).length} duplicates from ${u}`),await i(z)}catch(y){return console.error("Failed to remove duplicates:",y),m(y.message),!1}},[s,i]),d=c.useCallback(async u=>{try{const y=s.filter(A=>A.date!==u);return await i(y)}catch(y){return console.error("Failed to delete workouts for date:",y),m(y.message),!1}},[s,i]),g=c.useCallback(u=>s.filter(y=>y.id===u).sort((y,A)=>new Date(A.date)-new Date(y.date)),[s]),f=c.useCallback(u=>s.filter(y=>y.date===u),[s]),C=c.useCallback(()=>es(s),[s]),j=c.useCallback((u,y)=>gt(s,u,y),[s]),h=c.useCallback(u=>{const y=g(u);return y.length>0?y[0]:null},[g]),F=c.useCallback(()=>s.length,[s]),_=c.useCallback(()=>[...new Set(s.map(u=>u.date))].sort().reverse(),[s]),O=c.useCallback(()=>s.reduce((u,y)=>u+mt(y),0),[s]),M=c.useCallback(()=>{const u=_(),y=O();return{totalWorkouts:s.length,totalSessions:u.length,totalVolume:y,avgVolumePerWorkout:s.length>0?y/s.length:0,avgExercisesPerSession:u.length>0?s.length/u.length:0}},[s,_,O]),U=c.useCallback(async()=>{try{return await i([])}catch(u){return console.error("Failed to clear workouts:",u),m(u.message),!1}},[i]),w=c.useCallback(()=>JSON.stringify(s,null,2),[s]),W=c.useCallback(async(u,y=!1)=>{try{const A=JSON.parse(u);if(!Array.isArray(A))throw new Error("Invalid workout data format");const B=y?[...s,...A]:A;return await i(B)}catch(A){return console.error("Failed to import workouts:",A),m(A.message),!1}},[s,i]);return c.useEffect(()=>{o()},[o]),{workouts:s,isLoading:a,error:l,addWorkout:S,addSession:x,updateSession:E,deleteWorkout:b,deleteWorkoutsForDate:d,clearAllWorkouts:U,removeDuplicates:p,getWorkoutsForExercise:g,getWorkoutsForDate:f,getWorkoutsByDate:C,getWorkoutsInDateRange:j,getLastWorkoutForExercise:h,getUniqueDates:_,getWorkoutCount:F,getTotalVolume:O,getWorkoutStats:M,loadWorkouts:o,exportWorkouts:w,importWorkouts:W}}const as=[{id:1,name:"Barbell Bench Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:2,name:"Incline Barbell Bench Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:3,name:"Dumbbell Bench Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:4,name:"Incline Dumbbell Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:5,name:"Cable Fly",type:"isolation_upper",axial:!1,prim:["Chest"],sec:[],ter:["Shoulders"]},{id:6,name:"Push-ups",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:["Abs"]},{id:7,name:"Barbell Row",type:"compound_upper",axial:!0,prim:["Back"],sec:["Biceps","Traps"],ter:["Forearms"]},{id:8,name:"Pull-ups",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps"],ter:["Forearms","Traps"]},{id:9,name:"Lat Pulldown",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps"],ter:["Forearms"]},{id:10,name:"Seated Cable Row",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps","Traps"],ter:["Forearms"]},{id:11,name:"Dumbbell Row",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps","Traps"],ter:["Forearms"]},{id:12,name:"Deadlift",type:"compound_lower",axial:!0,prim:["Back","Hamstrings"],sec:["Glutes","Traps","Forearms"],ter:["Quads","Abs"]},{id:13,name:"Overhead Press",type:"compound_upper",axial:!0,prim:["Shoulders"],sec:["Triceps","Traps"],ter:["Abs"]},{id:14,name:"Dumbbell Shoulder Press",type:"compound_upper",axial:!1,prim:["Shoulders"],sec:["Triceps"],ter:["Traps"]},{id:15,name:"Lateral Raises",type:"isolation_upper",axial:!1,prim:["Shoulders"],sec:[],ter:["Traps"]},{id:16,name:"Front Raises",type:"isolation_upper",axial:!1,prim:["Shoulders"],sec:[],ter:[]},{id:17,name:"Face Pulls",type:"isolation_upper",axial:!1,prim:["Shoulders","Traps"],sec:["Back"],ter:[]},{id:18,name:"Barbell Curl",type:"isolation_upper",axial:!1,prim:["Biceps"],sec:["Forearms"],ter:[]},{id:19,name:"Dumbbell Curl",type:"isolation_upper",axial:!1,prim:["Biceps"],sec:["Forearms"],ter:[]},{id:20,name:"Hammer Curl",type:"isolation_upper",axial:!1,prim:["Biceps","Forearms"],sec:[],ter:[]},{id:21,name:"Tricep Pushdown",type:"isolation_upper",axial:!1,prim:["Triceps"],sec:[],ter:[]},{id:22,name:"Overhead Tricep Extension",type:"isolation_upper",axial:!1,prim:["Triceps"],sec:[],ter:[]},{id:23,name:"Dips",type:"compound_upper",axial:!1,prim:["Triceps","Chest"],sec:["Shoulders"],ter:[]},{id:24,name:"Barbell Squat",type:"compound_lower",axial:!0,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:["Abs","Calves"]},{id:25,name:"Front Squat",type:"compound_lower",axial:!0,prim:["Quads"],sec:["Glutes"],ter:["Abs","Hamstrings"]},{id:26,name:"Leg Press",type:"compound_lower",axial:!1,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:[]},{id:27,name:"Romanian Deadlift",type:"compound_lower",axial:!0,prim:["Hamstrings"],sec:["Glutes","Back"],ter:["Forearms"]},{id:28,name:"Leg Curl",type:"isolation_lower",axial:!1,prim:["Hamstrings"],sec:[],ter:[]},{id:29,name:"Leg Extension",type:"isolation_lower",axial:!1,prim:["Quads"],sec:[],ter:[]},{id:30,name:"Bulgarian Split Squat",type:"compound_lower",axial:!1,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:["Abs"]},{id:31,name:"Lunges",type:"compound_lower",axial:!1,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:[]},{id:32,name:"Hip Thrust",type:"compound_lower",axial:!1,prim:["Glutes"],sec:["Hamstrings"],ter:[]},{id:33,name:"Calf Raises",type:"isolation_lower",axial:!1,prim:["Calves"],sec:[],ter:[]},{id:34,name:"Plank",type:"isolation_upper",axial:!1,prim:["Abs"],sec:["Shoulders"],ter:[]},{id:35,name:"Cable Crunch",type:"isolation_upper",axial:!1,prim:["Abs"],sec:[],ter:[]},{id:36,name:"Hanging Leg Raise",type:"isolation_upper",axial:!1,prim:["Abs"],sec:[],ter:["Forearms"]},{id:37,name:"Russian Twist",type:"isolation_upper",axial:!1,prim:["Abs"],sec:[],ter:[]},{id:38,name:"Barbell Shrug",type:"isolation_upper",axial:!1,prim:["Traps"],sec:["Forearms"],ter:[]},{id:39,name:"Dumbbell Shrug",type:"isolation_upper",axial:!1,prim:["Traps"],sec:["Forearms"],ter:[]},{id:40,name:"Wrist Curl",type:"isolation_upper",axial:!1,prim:["Forearms"],sec:[],ter:[]},{id:41,name:"Farmer Carry",type:"compound_upper",axial:!0,prim:["Forearms","Traps"],sec:["Abs"],ter:["Calves"]}];function Ge(){return[...as]}function ns(){const[t,s]=c.useState([]),[r,a]=c.useState(!1),[n,l]=c.useState(null),m=c.useCallback(async()=>{a(!0),l(null);try{const j=await X.loadCollection(ee.EXERCISES);if(j&&j.length>0)s(j);else{const h=Ge();s(h),await X.saveCollection(ee.EXERCISES,h)}}catch(j){console.error("Failed to load exercises:",j),l(j.message);const h=Ge();s(h)}finally{a(!1)}},[]),o=c.useCallback(async j=>{try{return await X.saveCollection(ee.EXERCISES,j),s(j),!0}catch(h){return console.error("Failed to save exercises:",h),l(h.message),!1}},[]),i=c.useCallback(async j=>{try{const h=t.length>0?Math.max(...t.map(M=>M.id))+1:1,F={...j,id:h,createdAt:new Date().toISOString()},_=[...t,F];return await o(_)?F:null}catch(h){return console.error("Failed to add exercise:",h),l(h.message),null}},[t,o]),S=c.useCallback(async(j,h)=>{try{const F=t.map(_=>_.id===j?{..._,...h,updatedAt:new Date().toISOString()}:_);return await o(F)}catch(F){return console.error("Failed to update exercise:",F),l(F.message),!1}},[t,o]),x=c.useCallback(async j=>{try{const h=t.filter(F=>F.id!==j);return await o(h)}catch(h){return console.error("Failed to delete exercise:",h),l(h.message),!1}},[t,o]),E=c.useCallback(j=>t.find(h=>h.id===j)||null,[t]),b=c.useCallback(j=>t.filter(h=>{var F,_,O;return((F=h.prim)==null?void 0:F.includes(j))||((_=h.sec)==null?void 0:_.includes(j))||((O=h.ter)==null?void 0:O.includes(j))}),[t]),p=c.useCallback(j=>t.filter(h=>h.type===j),[t]),d=c.useCallback(j=>{const h=j.toLowerCase();return t.filter(F=>F.name.toLowerCase().includes(h))},[t]),g=c.useCallback(async()=>{try{const j=Ge();return await o(j)}catch(j){return console.error("Failed to reset exercises:",j),l(j.message),!1}},[o]),f=c.useCallback(async j=>{try{const h=new Set(t.map(M=>M.name.toLowerCase()));let F=t.length>0?Math.max(...t.map(M=>M.id)):0;const _=j.filter(M=>!h.has(M.name.toLowerCase())).map(M=>({...M,id:++F,createdAt:new Date().toISOString()})),O=[...t,..._];return await o(O)}catch(h){return console.error("Failed to import exercises:",h),l(h.message),!1}},[t,o]),C=c.useCallback(()=>t.length,[t]);return c.useEffect(()=>{m()},[m]),{exercises:t,isLoading:r,error:n,addExercise:i,updateExercise:S,deleteExercise:x,getExerciseById:E,getExercisesByMuscle:b,getExercisesByType:p,searchExercises:d,loadExercises:m,resetToPresets:g,importExercises:f,getExerciseCount:C}}function ls(t){const[s,r]=c.useState([]),[a,n]=c.useState(null),[l,m]=c.useState(0),[o,i]=c.useState(!1),[S,x]=c.useState(null),E=c.useCallback(async()=>{i(!0),x(null);try{const u=await X.loadCollection(ee.PROGRAMS);r(u||[])}catch(u){console.error("Failed to load programs:",u),x(u.message),r([])}finally{i(!1)}},[]),b=c.useCallback(async()=>{if(t)try{const u=await X.loadActiveProgram(t);if(u&&u.programId){const A=(await X.loadCollection(ee.PROGRAMS)).find(B=>B.id===u.programId);A?(n(A),m(u.currentDayIndex||0)):await X.saveActiveProgram(t,null)}}catch(u){console.error("Failed to load active program:",u)}},[t]),p=c.useCallback(async(u,y)=>{if(t)try{await X.saveActiveProgram(t,{programId:u,currentDayIndex:y})}catch(A){console.error("Failed to save active program state:",A)}},[t]),d=c.useCallback(async u=>{try{return await X.saveCollection(ee.PROGRAMS,u),r(u),!0}catch(y){return console.error("Failed to save programs:",y),x(y.message),!1}},[]),g=c.useCallback(async u=>{try{const y=s.length>0?Math.max(...s.map(k=>k.id))+1:1,A={...u,id:y,createdAt:new Date().toISOString()},B=[...s,A];return await d(B)?A:null}catch(y){return console.error("Failed to add program:",y),x(y.message),null}},[s,d]),f=c.useCallback(async(u,y)=>{try{const A=s.map(z=>z.id===u?{...z,...y,updatedAt:new Date().toISOString()}:z),B=await d(A);if(B&&(a==null?void 0:a.id)===u){const z=A.find(k=>k.id===u);n(z),await p(u,l)}return B}catch(A){return console.error("Failed to update program:",A),x(A.message),!1}},[s,a,l,d,p]),C=c.useCallback(async u=>{try{const y=s.filter(B=>B.id!==u),A=await d(y);return A&&(a==null?void 0:a.id)===u&&await F(),A}catch(y){return console.error("Failed to delete program:",y),x(y.message),!1}},[s,a,d]),j=c.useCallback(u=>s.find(y=>y.id===u)||null,[s]),h=c.useCallback(async u=>{if(!t)return x("User ID required to start program"),!1;try{const y=j(u);return y?(n(y),m(0),await p(u,0),!0):(x("Program not found"),!1)}catch(y){return console.error("Failed to start program:",y),x(y.message),!1}},[t,j,p]),F=c.useCallback(async()=>{if(!t)return!1;try{return n(null),m(0),await X.saveActiveProgram(t,null),!0}catch(u){return console.error("Failed to stop program:",u),x(u.message),!1}},[t]),_=c.useCallback(async()=>{if(!a||!a.days)return null;try{const u=(l+1)%a.days.length;return m(u),t&&await p(a.id,u),a.days[u]}catch(u){return console.error("Failed to advance day:",u),x(u.message),null}},[a,l,t,p]),O=c.useCallback(async u=>{if(!a||!a.days)return!1;if(u<0||u>=a.days.length)return x("Invalid day index"),!1;try{return m(u),t&&await p(a.id,u),!0}catch(y){return console.error("Failed to go to day:",y),x(y.message),!1}},[a,t,p]),M=c.useCallback(()=>!a||!a.days||a.days.length===0?null:a.days[l]||null,[a,l]),U=c.useCallback(()=>!a||!a.days?{currentDay:0,totalDays:0,percentage:0,daysCompleted:0}:{currentDay:l+1,totalDays:a.days.length,percentage:(l+1)/a.days.length*100,daysCompleted:l},[a,l]),w=c.useCallback(async u=>{const y=j(u);if(!y)return x("Program not found"),null;const A={...y,name:`${y.name} (Copy)`,id:void 0};return await g(A)},[j,g]),W=c.useCallback(()=>s.length,[s]);return c.useEffect(()=>{E()},[E]),c.useEffect(()=>{b()},[b]),{programs:s,activeProgram:a,currentDayIndex:l,isLoading:o,error:S,addProgram:g,updateProgram:f,deleteProgram:C,duplicateProgram:w,getProgramById:j,getProgramCount:W,startProgram:h,stopProgram:F,advanceToNextDay:_,goToDay:O,getCurrentDay:M,getProgramProgress:U,loadPrograms:E}}const xt={compound_upper:{name:"Compound Upper",description:"Multi-joint upper body movements",fatigueMultiplier:1.2,systemicFatigueImpact:.15,recommendedRepRange:{min:5,max:12},recommendedSets:{min:3,max:6},progressionIncrement:2.5,examples:["Bench Press","Pull-ups","Overhead Press","Rows"]},compound_lower:{name:"Compound Lower",description:"Multi-joint lower body movements",fatigueMultiplier:1.5,systemicFatigueImpact:.25,recommendedRepRange:{min:5,max:15},recommendedSets:{min:3,max:6},progressionIncrement:5,examples:["Squat","Deadlift","Lunges","Leg Press"]},isolation_upper:{name:"Isolation Upper",description:"Single-joint upper body movements",fatigueMultiplier:.8,systemicFatigueImpact:.05,recommendedRepRange:{min:8,max:20},recommendedSets:{min:2,max:5},progressionIncrement:2.5,examples:["Bicep Curls","Tricep Extensions","Lateral Raises","Flyes"]},isolation_lower:{name:"Isolation Lower",description:"Single-joint lower body movements",fatigueMultiplier:.9,systemicFatigueImpact:.08,recommendedRepRange:{min:10,max:20},recommendedSets:{min:2,max:5},progressionIncrement:5,examples:["Leg Curls","Leg Extensions","Calf Raises","Hip Abduction"]}};function os(t){return t==="compound_upper"||t==="compound_lower"}function Ze(t){const s=xt[t];return s?s.progressionIncrement:2.5}function is(t,s,r=0){const a=s+r;return t*(1+a/30)}function Ve(t,s,r,a){const{w:n,r:l,rir:m}=t,o=Math.exp(-.3*m),i=a>0?n/a:.5,S=r==="primary"?J.PRIMARY_MUSCLE_MULTIPLIER:r==="secondary"?J.SECONDARY_MUSCLE_MULTIPLIER:J.TERTIARY_MUSCLE_MULTIPLIER;return o*i*S}function Ye(t,s,r,a=!1){const{w:n,r:l}=t,m=n*l,o=r==="primary"?J.PRIMARY_MUSCLE_MULTIPLIER:r==="secondary"?J.SECONDARY_MUSCLE_MULTIPLIER:J.TERTIARY_MUSCLE_MULTIPLIER,i=a?J.AXIAL_LOAD_MULTIPLIER:1;return m*o*i}function cs(t,s,r=!1){const{w:a,r:n}=t;if(!os(s))return 0;const l=a*n,m=r?J.AXIAL_LOAD_MULTIPLIER:1,o=J.COMPOUND_SYSTEMIC_MULTIPLIER;return l*m*o}function ds(t){const{sets:s,type:r,axial:a,prim:n=[],sec:l=[],ter:m=[]}=t;if(!s||s.length===0)return{stimulus:{},localFatigue:{},systemicFatigue:0,setCount:0};const o=s.reduce((b,p)=>p.w*p.r>b.w*b.r?p:b,s[0]),i=is(o.w,o.r,o.rir),S={},x={};let E=0;return s.forEach(b=>{n.forEach(p=>{S[p]=(S[p]||0)+Ve(b,p,"primary",i),x[p]=(x[p]||0)+Ye(b,p,"primary",a)}),l.forEach(p=>{S[p]=(S[p]||0)+Ve(b,p,"secondary",i),x[p]=(x[p]||0)+Ye(b,p,"secondary",a)}),m.forEach(p=>{S[p]=(S[p]||0)+Ve(b,p,"tertiary",i),x[p]=(x[p]||0)+Ye(b,p,"tertiary",a)}),E+=cs(b,r,a)}),{stimulus:S,localFatigue:x,systemicFatigue:E,setCount:s.length,estimated1RM:i}}function us(t,s){const{localFatigue:r={},systemicFatigue:a=0}=t,{rirError:n=0,soreness:l={},perceivedFatigue:m=5}=s,o={...r};let i=a;if(n<0){const x=Math.abs(n)*J.RIR_MISS_FATIGUE_PENALTY;i+=x,Object.keys(r).forEach(E=>{o[E]=(o[E]||0)+x})}Object.entries(l).forEach(([x,E])=>{if(E>0){const b=E/10*J.SORENESS_FATIGUE_WEIGHT;o[x]=(o[x]||0)*(1+b)}});const S=m-5;if(S!==0){const x=S/5*J.PERCEIVED_FATIGUE_WEIGHT;i*=1+x}return{localFatigue:o,systemicFatigue:i}}function gs(t,s,r,a=null){const{localFatigue:n={},systemicFatigue:l=0,weeklyStimulus:m={},perceivedFatigue:o=5,muscleSoreness:i={},lastWorkoutDate:S=null}=r;if(a!=null&&a.isRestDay||t.length===0&&a){const _=Ue({localFatigue:n,systemicFatigue:l},S||s,s,{plannedRestDays:1});return{localFatigue:_.localFatigue,systemicFatigue:_.systemicFatigue,weeklyStimulus:m,sessionStimulus:{},muscleReadiness:ke(_.localFatigue),systemicReadiness:Le(_.systemicFatigue),lastWorkoutDate:S,isRestDay:!0}}let x=0;a!=null&&a.activeProgram&&S&&(x=ms(a.activeProgram,a.lastDayIndex||0,a.currentDayIndex||0));const E=Ue({localFatigue:n,systemicFatigue:l},S,s,{plannedRestDays:x}),b={...E.localFatigue};let p=E.systemicFatigue;const d={...m},g={};t.forEach(_=>{const O=ds(_);Object.entries(O.stimulus).forEach(([M,U])=>{g[M]=(g[M]||0)+U,d[M]=(d[M]||0)+U}),Object.entries(O.localFatigue).forEach(([M,U])=>{b[M]=(b[M]||0)+U}),p+=O.systemicFatigue});const f=us({localFatigue:b,systemicFatigue:p},{rirError:0,soreness:i,perceivedFatigue:o}),C={};Object.entries(f.localFatigue).forEach(([_,O])=>{C[_]=Math.log1p(O/1e3)});const j=Math.log1p(f.systemicFatigue/1e3),h=ke(C),F=Le(j);return{localFatigue:C,systemicFatigue:j,weeklyStimulus:d,sessionStimulus:g,muscleReadiness:h,systemicReadiness:F,lastWorkoutDate:s,restBonus:E.restBonus,isRestDay:!1}}function ms(t,s,r){var l;if(!t||!t.days)return 0;let a=0,n=s;for(;n!==r&&(n=(n+1)%t.days.length,n!==r);)(l=t.days[n])!=null&&l.isRestDay&&a++;return a}function Ue(t,s,r,a=null){if(!s)return t;const n=ps(s,r);if(n<=0)return t;const{localFatigue:l={},systemicFatigue:m=0}=t;let o=1;a&&a.plannedRestDays>0&&(o=1+Math.min(.5,a.plannedRestDays*.1));const i=J.LOCAL_RECOVERY_RATE*o,S=J.SYSTEMIC_RECOVERY_RATE*o,x={};Object.entries(l).forEach(([b,p])=>{x[b]=Math.max(0,p*Math.exp(-i*n))});const E=Math.max(0,m*Math.exp(-S*n));return{localFatigue:x,systemicFatigue:E,restBonus:o}}function ke(t){const s={};return ae.forEach(r=>{const a=t[r]||0;s[r]=Math.exp(-a)}),s}function Le(t){return Math.exp(-t)}function et(t,s){const r={};return Object.entries(t).forEach(([a,n])=>{r[a]=Math.max(0,n*Math.exp(-.14*s))}),r}function xs(t,s,r={}){const a=J.DELOAD_THRESHOLD;if(s<.35)return{needed:!0,type:"systemic",severity:"high",message:"Systemic fatigue is critically high - immediate deload needed",recommendation:"Reduce volume 40-60%, increase RIR by 2-3, remove axial loads"};if(s<a)return{needed:!0,type:"systemic",severity:"moderate",message:"Systemic deload needed - reduce overall training volume",recommendation:"Reduce sets by 40%, increase RIR by 2, lighter axial loads"};const n=Object.entries(t).filter(([l,m])=>m<a).map(([l,m])=>({muscle:l,readiness:m}));return n.length>0?{needed:!0,type:"local",severity:n.length>3?"high":"moderate",muscles:n,message:`Local deload needed for: ${n.map(l=>l.muscle).join(", ")}`,recommendation:"Reduce volume 30-40% for affected muscles, add 1-2 RIR"}:{needed:!1,type:null,severity:"none",message:"Recovery is adequate"}}function ps(t,s){const r=new Date(t),a=new Date(s),n=Math.abs(a-r);return Math.floor(n/(1e3*60*60*24))}function hs(t,s){const r={};return Object.keys(t).forEach(a=>{const n=t[a]||0,l=s[a]||.001;r[a]=n/l}),r}function bs(t,s=[]){const[r,a]=c.useState({}),[n,l]=c.useState(0),[m,o]=c.useState({}),[i,S]=c.useState([]),[x,E]=c.useState({}),[b,p]=c.useState(1),[d,g]=c.useState(5),[f,C]=c.useState({}),[j,h]=c.useState([]),[F,_]=c.useState([]),[O,M]=c.useState(null),[U,w]=c.useState(null),[W,u]=c.useState(!1),[y,A]=c.useState(null),B=N=>{if(N==null)return null;if(typeof N!="object")return N;if(Array.isArray(N))return N.filter(L=>L!==void 0).map(L=>B(L));const $={};return Object.keys(N).forEach(L=>{const v=N[L];v!==void 0&&(Array.isArray(v)?$[L]=v.filter(T=>T!==void 0).map(T=>B(T)):v&&typeof v=="object"?$[L]=B(v):$[L]=v)}),$},z=c.useCallback(async()=>{if(!t){ge();return}u(!0),A(null);try{const N=await X.loadFatigueState(t);if(N&&Object.keys(N).length>0){a(N.localFatigue||{}),l(N.systemicFatigue||0),o(N.weeklyStimulus||{}),S(N.stimulusHistory||[]),M(N.lastWorkoutDate||null),w(N.lastUpdateDate||null),h(N.performanceErrors||[]),_(N.readinessHistory||[]);const $=ke(N.localFatigue||{}),L=Le(N.systemicFatigue||0);if(E($),p(L),N.lastUpdateDate){const v=new Date().toISOString().split("T")[0],T=tt(N.lastUpdateDate,v);if(T>0){console.log("ðŸ“… Days since last update:",T),console.log("  Applying recovery...");const D=Ue({localFatigue:N.localFatigue||{},systemicFatigue:N.systemicFatigue||0},N.lastUpdateDate,v,null);a(D.localFatigue),l(D.systemicFatigue),w(v);const H=ke(D.localFatigue),q=Le(D.systemicFatigue);E(H),p(q);const re=et(N.weeklyStimulus||{},T);o(re)}}}else ge()}catch(N){console.error("Failed to load fatigue state:",N),A(N.message),ge()}finally{u(!1)}},[t]),k=c.useCallback(async()=>{if(!t)throw new Error("User ID required to save fatigue state");try{console.log("ðŸ’¾ Saving fatigue state...");const N={localFatigue:r,systemicFatigue:n,weeklyStimulus:m,stimulusHistory:i,lastWorkoutDate:O,lastUpdateDate:new Date().toISOString().split("T")[0],performanceErrors:j,readinessHistory:F};console.log("  Raw data:",N);try{JSON.stringify(N)}catch(L){console.error("  âŒ Data contains non-serializable values:",L)}const $=B(N);console.log("  Cleaned data:",$);try{const L=JSON.stringify($);console.log("  Stringified successfully, length:",L.length)}catch(L){console.error("  âŒ Cleaned data still has issues:",L)}return await X.saveFatigueState(t,$),console.log("  âœ… Fatigue saved successfully"),!0}catch(N){return console.error("Failed to save fatigue state:",N),A(N.message),!1}},[t,r,n,m,i,O,j,F]),I=c.useCallback(async(N,$,L={},v=null)=>{console.log("ðŸ‹ï¸ processWorkoutSession:"),console.log("  observationalData received:",L);try{const T=v?{...v,workoutHistory:s}:{workoutHistory:s},D=gs(N,$,{localFatigue:r,systemicFatigue:n,weeklyStimulus:m,perceivedFatigue:L.perceivedFatigue||d,muscleSoreness:L.muscleSoreness||f,lastWorkoutDate:O},T);if(console.log("ðŸ“Š Updating fatigue state after session:"),console.log("  weeklyStimulus:",D.weeklyStimulus),console.log("  sessionStimulus:",D.sessionStimulus),console.log("  totalStimulus:",Object.values(D.weeklyStimulus||{}).reduce((oe,xe)=>oe+xe,0)),a(D.localFatigue),l(D.systemicFatigue),o(D.weeklyStimulus),E(D.muscleReadiness),p(D.systemicReadiness),D.isRestDay||M(D.lastWorkoutDate),w($),!D.isRestDay&&D.sessionStimulus){const oe=[...i.slice(-6),{date:$,stimulus:D.sessionStimulus,totalStimulus:Object.values(D.sessionStimulus).reduce((xe,Ee)=>xe+Ee,0)}];S(oe)}const H=[...F.slice(-6),{date:$,systemicReadiness:D.systemicReadiness,avgMuscleReadiness:Object.values(D.muscleReadiness).reduce((oe,xe)=>oe+xe,0)/ae.length,isRestDay:D.isRestDay||!1,actualRestDays:D.actualRestDays,plannedRestDays:D.plannedRestDays,perceivedFatigue:L.perceivedFatigue||d,muscleSoreness:L.muscleSoreness||f}],q=H[H.length-1];if(console.log("ðŸ“ New readiness entry:"),console.log("  Full object:",JSON.stringify(q,null,2)),console.log("  perceivedFatigue:",q.perceivedFatigue),console.log("  muscleSoreness:",q.muscleSoreness),_(H),!D.isRestDay&&L.rirErrors&&L.rirErrors.length>0){const oe=[...j.slice(-9),{date:$,errors:L.rirErrors}];h(oe)}console.log("ðŸ’¾ Saving fatigue from processWorkoutSession...");const re={localFatigue:D.localFatigue,systemicFatigue:D.systemicFatigue,weeklyStimulus:D.weeklyStimulus,stimulusHistory:(D.isRestDay,i),lastWorkoutDate:D.isRestDay?O:D.lastWorkoutDate,lastUpdateDate:$,performanceErrors:j,readinessHistory:H};console.log("  Raw fatigue data:",re);const me=B(re);console.log("  Cleaned fatigue data:",me);const Te=(oe,xe="")=>{Object.keys(oe).forEach(Ee=>{const fe=oe[Ee],Re=xe?`${xe}.${Ee}`:Ee;fe===void 0?console.error(`  âŒ FOUND UNDEFINED at: ${Re}`):fe&&typeof fe=="object"&&!Array.isArray(fe)?Te(fe,Re):Array.isArray(fe)&&fe.forEach((De,Ie)=>{De===void 0?console.error(`  âŒ FOUND UNDEFINED at: ${Re}[${Ie}]`):De&&typeof De=="object"&&Te(De,`${Re}[${Ie}]`)})})};return Te(me),await X.saveFatigueState(t,me),console.log("  âœ… Fatigue from processWorkoutSession saved"),!0}catch(T){return console.error("Failed to process workout session:",T),A(T.message),!1}},[t,r,n,m,i,d,f,O,j,F,s]),G=c.useCallback((N,$=null)=>{if(console.log("ðŸ”„ APPLY RECOVERY CALLED"),console.log("  currentDate:",N),console.log("  lastUpdateDate:",U),console.log("  lastWorkoutDate:",O),console.log("  BEFORE recovery:"),console.log("    localFatigue:",r),console.log("    systemicFatigue:",n),!U&&!O)return{localFatigue:r,systemicFatigue:n};const v=Ue({localFatigue:r,systemicFatigue:n},U||O,N,$);console.log("  AFTER recovery:"),console.log("    recovered.localFatigue:",v.localFatigue),console.log("    recovered.systemicFatigue:",v.systemicFatigue),a(v.localFatigue),l(v.systemicFatigue),w(N);const T=ke(v.localFatigue),D=Le(v.systemicFatigue);console.log("  Calculated readiness:"),console.log("    muscleReadiness:",T),console.log("    systemicReadiness:",D),E(T),p(D);const H=U?tt(U,N):0;if(console.log("ðŸ“‰ Weekly Stimulus Decay Check:"),console.log("  Last update date:",U),console.log("  Current date:",N),console.log("  Days since:",H),console.log("  Current weeklyStimulus:",m),H>0){const q=et(m,H);console.log("  Decayed weeklyStimulus:",q),o(q)}return v},[r,n,m,O,U]),Y=c.useCallback(()=>{let N=0;const $=[];b<J.DELOAD_THRESHOLD&&(N++,$.push("Low systemic readiness")),Object.values(f).filter(H=>H>6).length>2&&(N++,$.push("Persistent muscle soreness"));const v=i.slice(-3).map(H=>H.totalStimulus);if(v.length>=3){const H=v.reduce((re,me)=>re+me,0)/v.length;v.every(re=>Math.abs(re-H)<H*.1)&&b>.65&&(N++,$.push("Stimulus plateau despite recovery"))}const T=j.slice(-2);T.length>=J.PERFORMANCE_ERROR_SESSIONS&&T.every(q=>q.errors.some(re=>re<J.PERFORMANCE_ERROR_THRESHOLD))&&(N++,$.push("Consistent performance decline"));const D=xs(x,b);return D.needed||N>=J.DELOAD_MIN_CONDITIONS?{...D,needed:!0,conditionsMet:N,conditions:$,message:D.needed?D.message:`Deload recommended: ${N} conditions met`}:D},[x,b,f,i,j]),Q=c.useCallback(()=>{var T;if(i.length===0)return{efficiency:{},trend:"insufficient_data"};const N=((T=i[i.length-1])==null?void 0:T.stimulus)||{},$=hs(N,r),L=i.slice(-4).map(D=>D.totalStimulus),v=L.length>=4&&L.every((D,H,q)=>H===0||D>=q[H-1])?"increasing":L.length>=4&&L.every((D,H,q)=>H===0||D<=q[H-1])?"decreasing":"stable";return{efficiency:$,trend:v,recentStimulus:L}},[r,i]),le=c.useCallback(()=>{const N={};Object.entries(r).forEach(([L,v])=>{if(v>0){const D=J.LOCAL_RECOVERY_RATE;try{const H=-Math.log(.85);if(v<=H)N[L]=0;else{const q=Math.log(v/H)/D;N[L]=Math.max(0,Math.ceil(q))}}catch{N[L]=0}}else N[L]=0});let $=0;if(n>0)try{const L=-Math.log(.85),v=J.SYSTEMIC_RECOVERY_RATE;n>L&&($=Math.ceil(Math.log(n/L)/v))}catch{$=0}return{muscleRecoveryDays:N,systemicRecoveryDays:$,maxRecoveryDays:Math.max($,...Object.values(N))}},[r,n]),se=c.useCallback(N=>{g(Math.max(0,Math.min(10,N)))},[]),ue=c.useCallback((N,$)=>{C(L=>({...L,[N]:Math.max(0,Math.min(10,$))}))},[]),we=c.useCallback(()=>{C({})},[]),Se=c.useCallback(N=>x[N]||1,[x]),Ne=c.useCallback(N=>r[N]||0,[r]),be=c.useCallback(N=>m[N]||0,[m]),ge=c.useCallback(()=>{a({}),l(0),o({}),S([]),M(null),w(null),g(5),C({}),h([]),_([]);const N={};ae.forEach($=>{N[$]=1}),E(N),p(1)},[]),ye=c.useCallback(()=>{const N=ae.reduce((v,T)=>v+(x[T]||1),0)/ae.length,$=Y();let L="optimal";return b<.6||N<.6?L="poor":b<.75||N<.75?L="moderate":(b<.85||N<.85)&&(L="good"),{status:L,systemicReadiness:b,avgMuscleReadiness:N,deloadNeeded:$.needed,deloadMessage:$.message,deloadConditions:$.conditions||[]}},[x,b,Y]),Z=c.useCallback((N,$)=>{const L={...r};L[N]=Math.max(0,$),a(L);const v=ke(L);E(v)},[r]);return c.useEffect(()=>{z()},[z]),c.useEffect(()=>{if(t&&!W){const N=setTimeout(()=>{k()},1e3);return()=>clearTimeout(N)}},[t,r,n,m,i,W,k]),c.useEffect(()=>{if(U){const N=new Date().toISOString().split("T")[0];N!==U&&G(N)}},[U,G]),{localFatigue:r,systemicFatigue:n,weeklyStimulus:m,stimulusHistory:i,muscleReadiness:x,systemicReadiness:b,lastWorkoutDate:O,perceivedFatigue:d,muscleSoreness:f,performanceErrors:j,readinessHistory:F,isLoading:W,error:y,processWorkoutSession:I,applyRecovery:G,getMuscleReadiness:Se,getMuscleFatigue:Ne,getMuscleStimulus:be,getDeloadRecommendation:Y,getRecoveryTimeline:le,getRecoveryStatus:ye,getStimulusEfficiency:Q,updatePerceivedFatigue:se,updateMuscleSoreness:ue,clearMuscleSoreness:we,setManualFatigue:Z,loadFatigueState:z,saveFatigueState:k,resetFatigueState:ge}}function tt(t,s){const r=new Date(t),a=new Date(s),n=Math.abs(a-r);return Math.floor(n/(1e3*60*60*24))}function fs(t=120){const[s,r]=c.useState(0),[a,n]=c.useState(!1),l=c.useRef(null),m=(b=t)=>{r(b),n(!0)},o=()=>{n(!1),r(0),l.current&&clearInterval(l.current)},i=()=>{n(!1)},S=()=>{s>0&&n(!0)},x=b=>{r(p=>p+b)};return c.useEffect(()=>(a&&s>0?l.current=setInterval(()=>{r(b=>b<=1?(n(!1),0):b-1)},1e3):l.current&&clearInterval(l.current),()=>{l.current&&clearInterval(l.current)}),[a,s]),{timeRemaining:s,isActive:a,start:m,stop:o,pause:i,resume:S,addTime:x,formattedTime:(()=>{const b=Math.floor(s/60),p=s%60;return`${b}:${p.toString().padStart(2,"0")}`})()}}const je={themeColor:"blue",restTimerEnabled:!0,defaultRestTime:120},st={blue:{name:"Blue",primary:"bg-blue-600 hover:bg-blue-700",light:"bg-blue-50 border-blue-200",text:"text-blue-900",accent:"text-blue-700"},green:{name:"Green",primary:"bg-green-600 hover:bg-green-700",light:"bg-green-50 border-green-200",text:"text-green-900",accent:"text-green-700"},purple:{name:"Purple",primary:"bg-purple-600 hover:bg-purple-700",light:"bg-purple-50 border-purple-200",text:"text-purple-900",accent:"text-purple-700"},orange:{name:"Orange",primary:"bg-orange-600 hover:bg-orange-700",light:"bg-orange-50 border-orange-200",text:"text-orange-900",accent:"text-orange-700"},red:{name:"Red",primary:"bg-red-600 hover:bg-red-700",light:"bg-red-50 border-red-200",text:"text-red-900",accent:"text-red-700"},indigo:{name:"Indigo",primary:"bg-indigo-600 hover:bg-indigo-700",light:"bg-indigo-50 border-indigo-200",text:"text-indigo-900",accent:"text-indigo-700"},pink:{name:"Pink",primary:"bg-pink-600 hover:bg-pink-700",light:"bg-pink-50 border-pink-200",text:"text-pink-900",accent:"text-pink-700"},teal:{name:"Teal",primary:"bg-teal-600 hover:bg-teal-700",light:"bg-teal-50 border-teal-200",text:"text-teal-900",accent:"text-teal-700"}};function ys(t){const[s,r]=c.useState(je),[a,n]=c.useState(!1),[l,m]=c.useState(null);return c.useEffect(()=>{if(!t){r(je),n(!0),m(null);return}(async()=>{try{const x=await X.loadSettings(t);if(x){const{userId:E,updatedAt:b,...p}=x,d={...je,...p};r(d),m(JSON.stringify(d)),console.log("âœ… Loaded settings from database")}else r(je),m(JSON.stringify(je)),console.log("â„¹ï¸ No settings found, using defaults")}catch(x){console.error("Failed to load settings:",x),r(je),m(JSON.stringify(je))}finally{n(!0)}})()},[t]),c.useEffect(()=>{if(!t||!a)return;const S=JSON.stringify(s);if(S===l)return;const E=setTimeout(async()=>{try{await X.saveSettings(t,s),m(S),console.log("âœ… Saved settings to database")}catch(b){console.error("Failed to save settings:",b)}},500);return()=>clearTimeout(E)},[s,t,a,l]),{settings:s,updateSetting:(S,x)=>{r(E=>({...E,[S]:x}))},resetSettings:()=>{r(je)},themeColors:st,currentTheme:st[s.themeColor],isLoaded:a}}function vs({onLogin:t}){const[s,r]=c.useState("login"),[a,n]=c.useState(""),[l,m]=c.useState(""),[o,i]=c.useState(""),[S,x]=c.useState(""),[E,b]=c.useState(!1),[p,d]=c.useState(!1),g=async j=>{if(j.preventDefault(),x(""),!a.trim()){x("Please enter a username");return}if(!l){x("Please enter a password");return}if(s==="register"){if(a.trim().length<3){x("Username must be at least 3 characters");return}if(l.length<6){x("Password must be at least 6 characters");return}if(!o){x("Please confirm your password");return}if(l!==o){x("Passwords do not match");return}}b(!0);try{const h=s==="register",F=await t(a.trim(),l,h);F.success||x(F.error||"Authentication failed")}catch(h){x(h.message||"An error occurred. Please try again.")}finally{b(!1)}},f=()=>{r(s==="login"?"register":"login"),x(""),m(""),i("")},C=j=>{j.key==="Enter"&&g(j)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("h1",{className:"text-3xl font-bold mb-2 text-slate-900",children:"Workout Tracker"}),e.jsx("p",{className:"text-slate-600",children:s==="login"?"Welcome back!":"Create your account"})]}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Username"}),e.jsx("input",{id:"username",type:"text",value:a,onChange:j=>n(j.target.value),onKeyPress:C,placeholder:"Enter your username",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg text-lg focus:outline-none focus:border-blue-500 transition-colors",autoFocus:!0,disabled:E,autoComplete:"username"}),s==="register"&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"At least 3 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:p?"text":"password",value:l,onChange:j=>m(j.target.value),onKeyPress:C,placeholder:"Enter your password",className:"w-full px-4 py-3 pr-12 border-2 border-slate-300 rounded-lg text-lg focus:outline-none focus:border-blue-500 transition-colors",disabled:E,autoComplete:s==="login"?"current-password":"new-password"}),e.jsx("button",{type:"button",onClick:()=>d(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",tabIndex:-1,children:p?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),s==="register"&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"At least 6 characters"})]}),s==="register"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Confirm Password"}),e.jsx("input",{id:"confirmPassword",type:p?"text":"password",value:o,onChange:j=>i(j.target.value),onKeyPress:C,placeholder:"Confirm your password",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg text-lg focus:outline-none focus:border-blue-500 transition-colors",disabled:E,autoComplete:"new-password"})]}),S&&e.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-700 text-sm font-medium",children:S})}),e.jsx("button",{type:"submit",disabled:E,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 active:bg-blue-800 disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors",children:E?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="login"?"Logging in...":"Creating account..."]}):s==="login"?"Login":"Create Account"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:f,className:"text-sm text-blue-600 hover:text-blue-700 font-medium hover:underline",disabled:E,children:s==="login"?"Don't have an account? Register":"Already have an account? Login"})}),s==="register"&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-700",children:"ðŸ”’ Your password is securely hashed and stored. Make sure to remember it!"})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"space-y-2 text-xs text-slate-500",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),"Your workouts and progress are private"]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),"Exercises and programs are shared globally"]})]})}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Features"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-blue-600 font-semibold text-sm mb-1",children:"ðŸ“Š Progress Tracking"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Log sets, reps, and weight"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-green-600 font-semibold text-sm mb-1",children:"ðŸ’ª Recovery Metrics"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Smart fatigue tracking"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-purple-600 font-semibold text-sm mb-1",children:"ðŸ“… Program Builder"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Create custom routines"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-orange-600 font-semibold text-sm mb-1",children:"ðŸ“ˆ Progression"}),e.jsx("p",{className:"text-xs text-slate-600",children:"AI-powered advice"})]})]})]})]})})}function rt({weight:t,reps:s,rir:r,onWeightChange:a,onRepsChange:n,onRirChange:l,onSubmit:m,onCancel:o,weightLabel:i="Weight (lbs)",repsLabel:S="Reps",rirLabel:x="RIR",submitLabel:E="Add Set",showCancel:b=!1,autoFocusReps:p=!1,disabled:d=!1}){const g=c.useRef(null),f=c.useRef(null);c.useEffect(()=>{p&&g.current&&g.current.focus()},[p]);const C=(h,F)=>{h.key==="Enter"&&(h.preventDefault(),F&&F.current?F.current.focus():t&&s&&r!==""&&m())},j=t&&s&&r!=="";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:i}),e.jsx("input",{type:"number",step:"0.5",value:t,onChange:h=>a(h.target.value),onKeyPress:h=>C(h,g),placeholder:"lbs",disabled:d,className:"w-full px-4 py-4 border-2 border-slate-300 rounded-lg text-lg text-center font-semibold focus:outline-none focus:border-blue-500 disabled:bg-slate-100 disabled:cursor-not-allowed transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:S}),e.jsx("input",{ref:g,type:"number",value:s,onChange:h=>n(h.target.value),onKeyPress:h=>C(h,f),placeholder:"reps",disabled:d,className:"w-full px-4 py-4 border-2 border-slate-300 rounded-lg text-lg text-center font-semibold focus:outline-none focus:border-blue-500 disabled:bg-slate-100 disabled:cursor-not-allowed transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:x}),e.jsx("input",{ref:f,type:"number",min:"0",max:"10",value:r,onChange:h=>l(h.target.value),onKeyPress:h=>{h.key==="Enter"&&j&&(h.preventDefault(),m())},placeholder:"RIR",disabled:d,className:"w-full px-4 py-4 border-2 border-slate-300 rounded-lg text-lg text-center font-semibold focus:outline-none focus:border-blue-500 disabled:bg-slate-100 disabled:cursor-not-allowed transition-colors"})]})]}),e.jsxs("div",{className:"text-xs text-slate-500 text-center",children:[e.jsx("span",{className:"font-semibold",children:"RIR"})," = Reps In Reserve (0 = failure, 3 = could do 3 more)"]}),e.jsxs("div",{className:`flex gap-2 ${b?"grid grid-cols-2":""}`,children:[e.jsx("button",{onClick:m,disabled:!j||d,className:`${b?"":"w-full"} bg-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-blue-700 active:bg-blue-800 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors`,children:E}),b&&e.jsx("button",{onClick:o,disabled:d,className:"bg-slate-400 text-white py-4 rounded-lg font-bold text-lg hover:bg-slate-500 active:bg-slate-600 disabled:bg-slate-200 disabled:cursor-not-allowed transition-colors",children:"Cancel"})]})]})}function js({progression:t,className:s=""}){if(!t)return null;const{advice:r,readiness:a,suggestion:n,reason:l,muscleReadiness:m,systemicReadiness:o}=t;if(r==="first_time")return e.jsxs("div",{className:`border-2 border-blue-200 bg-blue-50 rounded-lg p-4 ${s}`,children:[e.jsx("div",{className:"text-sm font-semibold text-blue-900 mb-1",children:"ðŸ’¡ First Time"}),e.jsx("p",{className:"text-sm text-blue-800",children:n})]});const S=(()=>{switch(a){case"deload":return{bg:"bg-orange-100",border:"border-orange-300",icon:"ðŸ”„",title:"DELOAD NEEDED",titleColor:"text-orange-900"};case"high":return{bg:"bg-green-50",border:"border-green-200",icon:r==="progress"?"ðŸ“ˆ":"ðŸ’ª",title:r==="progress"?"Progress":"Ready to Push",titleColor:"text-green-900"};case"low":return{bg:"bg-red-50",border:"border-red-200",icon:"âš ï¸",title:"Reduce Load",titleColor:"text-red-900"};case"moderate":default:return{bg:"bg-yellow-50",border:"border-yellow-200",icon:"âž¡ï¸",title:"Maintain",titleColor:"text-yellow-900"}}})();return e.jsxs("div",{className:`border-2 rounded-lg p-4 ${S.bg} ${S.border} ${s}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:`text-base font-bold ${S.titleColor}`,children:[S.icon," ",S.title]}),(m!==void 0||o!==void 0)&&e.jsxs("div",{className:"flex gap-2 text-xs",children:[m!==void 0&&e.jsxs("span",{className:"bg-white bg-opacity-50 px-2 py-1 rounded font-semibold",children:["M: ",(m*100).toFixed(0),"%"]}),o!==void 0&&e.jsxs("span",{className:"bg-white bg-opacity-50 px-2 py-1 rounded font-semibold",children:["S: ",(o*100).toFixed(0),"%"]})]})]}),e.jsx("p",{className:"text-sm leading-relaxed mb-2",children:n}),l&&e.jsx("div",{className:`text-sm font-semibold ${a==="deload"?"text-orange-700":"text-slate-700"}`,children:l}),(m!==void 0||o!==void 0)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-opacity-30",style:{borderColor:"currentColor"},children:[e.jsx("div",{className:"text-xs font-semibold mb-2 opacity-75",children:"Readiness"}),e.jsxs("div",{className:"space-y-2",children:[m!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs w-16",children:"Muscle:"}),e.jsx("div",{className:"flex-1 bg-white bg-opacity-30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${m>.85?"bg-green-600":m>.65?"bg-yellow-600":m>.5?"bg-orange-600":"bg-red-600"}`,style:{width:`${m*100}%`}})}),e.jsxs("span",{className:"text-xs w-10 text-right font-semibold",children:[(m*100).toFixed(0),"%"]})]}),o!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs w-16",children:"System:"}),e.jsx("div",{className:"flex-1 bg-white bg-opacity-30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${o>.85?"bg-green-600":o>.65?"bg-yellow-600":o>.5?"bg-orange-600":"bg-red-600"}`,style:{width:`${o*100}%`}})}),e.jsxs("span",{className:"text-xs w-10 text-right font-semibold",children:[(o*100).toFixed(0),"%"]})]})]})]})]})}function pt({exercises:t,onSelect:s,placeholder:r="Select an exercise...",className:a="",exercisesByMuscle:n=null}){const[l,m]=c.useState(""),[o,i]=c.useState(""),[S,x]=c.useState(""),E=c.useMemo(()=>{if(n)return n;const f={};return t.forEach(C=>{f[C.muscle]||(f[C.muscle]=[]),f[C.muscle].push(C)}),f},[t,n]),b=c.useMemo(()=>{if(l&&E[l]){let f=E[l];return o&&(f=f.filter(C=>C.name.toLowerCase().includes(o.toLowerCase()))),f}return o?t.filter(f=>f.name.toLowerCase().includes(o.toLowerCase())):[]},[t,E,l,o]),p=f=>{m(f),x(""),i("")},d=f=>{i(f),m(""),x("")},g=f=>{x(f),f&&s&&(s(f),m(""),i(""),x(""))};return e.jsxs("div",{className:`space-y-3 ${a}`,children:[e.jsx("div",{children:e.jsx("input",{type:"text",value:o,onChange:f=>d(f.target.value),placeholder:"ðŸ” Search exercises...",className:"w-full px-4 py-3 border-2 rounded-lg text-base focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 border-t-2 border-gray-300"}),e.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"OR"}),e.jsx("div",{className:"flex-1 border-t-2 border-gray-300"})]}),e.jsx("div",{children:e.jsxs("select",{value:l,onChange:f=>p(f.target.value),className:"w-full px-4 py-3 border-2 rounded-lg text-base font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"1ï¸âƒ£ Select muscle group..."}),Object.entries(E).map(([f,C])=>e.jsxs("option",{value:f,children:[f," (",C.length,")"]},f))]})}),e.jsx("div",{children:e.jsxs("select",{value:S,onChange:f=>g(f.target.value),disabled:!l&&!o,className:"w-full px-4 py-3 border-2 rounded-lg text-base font-medium disabled:bg-gray-100 disabled:cursor-not-allowed focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:l||o?`2ï¸âƒ£ Choose exercise... (${b.length})`:r}),b.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]})}),(l||o)&&e.jsxs("div",{className:"flex gap-2 items-center text-sm flex-wrap",children:[e.jsx("span",{className:"text-gray-600",children:"Active filters:"}),l&&e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full font-medium",children:[l,e.jsx("button",{onClick:()=>m(""),className:"ml-2 text-blue-500 hover:text-blue-700",children:"Ã—"})]}),o&&e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full font-medium",children:['"',o,'"',e.jsx("button",{onClick:()=>i(""),className:"ml-2 text-green-500 hover:text-green-700",children:"Ã—"})]})]})]})}function ht(t){const s={};return t.forEach(r=>{r.prim&&Array.isArray(r.prim)&&r.prim.forEach(a=>{s[a]||(s[a]=[]),s[a].push(r)})}),Object.keys(s).sort().reduce((r,a)=>(r[a]=s[a],r),{})}function at(t,s,r,a,n,l,m=null){const o=s.find(f=>f.id==t);if(!o)return{advice:"error",suggestion:"Exercise not found",readiness:"unknown"};const i=r.filter(f=>f.id==t).sort((f,C)=>new Date(C.date)-new Date(f.date));if(i.length===0)return{advice:"first_time",suggestion:"Start conservative - focus on technique and find your working weight",readiness:"high",muscleReadiness:1,systemicReadiness:1};const S=i[0],x=i[1],E=o.prim||[],b=E.length>0?Math.min(...E.map(f=>a[f]||1)):1,p=ws(b,n,o,l,i);if(p.needed)return{advice:"deload",readiness:"deload",suggestion:p.suggestion,reason:p.reason,deloadProtocol:p.protocol,muscleReadiness:b,systemicReadiness:n};const d=Ss(S,x,o,i),g=Ns(i,b,l,o);return Es(d,g,b,n,o,S)}function ws(t,s,r,a,n){const l=J.DELOAD_THRESHOLD;if(s<.5)return{needed:!0,reason:"Critical systemic fatigue",suggestion:"Take 3-5 days off or do very light activity only",protocol:{action:"rest",duration:"3-5 days"}};if(s<l)return{needed:!0,reason:"Systemic fatigue is high",suggestion:"Reduce all training volume by 40-50%, increase RIR by 2-3, remove or lighten axial loads",protocol:{setReduction:.5,rirIncrease:2,weightReduction:r.axial?.3:.2,duration:"4-7 days"}};if(t<l)return{needed:!0,reason:"Target muscles need recovery",suggestion:"Reduce volume by 30-40% for this exercise, add 1-2 RIR, or take an extra rest day",protocol:{setReduction:.35,rirIncrease:1,weightMaintain:!0,duration:"1-2 sessions"}};if(n.length>=3&&t>.75&&n.slice(0,3).map(E=>!E.sets||E.sets.length===0?0:E.sets.reduce((b,p)=>b+p.w*p.r,0)).every((E,b,p)=>b===0||E<=p[b-1]))return{needed:!0,reason:"Performance declining despite adequate recovery - possible overtraining",suggestion:"Take a deload week to resensitize to training stimulus",protocol:{setReduction:.4,rirIncrease:2,weightReduction:.2,duration:"1 week"}};const m=r.prim||[];return(m.length>0?m.reduce((i,S)=>i+(a[S]||0),0)/m.length:0)>Ke.MAX_WEEKLY_STIMULUS?{needed:!0,reason:"Weekly volume is excessive for target muscles",suggestion:"Reduce total sets this week to allow adaptation",protocol:{setReduction:.3,rirIncrease:1,duration:"1 week"}}:{needed:!1}}function Ss(t,s,r,a){if(!t||!t.sets||t.sets.length===0)return{trend:"insufficient_data"};const n=t.sets,l=n.reduce((x,E)=>E.w*E.r>x.w*x.r?E:x,n[0]),m=n.reduce((x,E)=>x+E.rir,0)/n.length;let o="stable",i="stable";if(s&&s.sets&&s.sets.length>0){const x=s.sets.reduce((p,d)=>d.w*d.r>p.w*p.r?d:p,s.sets[0]),E=l.w*l.r,b=x.w*x.r;E>b*1.05?o="improved":E<b*.95&&(o="declined"),l.w>x.w*1.02?i="increasing":l.w<x.w*.98&&(i="decreasing")}let S="stable";if(a.length>=4){const E=a.slice(0,4).map(d=>{if(!d.sets||d.sets.length===0)return 0;const g=d.sets.reduce((f,C)=>C.w*C.r>f.w*f.r?C:f,d.sets[0]);return g.w*g.r}).reverse(),b=E.every((d,g,f)=>g===0||d>=f[g-1]*.95),p=E.every((d,g,f)=>g===0||d<=f[g-1]*1.05);b?S="increasing":p&&(S="decreasing")}return{trend:o,volumeTrend:i,longTermTrend:S,avgRir:m,topSet:l,setCount:n.length}}function Ns(t,s,r,a){if(t.length<3)return{stagnant:!1,message:"Insufficient history to detect stagnation"};const n=t.slice(0,4).map(o=>!o.sets||o.sets.length===0?0:o.sets.reduce((i,S)=>i+S.w*S.r,0)),l=n.reduce((o,i)=>o+i,0)/n.length;if(n.every(o=>Math.abs(o-l)<l*.15)&&s>.8){const o=a.prim||[];return(o.length>0?o.reduce((S,x)=>S+(r[x]||0),0)/o.length:0)<Ke.OPTIMAL_SETS_PER_WEEK?{stagnant:!0,message:"Volume has plateaued but you can handle more",recommendation:"add_volume"}:{stagnant:!0,message:"Performance has plateaued at current volume",recommendation:"increase_intensity"}}return{stagnant:!1,message:"Progressing normally"}}function Es(t,s,r,a,n,l,m){var b;const{trend:o,avgRir:i,topSet:S,longTermTrend:x}=t,E=J.PROGRESSION_THRESHOLD;if(r>=E&&a>=E){if(s.stagnant){if(s.recommendation==="add_volume")return{advice:"add_volume",readiness:"high",suggestion:"Add 1-2 sets to increase stimulus. Your recovery can handle more volume.",recommendedSets:(((b=l.sets)==null?void 0:b.length)||3)+1,muscleReadiness:r,systemicReadiness:a};if(i<=1){const p=Ze(n.type);return{advice:"progress",readiness:"high",suggestion:`Great work! Increase weight by ${p}lb. You're consistently close to failure.`,recommendedWeight:S.w+p,muscleReadiness:r,systemicReadiness:a}}else return{advice:"reduce_rir",readiness:"high",suggestion:"Push closer to failure (reduce RIR by 1-2) before adding weight",recommendedRirReduction:i>3?2:1,muscleReadiness:r,systemicReadiness:a}}if(i<=Ke.RIR_PROGRESSION_THRESHOLD){const p=Ze(n.type);return x==="increasing"?{advice:"progress",readiness:"high",suggestion:`Excellent progress! Increase weight by ${p}lb.`,recommendedWeight:S.w+p,reason:"Consistent performance improvement with low RIR",muscleReadiness:r,systemicReadiness:a}:{advice:"progress",readiness:"high",suggestion:`Time to progress. Increase weight by ${p}lb.`,recommendedWeight:S.w+p,muscleReadiness:r,systemicReadiness:a}}return i>=3?{advice:"push_harder",readiness:"high",suggestion:"You have room to push harder. Reduce RIR by 1-2 to maximize stimulus.",recommendedRirReduction:2,muscleReadiness:r,systemicReadiness:a}:{advice:"maintain",readiness:"high",suggestion:"Maintain current approach - you're in the optimal stimulus zone.",reason:"Good RIR range (2-3) with high readiness",muscleReadiness:r,systemicReadiness:a}}return r>=.65&&a>=.65?o==="declined"||x==="decreasing"?{advice:"reduce",readiness:"moderate",suggestion:"Performance is declining. Add 1 RIR and maintain weight to prioritize recovery.",reason:"Recent performance decline suggests accumulated fatigue",recommendedRirIncrease:1,muscleReadiness:r,systemicReadiness:a}:{advice:"maintain",readiness:"moderate",suggestion:"Maintain current load and focus on movement quality and technique.",reason:"Moderate readiness - prioritize quality over progression",muscleReadiness:r,systemicReadiness:a}:{advice:"reduce",readiness:"low",suggestion:"Add 1-2 RIR to reduce fatigue accumulation. Maintain technique focus.",reason:"Readiness is below optimal - reducing intensity prevents further fatigue accumulation",recommendedRirIncrease:r<.5?2:1,muscleReadiness:r,systemicReadiness:a}}function Rs({exercises:t,workouts:s,muscleReadiness:r,systemicReadiness:a,weeklyStimulus:n,activeProgram:l,currentDayIndex:m,getCurrentDay:o,onSessionComplete:i,onAutoSave:S,onSaveRecoveryOnly:x,onLoadProgramDay:E,useRestTimer:b,settings:p,theme:d}){var Xe,Je;const[g,f]=c.useState(Be()),[C,j]=c.useState(null),[h,F]=c.useState(""),[_,O]=c.useState([]),[M,U]=c.useState({w:"",r:"",rir:""}),[w,W]=c.useState([]),[u,y]=c.useState(null),[A,B]=c.useState(!1),[z,k]=c.useState(!1),[I,G]=c.useState(5),[Y,Q]=c.useState({}),le=c.useRef(null),se=b?b():null,ue=(p==null?void 0:p.restTimerEnabled)??!0;c.useEffect(()=>{const R=s.filter(P=>P.date===g);R.length>0?W(R):W([]),F(""),O([]),U({w:"",r:"",rir:""}),j(null)},[g,s]);const we=()=>{const R=new Date(g);R.setDate(R.getDate()-1),f(R.toISOString().split("T")[0])},Se=()=>{const R=new Date(g);R.setDate(R.getDate()+1),f(R.toISOString().split("T")[0])},Ne=()=>{f(Be())},be=R=>{const P=new Date(R+"T00:00:00"),V=new Date(Be()+"T00:00:00"),K=new Date(V);K.setDate(K.getDate()-1);const ne=new Date(V);return ne.setDate(ne.getDate()+1),P.toDateString()===V.toDateString()?"Today":P.toDateString()===K.toDateString()?"Yesterday":P.toDateString()===ne.toDateString()?"Tomorrow":P.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},ge=ht(t),ye=t.find(R=>R.id==h),Z=w.find(R=>R.id==h&&R.sets.length===0),N=Z&&Z.prescribedSets,$=h?at(h,t,s,r,a,n):null,L=h?s.filter(R=>R.id==h).sort((R,P)=>new Date(P.date)-new Date(R.date))[0]:null,v=R=>{F(R),O([]),U({w:"",r:"",rir:""}),y(null),B(!1),se&&se.stop();const P=s.filter(K=>K.id==R).sort((K,ne)=>new Date(ne.date)-new Date(K.date))[0],V=w.find(K=>K.id==R&&K.prescribedWeight);V&&V.prescribedWeight?U({w:V.prescribedWeight.toString(),r:"",rir:""}):P&&P.sets&&P.sets.length>0&&U({w:P.sets[0].w.toString(),r:"",rir:""})},T=()=>{F(""),O([]),U({w:"",r:"",rir:""}),B(!0)},D=()=>{if(!M.w||!M.r||M.rir===""){alert("Fill all fields");return}const R={w:parseFloat(M.w),r:parseInt(M.r),rir:parseInt(M.rir)};O([..._,R]),U({w:M.w,r:"",rir:""}),se&&ue&&se.start(p.defaultRestTime||120)},H=R=>{O(_.filter((P,V)=>V!==R))},q=R=>{const P=_[R];y(R),U({w:P.w.toString(),r:P.r.toString(),rir:P.rir.toString()}),setTimeout(()=>{var V;(V=le.current)==null||V.scrollIntoView({behavior:"smooth",block:"center"})},100)},re=()=>{if(!M.w||!M.r||M.rir===""){alert("Fill all fields");return}const R=[..._];R[u]={w:parseFloat(M.w),r:parseInt(M.r),rir:parseInt(M.rir)},O(R),y(null),U({w:"",r:"",rir:""})},me=()=>{y(null),U({w:"",r:"",rir:""})},Te=async R=>{if(console.log("ðŸŸ¢ AUTO-SAVE SESSION CALLED"),console.log("  Updated session:",R),console.log("  Updated session length:",R.length),console.log("  Date:",g),R.length===0){console.log("  âš ï¸ Session is empty - skipping save");return}try{console.log("  â³ Calling onAutoSave..."),await S(R,g),console.log("  âœ… AUTO-SAVE COMPLETE")}catch(P){console.error("  âŒ Auto-save failed:",P)}},oe=async()=>{if(!h||_.length===0){alert("Select exercise and add sets");return}const R=t.find(K=>K.id==h);if(!R)return;w.length===0&&!C&&j(g);const P=w.findIndex(K=>K.id==h&&K.sets.length===0);let V;P!==-1?(V=[...w],V[P]={...V[P],sets:[..._]},W(V)):(V=[...w,{...R,sets:[..._],timestamp:Date.now()}],W(V)),await Te(V),O([]),U({w:"",r:"",rir:""}),F(""),se&&se.stop()},xe=(R,P)=>{const V=at(R.id,t,s,r,a,n),K=s.filter(Ce=>Ce.id==R.id);if(K.length===0)return{sets:P.sets,reps:P.reps,rir:P.rir,isAdapted:!1,progression:V};K.sort((Ce,$e)=>new Date($e.date)-new Date(Ce.date))[0];let ne=P.sets,pe=P.reps,ve=P.rir,Ae=null;switch(V.advice){case"progress":Ae=V.recommendedWeight;break;case"push_harder":ve=Math.max(0,P.rir-1);break;case"deload":ne=Math.max(1,Math.ceil(P.sets*.5)),ve=Math.min(5,P.rir+2);break;case"reduce":V.readiness==="low"?(ve=Math.min(5,P.rir+1),ne=Math.max(1,P.sets-1)):ve=Math.min(5,P.rir+1);break}return{sets:ne,reps:pe,rir:ve,weight:Ae,isAdapted:!0,progression:V,basePrescription:P}},Ee=()=>{const R=E();if(!R)return;const P=R.exercises.map(K=>{var ve,Ae,Ce;const ne=t.find($e=>$e.id===K.exId||$e.id===K.id);if(!ne)return console.warn("Exercise not found:",K),null;const pe=xe(ne,{sets:K.sets,reps:K.reps,rir:K.rir});return{...ne,prescribedSets:pe.sets,prescribedReps:pe.reps,prescribedRir:pe.rir,prescribedWeight:pe.weight,basePrescribedSets:(ve=pe.basePrescription)==null?void 0:ve.sets,basePrescribedReps:(Ae=pe.basePrescription)==null?void 0:Ae.reps,basePrescribedRir:(Ce=pe.basePrescription)==null?void 0:Ce.rir,isAdapted:pe.isAdapted,sets:[],timestamp:Date.now()+Math.random()}}).filter(Boolean);if(P.length===0){alert("No valid exercises found in program day");return}W([...w,...P]),!h&&P.length>0&&v(P[0].id);const V=P.filter(K=>K.isAdapted).length;V>0?alert(`Loaded ${P.length} exercises from ${R.name}
${V} prescriptions adapted based on your progress and recovery`):alert(`Loaded ${P.length} exercises from ${R.name}`)},fe=R=>{W(w.filter(P=>P.timestamp!==R))},Re=async()=>{await i([],g,I,Y),alert("Rest day complete. Enhanced recovery applied! ðŸ’ª")},De=async()=>{await x(g,I,Y),G(5),Q({}),k(!1),alert("Recovery data saved! ðŸ“Š")},Ie=async()=>{if(w.length===0){alert("Add exercises to session");return}await i(w,C||g,I,Y),j(null),alert("Workout complete! Program advanced to next day. ðŸ’ª")};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Log Session"}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border-2 border-blue-200 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-blue-700",children:"Recording for:"}),e.jsxs("span",{className:"ml-2 font-bold text-blue-900",children:[be(C||g),C&&C!==g&&e.jsxs("span",{className:"ml-2 text-xs text-blue-600",children:["(Session started ",be(C),")"]})]})]}),C&&e.jsx("button",{onClick:()=>j(null),className:"text-xs text-blue-700 hover:text-blue-900 underline",children:"Unlock Date"})]}),l&&o&&((Xe=o())==null?void 0:Xe.isRestDay)&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"text-6xl mb-3",children:"ðŸ˜´"}),e.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-2",children:"Rest Day"}),e.jsxs("p",{className:"text-blue-700 mb-4",children:["Today is a scheduled rest day in your ",l.name," program."]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Recovery Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Systemic Readiness:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${a>.85?"bg-green-500":a>.65?"bg-yellow-500":"bg-red-500"}`,style:{width:`${a*100}%`}})}),e.jsxs("span",{className:"text-sm font-bold",children:[(a*100).toFixed(0),"%"]})]})]}),Object.entries(r).sort(([,R],[,P])=>R-P).slice(0,3).map(([R,P])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm",children:[R,":"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${P>.85?"bg-green-500":P>.65?"bg-yellow-500":"bg-red-500"}`,style:{width:`${P*100}%`}})}),e.jsxs("span",{className:"text-sm font-bold",children:[(P*100).toFixed(0),"%"]})]})]},R))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>{confirm("Mark this rest day as complete and advance to next day?")&&Re()},className:"w-full bg-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-blue-700",children:"âœ“ Complete Rest Day"}),e.jsx("button",{onClick:()=>{confirm("Are you sure you want to train on a scheduled rest day? This may impact recovery.")},className:"w-full bg-yellow-500 text-white py-3 rounded-lg font-semibold text-base hover:bg-yellow-600",children:"âš ï¸ Train Anyway (Not Recommended)"})]}),e.jsx("p",{className:"text-xs text-blue-600 text-center mt-4",children:"ðŸ’¡ Rest days help maximize muscle growth and prevent overtraining"})]})}),e.jsxs("div",{className:"mb-4 flex items-center justify-between bg-slate-100 rounded-lg p-2",children:[e.jsx("button",{onClick:we,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors","aria-label":"Previous day",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:Ne,className:"px-4 py-2 font-semibold text-base hover:bg-slate-200 rounded-lg transition-colors",children:be(g)}),e.jsx("button",{onClick:Se,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors","aria-label":"Next day",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("button",{onClick:()=>k(!z),className:"w-full mb-4 py-3 px-4 bg-slate-100 rounded-lg text-base font-semibold hover:bg-slate-200 transition-colors",children:[z?"Hide":"+ Log"," Fatigue & Soreness"]}),z&&e.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg border-2",children:[e.jsx("h3",{className:"font-semibold mb-4 text-lg",children:"How do you feel today?"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-base font-medium mb-3",children:["Overall Fatigue: ",I,"/10"]}),e.jsx("input",{type:"range",min:"0",max:"10",value:I,onChange:R=>G(parseInt(R.target.value)),className:"w-full h-3"}),e.jsxs("div",{className:"flex justify-between text-sm text-slate-600 mt-2",children:[e.jsx("span",{children:"Energized"}),e.jsx("span",{children:"Neutral"}),e.jsx("span",{children:"Exhausted"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-base font-medium mb-3",children:"Muscle Soreness (0-10)"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ae.map(R=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-base w-20 font-medium",children:R}),e.jsx("input",{type:"number",min:"0",max:"10",value:Y[R]||0,onChange:P=>Q({...Y,[R]:parseInt(P.target.value)||0}),className:"flex-1 px-3 py-2 border rounded-lg text-base text-center"})]},R))})]}),e.jsx("button",{onClick:De,className:"w-full bg-blue-600 text-white py-3 rounded-lg text-base font-bold hover:bg-blue-700 transition-colors",children:"ðŸ’¾ Save Recovery Data (No Exercises)"}),e.jsx("p",{className:"text-xs text-slate-600 text-center mt-2",children:"Save how you feel without logging exercises"})]}),l&&e.jsx("div",{className:"mb-6 p-4 bg-purple-50 border-2 border-purple-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-purple-900 text-lg",children:l.name}),e.jsxs("div",{className:"text-base text-purple-700",children:["Day ",m+1," of ",l.days.length,":"," ",(Je=l.days[m])==null?void 0:Je.name]})]}),e.jsx("button",{onClick:Ee,className:"bg-purple-600 text-white px-5 py-3 rounded-lg text-base font-semibold whitespace-nowrap hover:bg-purple-700",children:"Load Day"})]})}),t.length===0?e.jsxs("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg p-6 text-center",children:[e.jsx("p",{className:"mb-4 text-lg",children:"No exercises in library"}),e.jsx("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg text-lg font-semibold",children:"Go to Exercises"})]}):e.jsxs(e.Fragment,{children:[!h&&!A&&e.jsx("button",{onClick:()=>B(!0),className:`w-full py-4 rounded-lg font-bold text-lg mb-4 text-white ${(d==null?void 0:d.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"+ Add Exercise"}),A&&!h&&e.jsxs("div",{className:"mb-4 p-4 border-2 rounded-lg bg-slate-50 animate-slideDown",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Select Exercise"}),e.jsx("button",{onClick:()=>B(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"Ã—"})]}),e.jsx(pt,{exercises:t,exercisesByMuscle:ge,onSelect:v,placeholder:"2ï¸âƒ£ Choose exercise..."})]}),ye&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`mb-4 p-4 rounded-lg border-2 ${(d==null?void 0:d.primary)||"bg-blue-600"} bg-opacity-10`,children:[e.jsx("div",{className:"text-sm font-semibold opacity-75 mb-1",children:"Currently Logging:"}),e.jsx("div",{className:"text-xl font-bold",children:ye.name})]}),$&&e.jsx(js,{progression:$,className:"mb-4"}),N&&Z&&e.jsxs("div",{className:"bg-purple-50 border-2 border-purple-200 rounded-lg p-4 mb-4",children:[e.jsx("div",{className:"text-base font-semibold text-purple-900 mb-1",children:Z.isAdapted?"Adapted Prescription":"Program Prescription"}),e.jsxs("div",{className:"text-sm text-purple-800 mb-2",children:[Z.prescribedSets," sets Ã—"," ",Z.prescribedReps," reps @ ",Z.prescribedRir," RIR",Z.prescribedWeight&&e.jsxs("span",{className:"font-semibold",children:[" Â· ",Z.prescribedWeight,"lb"]})]}),Z.isAdapted&&Z.basePrescribedSets&&e.jsxs("div",{className:"text-xs text-purple-600 pt-2 border-t border-purple-200",children:["Base program: ",Z.basePrescribedSets,"Ã—",Z.basePrescribedReps," @ ",Z.basePrescribedRir,"RIR",e.jsx("span",{className:"ml-2 italic",children:"(adjusted for recovery & progress)"})]})]}),L&&L.sets&&L.sets.length>0&&e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"text-base font-semibold text-blue-900 mb-1",children:["Last Performance (",new Date(L.date).toLocaleDateString(),")"]}),e.jsx("div",{className:"text-sm text-blue-800",children:L.sets.map((R,P)=>e.jsxs("span",{children:[P>0&&", ",R.w,"lb Ã— ",R.r," @ ",R.rir,"RIR"]},P))})]}),ue&&se&&se.isActive&&se.timeRemaining>0&&e.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-6 text-center mb-4",children:[e.jsx("div",{className:"text-base font-semibold text-green-900 mb-2",children:"Rest Timer"}),e.jsx("div",{className:"text-5xl font-bold text-green-700",children:se.formattedTime})]}),_.length>0&&e.jsx("div",{className:"bg-slate-50 p-4 rounded-lg mb-4 border-2 stagger-children",children:_.map((R,P)=>u===P?e.jsx("div",{className:"border-2 border-blue-300 rounded p-2 mb-2",children:e.jsx(rt,{weight:M.w,reps:M.r,rir:M.rir,onWeightChange:V=>U({...M,w:V}),onRepsChange:V=>U({...M,r:V}),onRirChange:V=>U({...M,rir:V}),onSubmit:re,onCancel:me,submitLabel:"Save",showCancel:!0})},P):e.jsxs("div",{className:"flex justify-between items-center text-base mb-2 py-2 border-b last:border-b-0",children:[e.jsxs("span",{className:"font-semibold",children:["Set ",P+1,": ",R.w,"lb Ã— ",R.r," @ ",R.rir,"RIR"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>q(P),className:"text-blue-500 text-lg",children:"âœï¸"}),e.jsx("button",{onClick:()=>H(P),className:"text-red-500 text-2xl px-2",children:"Ã—"})]})]},P))}),u===null&&e.jsx("div",{ref:le,children:e.jsx(rt,{weight:M.w,reps:M.r,rir:M.rir,onWeightChange:R=>U({...M,w:R}),onRepsChange:R=>U({...M,r:R}),onRirChange:R=>U({...M,rir:R}),onSubmit:D,autoFocusReps:_.length>0})}),_.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:oe,className:"w-full bg-green-600 text-white py-4 rounded-lg font-bold text-lg mt-3 hover:bg-green-700 btn-press",children:"âœ“ Finish Exercise"}),e.jsx("button",{onClick:T,className:"w-full bg-gray-400 text-white py-3 rounded-lg font-semibold text-base mt-2 hover:bg-gray-500 btn-press",children:"Change Exercise"})]})]})]}),w.length>0&&e.jsxs("div",{className:"mt-8 border-t-2 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Session (",w.length,")"]}),e.jsx("button",{onClick:Ie,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-bold text-lg hover:bg-blue-700 btn-press",children:"Finish"})]}),e.jsx("div",{className:"stagger-children space-y-3",children:w.map((R,P)=>e.jsxs("div",{className:`border-2 p-4 rounded-lg transition-all ${R.id===h&&R.sets.length===0?"bg-blue-50 border-blue-400 shadow-md":R.sets.length===0?"bg-yellow-50 border-yellow-300":"bg-slate-50 border-slate-200"} card-hover`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-lg flex items-center gap-2",children:[R.name,R.id===h&&R.sets.length===0&&e.jsx("span",{className:"text-xs bg-blue-500 text-white px-2 py-1 rounded",children:"â† Logging"}),R.sets.length===0&&e.jsx("span",{className:"text-xs bg-yellow-500 text-white px-2 py-1 rounded",children:"Incomplete"})]}),R.prescribedSets&&e.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:["Target: ",R.prescribedSets,"Ã—",R.prescribedReps," @ ",R.prescribedRir,"RIR",R.prescribedWeight&&` Â· ${R.prescribedWeight}lb`,R.isAdapted&&e.jsx("span",{className:"ml-1 bg-purple-100 px-1 rounded text-purple-700",children:"adapted"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[R.sets.length===0&&R.id!==h&&e.jsx("button",{onClick:()=>v(R.id),className:"bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600",children:"Log Sets"}),e.jsx("button",{onClick:()=>{confirm(`Remove ${R.name} from session?`)&&fe(R.timestamp)},className:"text-red-500 text-xl",children:"Ã—"})]})]}),R.sets.length>0?R.sets.map((V,K)=>e.jsxs("div",{className:"text-sm py-1",children:["Set ",K+1,": ",V.w,"lb Ã— ",V.r," @ ",V.rir,"RIR"]},K)):e.jsx("div",{className:"text-sm text-slate-500 italic",children:"No sets logged yet"})]},P))})]})]})}function Ds({workouts:t,readinessHistory:s=[],onUpdateWorkout:r,onDeleteWorkout:a,theme:n}){const[l,m]=c.useState(null),[o,i]=c.useState(new Date),[S,x]=c.useState(null),[E,b]=c.useState([]);console.log("ðŸ“Š HistoryView readinessHistory:",s);const p=Qt(o),d={};t.forEach(w=>{d[w.date]||(d[w.date]=[]),d[w.date].push(w)});const g=qe(new Date),f=()=>{const w=new Date(o);w.setMonth(o.getMonth()-1),i(w)},C=()=>{const w=new Date(o);w.setMonth(o.getMonth()+1),i(w)},j=()=>{i(new Date)},h=w=>{x(w.timestamp),b([...w.sets])},F=()=>{x(null),b([])},_=w=>{const W={...w,sets:E};r(W),x(null),b([])},O=(w,W,u)=>{const y=[...E];y[w]={...y[w],[W]:W==="rir"?parseInt(u):parseFloat(u)},b(y)},M=w=>{b(E.filter((W,u)=>u!==w))},U=()=>{const w=E[E.length-1];b([...E,{w:(w==null?void 0:w.w)||0,r:(w==null?void 0:w.r)||0,rir:(w==null?void 0:w.rir)||0}])};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6",children:"History"}),t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“Š"}),e.jsx("p",{className:"text-slate-500 text-lg mb-4",children:"No workout history yet"}),e.jsx("p",{className:"text-slate-400",children:"Complete your first workout to see it here"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-semibold text-xl",children:o.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:f,className:"px-3 py-2 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:"â†"}),e.jsx("button",{onClick:j,className:`px-4 py-2 rounded-lg font-semibold text-sm ${(n==null?void 0:n.light)||"bg-blue-100"} ${(n==null?void 0:n.accent)||"text-blue-700"} hover:opacity-80 transition-opacity`,children:"Today"}),e.jsx("button",{onClick:C,className:"px-3 py-2 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:"â†’"})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 sm:gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(w=>e.jsx("div",{className:"text-center font-semibold text-xs sm:text-sm py-2 text-slate-600",children:w},w)),p.map((w,W)=>{if(!w)return e.jsx("div",{},W);const u=qe(w),y=d[u]||[],A=s.find(G=>G.date===u),B=A&&(A.perceivedFatigue!==void 0||A.muscleSoreness&&Object.keys(A.muscleSoreness).length>0),z=y.length>0||B,k=u===g,I=u===l;return e.jsxs("button",{onClick:()=>z&&m(u),className:`aspect-square rounded-lg flex flex-col items-center justify-center text-sm sm:text-base transition-all ${z?y.length>0?"bg-green-100 hover:bg-green-200 cursor-pointer font-semibold border-2 border-green-300":"bg-blue-100 hover:bg-blue-200 cursor-pointer font-semibold border-2 border-blue-300":"bg-slate-50 border-2 border-slate-200"} ${k?`ring-2 ${(n==null?void 0:n.primary.split(" ")[0].replace("bg-","ring-"))||"ring-blue-500"}`:""} ${I?"ring-2 ring-purple-500":""}`,children:[e.jsx("span",{children:w.getDate()}),y.length>0?e.jsx("span",{className:"text-xs text-green-700 font-bold",children:y.length}):B?e.jsx("span",{className:"text-xs text-blue-700 font-bold",children:"ðŸ“Š"}):null]},W)})]})]}),l&&(d[l]||s.find(w=>w.date===l))&&e.jsxs("div",{className:"border-t-2 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold",children:Jt(l)}),e.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-slate-200 rounded-lg text-sm font-semibold hover:bg-slate-300 transition-colors",children:"Close"})]}),d[l]&&d[l].length>0&&e.jsx("div",{className:"space-y-4 stagger-children",children:d[l].map((w,W)=>e.jsxs("div",{className:"border-2 p-5 rounded-lg bg-slate-50 card-hover",children:[e.jsxs("div",{className:"font-bold text-lg mb-3 flex justify-between items-start",children:[e.jsx("span",{children:w.name}),e.jsx("div",{className:"flex flex-wrap gap-1",children:w.prim&&w.prim.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:w.prim.map(u=>e.jsx("span",{className:`text-xs px-2 py-1 rounded font-semibold ${(n==null?void 0:n.light)||"bg-blue-100"} ${(n==null?void 0:n.accent)||"text-blue-700"}`,children:u},u))})})]}),w.sets&&w.sets.length>0?S===w.timestamp?e.jsxs("div",{children:[e.jsx("div",{className:"space-y-2 mb-4",children:E.map((u,y)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("span",{className:"text-sm font-semibold w-12",children:["Set ",y+1,":"]}),e.jsx("input",{type:"number",step:"0.5",value:u.w,onChange:A=>O(y,"w",A.target.value),className:"w-20 px-2 py-1 border-2 rounded text-center",placeholder:"lbs"}),e.jsx("span",{className:"text-sm",children:"Ã—"}),e.jsx("input",{type:"number",value:u.r,onChange:A=>O(y,"r",A.target.value),className:"w-16 px-2 py-1 border-2 rounded text-center",placeholder:"reps"}),e.jsx("span",{className:"text-sm",children:"@"}),e.jsx("input",{type:"number",value:u.rir,onChange:A=>O(y,"rir",A.target.value),className:"w-16 px-2 py-1 border-2 rounded text-center",placeholder:"RIR"}),e.jsx("button",{onClick:()=>M(y),className:"text-red-500 hover:text-red-700 px-2",children:"Ã—"})]},y))}),e.jsx("div",{className:"flex gap-2 mb-3",children:e.jsx("button",{onClick:U,className:`flex-1 text-white py-2 rounded text-sm ${(n==null?void 0:n.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"+ Add Set"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>_(w),className:"flex-1 bg-green-600 text-white py-2 rounded font-semibold hover:bg-green-700",children:"âœ“ Save Changes"}),e.jsx("button",{onClick:F,className:"flex-1 bg-gray-400 text-white py-2 rounded font-semibold hover:bg-gray-500",children:"Cancel"})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:"space-y-1 mb-3",children:w.sets.map((u,y)=>e.jsxs("div",{className:"text-base text-slate-700 py-1",children:["Set ",y+1,":"," ",e.jsxs("span",{className:"font-semibold",children:[u.w,"lb Ã— ",u.r]})," ","@ ",u.rir,"RIR"]},y))}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-slate-300",children:[e.jsx("button",{onClick:()=>h(w),className:`flex-1 text-white py-2 rounded font-semibold ${(n==null?void 0:n.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"âœï¸ Edit"}),e.jsx("button",{onClick:()=>{confirm(`Delete ${w.name}?`)&&a(w.timestamp)},className:"flex-1 bg-red-600 text-white py-2 rounded font-semibold hover:bg-red-700",children:"ðŸ—‘ï¸ Delete"})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-300",children:[e.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[e.jsx("span",{children:"Total Volume:"}),e.jsxs("span",{className:"font-semibold",children:[w.sets.reduce((u,y)=>u+y.w*y.r,0).toLocaleString()," ","lbs"]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[e.jsx("span",{children:"Total Sets:"}),e.jsx("span",{className:"font-semibold",children:w.sets.length})]})]})]}):e.jsx("p",{className:"text-slate-500 italic",children:"No set data"})]},W))}),d[l]&&d[l].length>0&&e.jsxs("div",{className:`border-2 rounded-lg p-4 mt-4 ${(n==null?void 0:n.light)||"bg-blue-50 border-blue-200"}`,children:[e.jsx("div",{className:`font-semibold mb-2 ${(n==null?void 0:n.text)||"text-blue-900"}`,children:"Day Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Total Exercises"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:d[l].length})]}),e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Total Sets"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:d[l].reduce((w,W)=>{var u;return w+(((u=W.sets)==null?void 0:u.length)||0)},0)})]}),e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Total Volume"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:d[l].reduce((w,W)=>{var u;return w+(((u=W.sets)==null?void 0:u.reduce((y,A)=>y+A.w*A.r,0))||0)},0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Muscles Trained"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:new Set(d[l].flatMap(w=>w.prim||[])).size})]})]})]}),(()=>{console.log("ðŸ” Looking for recovery data for date:",l),console.log("  Available readinessHistory:",s);const w=s.find(u=>u.date===l);if(console.log("  Found recovery data:",w),!w||!w.perceivedFatigue&&!w.muscleSoreness)return console.log("  âŒ No recovery data to display"),null;const W=w.muscleSoreness&&Object.values(w.muscleSoreness).some(u=>u>0);return console.log("  âœ… Displaying recovery data"),e.jsxs("div",{className:"mt-4 p-5 bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:[e.jsxs("h4",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ“Š"}),"Recovery Data"]}),w.perceivedFatigue!==void 0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Overall Fatigue:"}),e.jsxs("span",{className:"text-lg font-bold",children:[w.perceivedFatigue,"/10"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${w.perceivedFatigue<=3?"bg-green-500":w.perceivedFatigue<=6?"bg-yellow-500":w.perceivedFatigue<=8?"bg-orange-500":"bg-red-500"}`,style:{width:`${w.perceivedFatigue*10}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mt-1",children:[e.jsx("span",{children:"Energized"}),e.jsx("span",{children:"Exhausted"})]})]}),W&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-3",children:"Muscle Soreness:"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(w.muscleSoreness).filter(([u,y])=>y>0).sort((u,y)=>y[1]-u[1]).map(([u,y])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium w-20",children:[u,":"]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-2 rounded-full ${y<=3?"bg-green-500":y<=6?"bg-yellow-500":y<=8?"bg-orange-500":"bg-red-500"}`,style:{width:`${y*10}%`}})}),e.jsx("span",{className:"text-sm font-bold w-8 text-right",children:y})]},u))})]})]})})()]}),!l&&e.jsxs("div",{className:"mt-8 pt-8 border-t-2",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"All-Time Stats"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 stagger-children",children:[e.jsxs("div",{className:`rounded-lg p-4 border-2 bg-gradient-to-br card-hover ${(n==null?void 0:n.light)||"from-blue-50 to-blue-100 border-blue-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 ${(n==null?void 0:n.accent)||"text-blue-700"}`,children:"Total Workouts"}),e.jsx("div",{className:`text-3xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:new Set(t.map(w=>w.date)).size})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border-2 border-green-200 card-hover",children:[e.jsx("div",{className:"text-sm text-green-700 mb-1",children:"Total Sets"}),e.jsx("div",{className:"text-3xl font-bold text-green-900",children:t.reduce((w,W)=>{var u;return w+(((u=W.sets)==null?void 0:u.length)||0)},0)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 border-2 border-purple-200 card-hover",children:[e.jsx("div",{className:"text-sm text-purple-700 mb-1",children:"Total Volume"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-900",children:[(t.reduce((w,W)=>{var u;return w+(((u=W.sets)==null?void 0:u.reduce((y,A)=>y+A.w*A.r,0))||0)},0)/1e3).toFixed(1),"k"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 border-2 border-orange-200 card-hover",children:[e.jsx("div",{className:"text-sm text-orange-700 mb-1",children:"Exercises"}),e.jsx("div",{className:"text-3xl font-bold text-orange-900",children:new Set(t.map(w=>w.id)).size})]})]})]})]})]})}function Cs({systemicReadiness:t,muscleReadiness:s,weeklyStimulus:r,weeklySummary:a,theme:n}){const l=i=>i>=.85?"bg-green-500":i>=.65?"bg-yellow-500":i>=.5?"bg-orange-500":"bg-red-500",m=Object.values(s).reduce((i,S)=>i+S,0)/ae.length,o=Object.values(r).reduce((i,S)=>i+S,0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"p-5 bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Systemic Readiness"}),e.jsxs("div",{className:"text-4xl font-bold mb-3 text-blue-700",children:[(t*100).toFixed(0),"%"]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${l(t)}`,style:{width:`${t*100}%`}})})]}),e.jsxs("div",{className:"p-5 bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-semibold text-green-900 mb-2",children:"Avg Muscle Readiness"}),e.jsxs("div",{className:"text-4xl font-bold text-green-700 mb-3",children:[(m*100).toFixed(0),"%"]}),e.jsx("div",{className:"flex gap-1",children:ae.slice(0,10).map(i=>e.jsx("div",{className:"flex-1 h-3 rounded",style:{backgroundColor:s[i]>=.85?"#22c55e":s[i]>=.65?"#eab308":s[i]>=.5?"#f97316":"#ef4444"},title:`${i}: ${(s[i]*100).toFixed(0)}%`},i))})]}),e.jsxs("div",{className:"p-5 bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-semibold text-purple-900 mb-2",children:"Total Weekly Stimulus"}),e.jsx("div",{className:"text-4xl font-bold text-purple-700 mb-3",children:o.toFixed(1)}),e.jsx("div",{className:"text-sm text-purple-700",children:"sets equivalent across all muscles"})]})]}),e.jsxs("div",{className:"mb-8 p-5 bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-200 rounded-lg",children:[e.jsx("h2",{className:"font-bold text-xl mb-4",children:"This Week's Progress"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-700",children:a.workouts}),e.jsx("div",{className:"text-sm text-slate-600",children:"Workouts"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-3xl font-bold ${(n==null?void 0:n.accent)||"text-blue-700"}`,children:a.totalSets}),e.jsx("div",{className:"text-sm text-slate-600",children:"Total Sets"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-700",children:a.musclesWorked.length}),e.jsx("div",{className:"text-sm text-slate-600",children:"Muscles Hit"})]})]})]})]})}function ks({chartData:t,chartType:s,metricView:r,metricInfo:a,trend:n,timeframe:l,selectedMuscle:m,theme:o,onMetricChange:i,onTimeframeChange:S,onMuscleChange:x,onChartTypeChange:E}){const b=Math.max(...t.map(g=>g.value),1),p=Math.min(...t.map(g=>g.value),0),d=b-p||1;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6 p-5 bg-slate-50 rounded-lg border-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Metric"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["volume","fatigue","stimulus","efficiency"].map(g=>e.jsx("button",{onClick:()=>i(g),className:`px-3 py-2 rounded-lg text-xs font-semibold transition-all ${r===g?`${(o==null?void 0:o.primary)||"bg-blue-600"} text-white shadow-md`:"bg-white hover:bg-slate-100 border-2"}`,children:g.charAt(0).toUpperCase()+g.slice(1)},g))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Timeframe"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[4,8,12,16].map(g=>e.jsxs("button",{onClick:()=>S(g),className:`px-3 py-2 rounded-lg text-sm font-semibold transition-all ${l===g?`${(o==null?void 0:o.primary)||"bg-blue-600"} text-white shadow-md`:"bg-white hover:bg-slate-100 border-2"}`,children:[g,"w"]},g))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Muscle Group"}),e.jsxs("select",{value:m,onChange:g=>x(g.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-sm font-medium bg-white",children:[e.jsx("option",{value:"all",children:"All Muscles"}),ae.map(g=>e.jsx("option",{value:g,children:g},g))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Chart Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["line","bar"].map(g=>e.jsx("button",{onClick:()=>E(g),className:`px-3 py-2 rounded-lg text-sm font-semibold transition-all ${s===g?`${(o==null?void 0:o.primary)||"bg-blue-600"} text-white shadow-md`:"bg-white hover:bg-slate-100 border-2"}`,children:g.charAt(0).toUpperCase()+g.slice(1)},g))})]})]})}),e.jsx("div",{className:`mb-6 p-4 bg-gradient-to-r ${(o==null?void 0:o.light)||"from-slate-50 to-blue-50"} border-2 ${(o==null?void 0:o.primary.split(" ")[0].replace("bg-","border-"))||"border-blue-200"} rounded-lg`,children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-lg",style:{color:a.color},children:a.label}),e.jsx("div",{className:"text-sm text-slate-600",children:a.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Trend"}),e.jsxs("div",{className:`text-lg font-bold ${n.direction==="increasing"?"text-green-600":n.direction==="decreasing"?"text-red-600":"text-slate-600"}`,children:[n.direction==="increasing"?"â†—":n.direction==="decreasing"?"â†˜":"â†’"," ",Math.abs(parseFloat(n.change)),"%"]})]})]})}),e.jsx("div",{className:"mb-8 p-5 bg-white border-2 rounded-lg shadow-sm",children:t.length>0&&t.some(g=>g.value>0)?e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute left-0 top-0 bottom-8 w-16 flex flex-col justify-between text-xs text-slate-600 text-right pr-2",children:[e.jsx("span",{children:b.toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:(b*.75).toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:(b*.5).toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:(b*.25).toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:p.toLocaleString(void 0,{maximumFractionDigits:1})})]}),e.jsxs("div",{className:"ml-20 mr-4",children:[e.jsxs("svg",{viewBox:"0 0 500 250",className:"w-full",style:{height:"250px"},children:[[0,.25,.5,.75,1].map((g,f)=>e.jsx("line",{x1:"0",y1:250-g*250,x2:"500",y2:250-g*250,stroke:"#e2e8f0",strokeWidth:"1"},f)),s==="line"?e.jsxs(e.Fragment,{children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"areaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:a.color,stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:a.color,stopOpacity:"0.05"})]})}),e.jsx("polygon",{points:["0,250",...t.map((g,f)=>{const C=t.length>1?f/(t.length-1)*500:250,j=250-(g.value-p)/d*250;return`${C},${j}`}),`${t.length>1?500:250},250`].join(" "),fill:"url(#areaGradient)"}),t.length>1&&e.jsx("polyline",{points:t.map((g,f)=>{const C=f/(t.length-1)*500,j=250-(g.value-p)/d*250;return`${C},${j}`}).join(" "),fill:"none",stroke:a.color,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),t.map((g,f)=>{const C=t.length>1?f/(t.length-1)*500:250,j=250-(g.value-p)/d*250;return e.jsxs("g",{children:[e.jsx("circle",{cx:C,cy:j,r:"6",fill:"white",stroke:a.color,strokeWidth:"3"}),e.jsxs("title",{children:[g.week,": ",g.value.toLocaleString(void 0,{maximumFractionDigits:1})," ",a.unit]})]},f)})]}):t.map((g,f)=>{const C=500/t.length*.8,j=f/t.length*500+500/t.length*.1,h=(g.value-p)/d*250,F=250-h;return e.jsxs("g",{children:[e.jsx("rect",{x:j,y:F,width:C,height:h,fill:a.color,opacity:"0.8",rx:"3"}),e.jsxs("title",{children:[g.week,": ",g.value.toLocaleString(void 0,{maximumFractionDigits:1})," ",a.unit]})]},f)})]}),e.jsx("div",{className:"flex justify-between mt-2 text-xs text-slate-600",children:t.map((g,f)=>{const C=f===0||f===t.length-1||t.length>8&&f%Math.floor(t.length/4)===0;return e.jsx("span",{className:C?"":"invisible",children:g.week},f)})})]})]}):e.jsx("p",{className:"text-slate-500 text-center py-8",children:m==="all"?"Complete more workouts to see trends":`No ${m} data in this timeframe`})})]})}function Fs({muscleReadiness:t,weeklyStimulus:s,selectedMuscle:r,onMuscleSelect:a,theme:n}){const l=m=>m>=.85?"bg-green-500":m>=.65?"bg-yellow-500":m>=.5?"bg-orange-500":"bg-red-500";return e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"font-bold text-xl mb-4",children:"Muscle Readiness Breakdown"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:ae.map(m=>{const o=t[m]||1,i=s[m]||0;return e.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all cursor-pointer hover:shadow-md ${r===m?`${(n==null?void 0:n.primary.split(" ")[0].replace("bg-","border-"))||"border-blue-500"} ${(n==null?void 0:n.light)||"bg-blue-50"} shadow-md`:"border-slate-200 hover:border-slate-300"}`,onClick:()=>a(m===r?"all":m),children:[e.jsx("div",{className:"text-sm font-semibold mb-2 text-slate-700",children:m}),e.jsxs("div",{className:"text-2xl font-bold mb-2",children:[(o*100).toFixed(0),"%"]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2 overflow-hidden mb-2",children:e.jsx("div",{className:`h-full transition-all ${l(o)}`,style:{width:`${o*100}%`}})}),e.jsxs("div",{className:"text-xs text-slate-600",children:[i.toFixed(1)," sets/wk"]})]},m)})})]})}function Ts({muscleReadiness:t,systemicReadiness:s,trend:r,lastWorkoutDate:a,theme:n}){var l,m;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"p-5 bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-green-900",children:"ðŸ’ª Recovery Recommendations"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[Object.entries(t).filter(([o,i])=>i<.65).sort((o,i)=>o[1]-i[1]).slice(0,3).map(([o,i])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"âš ï¸"}),e.jsxs("span",{className:"font-medium text-slate-800",children:[o,":"]}),e.jsx("span",{className:"text-slate-700",children:i<.5?"Needs deload":"Reduce volume 20-30%"})]},o)),Object.entries(t).every(([o,i])=>i>=.65)&&e.jsx("div",{className:"text-green-700 font-medium",children:"âœ“ All muscle groups adequately recovered"})]})]}),e.jsxs("div",{className:"p-5 bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-blue-900",children:"ðŸ“Š Training Insights"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-700",children:"Volume trend:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:r.direction})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-700",children:"Most recovered:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:((l=Object.entries(t).sort((o,i)=>i[1]-o[1])[0])==null?void 0:l[0])||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-700",children:"Needs attention:"}),e.jsx("span",{className:"font-semibold text-orange-600",children:((m=Object.entries(t).sort((o,i)=>o[1]-i[1])[0])==null?void 0:m[0])||"N/A"})]})]})]})]}),a&&e.jsxs("div",{className:"p-4 bg-slate-50 border-2 border-slate-200 rounded-lg mb-6",children:[e.jsxs("p",{className:"text-base text-slate-900",children:[e.jsx("strong",{children:"Last workout:"})," ",new Date(a).toLocaleDateString()]}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:"Recovery is calculated automatically based on time since last session"})]}),e.jsxs("div",{className:"p-5 border-2 border-slate-300 bg-white rounded-lg shadow-sm",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-slate-900",children:"Readiness Guide"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:">85%:"})," Ready to progress"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:"65-85%:"})," Maintain current load"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:"50-65%:"})," Reduce intensity"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:"<50%:"})," Deload needed"]})]})]})]})]})}function As({workouts:t,readinessHistory:s,stimulusHistory:r,weeklyStimulus:a,localFatigue:n,timeframe:l,selectedMuscle:m,metricView:o,theme:i}){const S=c.useMemo(()=>{const p=[],d=new Date;for(let g=l-1;g>=0;g--){const f=new Date(d);f.setDate(d.getDate()-g*7);const C=new Date(f);C.setDate(f.getDate()+7);const j={week:g===0?"This week":`${g}w ago`,weekLabel:f.toLocaleDateString("en-US",{month:"short",day:"numeric"}),date:f.toISOString().split("T")[0],volume:{},fatigue:{},stimulus:{},efficiency:{}},h=t.filter(F=>{const _=new Date(F.date);return _>=f&&_<C});ae.forEach(F=>{let _=0;h.forEach(W=>{const u=(W.sets||[]).reduce((y,A)=>y+A.w*A.r,0);W.prim&&W.prim.includes(F)&&(_+=u*1),W.sec&&W.sec.includes(F)&&(_+=u*.6),W.ter&&W.ter.includes(F)&&(_+=u*.3)}),j.volume[F]=_;const O=s.find(W=>{const u=new Date(W.date);return u>=f&&u<C});O&&O.muscleFatigue?j.fatigue[F]=O.muscleFatigue[F]||0:g===0?j.fatigue[F]=n[F]||0:j.fatigue[F]=0;const M=r.find(W=>{const u=new Date(W.date);return u>=f&&u<C});M&&M.stimulus?j.stimulus[F]=M.stimulus[F]||0:g===0?j.stimulus[F]=a[F]||0:j.stimulus[F]=0;const U=j.fatigue[F]||.001,w=j.stimulus[F]||0;j.efficiency[F]=U>0?w/U:0}),p.push(j)}return p},[t,s,r,a,n,l]),x=c.useMemo(()=>S.map(p=>{let d=0;return m==="all"?(d=ae.map(f=>p[o][f]||0).reduce((f,C)=>f+C,0),o==="efficiency"&&(d=d/ae.length)):d=p[o][m]||0,{week:p.week,weekLabel:p.weekLabel,value:d}}),[S,m,o]),E=c.useMemo(()=>{if(x.length<2)return{direction:"stable",change:0};const p=x.slice(0,Math.floor(x.length/2)),d=x.slice(Math.floor(x.length/2)),g=p.reduce((h,F)=>h+F.value,0)/p.length,f=d.reduce((h,F)=>h+F.value,0)/d.length,C=g>0?(f-g)/g*100:0;return{direction:C>5?"increasing":C<-5?"decreasing":"stable",change:C.toFixed(1)}},[x]),b=c.useMemo(()=>({volume:{label:"Volume (lbs)",color:i!=null&&i.primary.includes("blue")?"#2563eb":i!=null&&i.primary.includes("green")?"#16a34a":i!=null&&i.primary.includes("purple")?"#9333ea":i!=null&&i.primary.includes("orange")?"#ea580c":i!=null&&i.primary.includes("red")?"#dc2626":i!=null&&i.primary.includes("indigo")?"#4f46e5":i!=null&&i.primary.includes("pink")?"#db2777":i!=null&&i.primary.includes("teal")?"#0d9488":"#2563eb",unit:"lbs",description:"Total weight Ã— reps lifted"},fatigue:{label:"Fatigue Index",color:"#dc2626",unit:"",description:"Accumulated fatigue (logarithmic scale)"},stimulus:{label:"Stimulus (sets)",color:"#16a34a",unit:"sets",description:"Effective training volume"},efficiency:{label:"Stimulus:Fatigue Ratio",color:"#9333ea",unit:"",description:"Training efficiency (higher is better)"}})[o],[o,i]);return{historicalData:S,chartData:x,trend:E,metricInfo:b}}function Ls({muscleReadiness:t,systemicReadiness:s,weeklyStimulus:r,localFatigue:a,lastWorkoutDate:n,workouts:l,stimulusHistory:m=[],readinessHistory:o=[],theme:i}){const[S,x]=c.useState(8),[E,b]=c.useState("all"),[p,d]=c.useState("volume"),[g,f]=c.useState("line"),C=ss(l),{chartData:j,trend:h,metricInfo:F}=As({workouts:l,readinessHistory:o,stimulusHistory:m,weeklyStimulus:r,localFatigue:a,timeframe:S,selectedMuscle:E,metricView:p,theme:i});return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Recovery & Training Analytics"}),e.jsx(Cs,{systemicReadiness:s,muscleReadiness:t,weeklyStimulus:r,weeklySummary:C,theme:i}),e.jsx(ks,{chartData:j,chartType:g,metricView:p,metricInfo:F,trend:h,timeframe:S,selectedMuscle:E,theme:i,onMetricChange:d,onTimeframeChange:x,onMuscleChange:b,onChartTypeChange:f}),e.jsx(Fs,{muscleReadiness:t,weeklyStimulus:r,selectedMuscle:E,onMuscleSelect:b,theme:i}),e.jsx(Ts,{muscleReadiness:t,systemicReadiness:s,trend:h,lastWorkoutDate:n,theme:i})]})}function Ps({exercises:t,onAddExercise:s,onUpdateExercise:r,onDeleteExercise:a,onResetToPresets:n,theme:l}){const[m,o]=c.useState(""),[i,S]=c.useState("compound_upper"),[x,E]=c.useState(!1),[b,p]=c.useState([]),[d,g]=c.useState([]),[f,C]=c.useState([]),[j,h]=c.useState(!1),[F,_]=c.useState(null),[O,M]=c.useState(""),U=c.useRef(null),w=(k,I)=>{I==="primary"?(p(G=>G.includes(k)?G.filter(Y=>Y!==k):[...G,k]),g(G=>G.filter(Y=>Y!==k)),C(G=>G.filter(Y=>Y!==k))):I==="secondary"?(g(G=>G.includes(k)?G.filter(Y=>Y!==k):[...G,k]),p(G=>G.filter(Y=>Y!==k)),C(G=>G.filter(Y=>Y!==k))):I==="tertiary"&&(C(G=>G.includes(k)?G.filter(Y=>Y!==k):[...G,k]),p(G=>G.filter(Y=>Y!==k)),g(G=>G.filter(Y=>Y!==k)))},W=async()=>{if(!m||b.length===0){alert("Enter name and select primary muscles");return}await s({name:m,type:i,axial:x,prim:b,sec:d,ter:f}),B()},u=k=>{var I,G;_(k.id),o(k.name),S(k.type),E(k.axial),p(k.prim||[]),g(k.sec||[]),C(k.ter||[]),h(((I=k.sec)==null?void 0:I.length)>0||((G=k.ter)==null?void 0:G.length)>0),setTimeout(()=>{var Y;(Y=U.current)==null||Y.scrollIntoView({behavior:"smooth",block:"start"})},100)},y=async()=>{if(!m||b.length===0){alert("Enter name and select primary muscles");return}await r(F,{name:m,type:i,axial:x,prim:b,sec:d,ter:f}),B()},A=()=>{B()},B=()=>{_(null),o(""),S("compound_upper"),E(!1),p([]),g([]),C([]),h(!1)},z=t.filter(k=>k.name.toLowerCase().includes(O.toLowerCase()));return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Exercise Library"}),e.jsxs("div",{ref:U,className:"space-y-3 mb-6 pb-6 border-b",children:[e.jsx("input",{type:"text",value:m,onChange:k=>o(k.target.value),placeholder:"Exercise name",className:"w-full px-3 py-2 border rounded"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("select",{value:i,onChange:k=>S(k.target.value),className:"px-3 py-2 border rounded",children:Object.entries(xt).map(([k,I])=>e.jsx("option",{value:k,children:I.name},k))}),e.jsxs("label",{className:"flex items-center gap-2 border rounded px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:k=>E(k.target.checked)}),e.jsx("span",{className:"text-sm",children:"Axially Loaded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-2",children:"Primary Muscles *"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ae.map(k=>e.jsx("button",{onClick:()=>w(k,"primary"),className:`px-2 py-1 text-sm rounded border ${b.includes(k)?`${(l==null?void 0:l.primary)||"bg-blue-600 hover:bg-blue-700"} text-white`:"bg-white hover:bg-slate-50"}`,children:k},k))})]}),e.jsxs("button",{onClick:()=>h(!j),className:`text-sm ${(l==null?void 0:l.accent)||"text-blue-600"} hover:opacity-80`,children:[j?"Hide":"+ Add"," Secondary/Tertiary"]}),j&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold block mb-1",children:"Secondary Muscles"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ae.map(k=>e.jsx("button",{onClick:()=>w(k,"secondary"),className:`px-2 py-1 text-xs rounded border ${d.includes(k)?"bg-green-600 text-white":"bg-white hover:bg-slate-50"}`,children:k},k))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold block mb-1",children:"Tertiary Muscles"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ae.map(k=>e.jsx("button",{onClick:()=>w(k,"tertiary"),className:`px-2 py-1 text-xs rounded border ${f.includes(k)?"bg-purple-600 text-white":"bg-white hover:bg-slate-50"}`,children:k},k))})]})]}),F?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:y,className:"flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700",children:"Update Exercise"}),e.jsx("button",{onClick:A,className:"flex-1 bg-gray-400 text-white py-2 rounded hover:bg-gray-500",children:"Cancel"})]}):e.jsx("button",{onClick:W,className:`w-full text-white py-2 rounded ${(l==null?void 0:l.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"Save Exercise"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h2",{className:"font-bold",children:["All Exercises (",z.length,")"]}),e.jsx("button",{onClick:n,className:`underline text-sm ${(l==null?void 0:l.accent)||"text-blue-600"} hover:opacity-80`,children:"Load Presets"})]}),e.jsx("input",{type:"text",value:O,onChange:k=>M(k.target.value),placeholder:"Search exercises...",className:"w-full px-3 py-2 border rounded mb-3"}),z.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-slate-500",children:O?"No exercises match your search":"No exercises yet"})}):e.jsx("div",{className:"space-y-2 stagger-children",children:z.map(k=>{var I;return e.jsxs("div",{className:"border p-3 rounded flex justify-between items-center hover:bg-slate-50 card-hover",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:k.name}),e.jsxs("div",{className:"text-xs text-slate-600",children:[(I=k.prim)==null?void 0:I.join(", "),k.axial&&e.jsx("span",{className:"ml-2 text-orange-600 font-semibold",children:"â€¢ Axial"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u(k),className:`text-lg ${(l==null?void 0:l.accent)||"text-blue-500"} hover:opacity-80`,children:"âœï¸"}),e.jsx("button",{onClick:()=>{confirm(`Delete ${k.name}?`)&&a(k.id)},className:"text-red-500 hover:text-red-700",children:"ðŸ—‘ï¸"})]})]},k.id)})})]})]})}function Ms({programs:t,exercises:s,activeProgram:r,currentDayIndex:a,onAddProgram:n,onUpdateProgram:l,onDeleteProgram:m,onStartProgram:o,onStopProgram:i,theme:S}){var L;const[x,E]=c.useState(""),[b,p]=c.useState([]),[d,g]=c.useState({name:"",exercises:[],isRestDay:!1}),[f,C]=c.useState(null),[j,h]=c.useState(null),[F,_]=c.useState(null),[O,M]=c.useState(null),U=c.useRef(null),w=ht(s),W=v=>{const T=s.find(D=>D.id==v);T&&g({...d,exercises:[...d.exercises,{...T,sets:3,reps:10,rir:2,exId:T.id}]})},u=(v,T,D)=>{const H=[...d.exercises];H[v][T]=parseInt(D),g({...d,exercises:H})},y=v=>{g({...d,exercises:d.exercises.filter((T,D)=>D!==v)})},A=v=>{const T=d.exercises[v];g({...d,exercises:[...d.exercises.slice(0,v+1),{...T},...d.exercises.slice(v+1)]})},B=(v,T)=>{M(T),v.dataTransfer.effectAllowed="move"},z=(v,T)=>{if(v.preventDefault(),O===null||O===T)return;const D=[...d.exercises],H=D[O];D.splice(O,1),D.splice(T,0,H),g({...d,exercises:D}),M(T)},k=()=>{M(null)},I=v=>{h(v),g({...b[v]}),setTimeout(()=>{var T;(T=U.current)==null||T.scrollIntoView({behavior:"smooth",block:"start"})},100)},G=v=>{const T=b[v],D={...T,name:`${T.name} (Copy)`,id:Date.now()},H=[...b.slice(0,v+1),D,...b.slice(v+1)];p(H)},Y=()=>{if(!d.name){alert("Add day name");return}const v=[...b];v[j]={...d},p(v),h(null),g({name:"",exercises:[],isRestDay:!1})},Q=()=>{h(null),g({name:"",exercises:[],isRestDay:!1})},le=()=>{if(!d.name){alert("Add day name");return}j!==null?Y():(p([...b,{...d,id:Date.now()}]),g({name:"",exercises:[],isRestDay:!1}))},se=v=>{p(b.filter((T,D)=>D!==v))},ue=(v,T)=>{_(T),v.dataTransfer.effectAllowed="move"},we=(v,T)=>{if(v.preventDefault(),F===null||F===T)return;const D=[...b],H=D[F];D.splice(F,1),D.splice(T,0,H),p(D),_(T)},Se=()=>{_(null)},Ne=async()=>{if(!x||b.length===0){alert("Add program name and days");return}await n({name:x,days:b}),N(),alert("Program saved!")},be=v=>{C(v.id),E(v.name),p(v.days)},ge=v=>{const T={...v,name:`${v.name} (Copy)`};C(null),E(T.name),p(T.days),window.scrollTo({top:0,behavior:"smooth"})},ye=async()=>{if(!x||b.length===0){alert("Add program name and days");return}await l(f,{name:x,days:b}),N(),alert("Program updated!")},Z=()=>{N()},N=()=>{C(null),E(""),p([]),g({name:"",exercises:[],isRestDay:!1})},$=v=>{const T=v.filter(q=>!q.isRestDay).length,D=v.filter(q=>q.isRestDay).length,H=v.reduce((q,re)=>{var me;return q+(((me=re.exercises)==null?void 0:me.length)||0)},0);return{trainingDays:T,restDays:D,totalExercises:H}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Programs"}),r&&e.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-green-900",children:["Active: ",r.name]}),e.jsxs("div",{className:"text-sm text-green-700",children:["Day ",a+1," of ",r.days.length,((L=r.days[a])==null?void 0:L.isRestDay)&&" (Rest Day)"]})]}),e.jsx("button",{onClick:i,className:"text-sm text-red-600 hover:text-red-700",children:"Stop"})]})}),e.jsxs("div",{className:"space-y-4 mb-6 pb-6 border-b",children:[e.jsx("h3",{className:"font-semibold text-lg sm:text-xl",children:"Create Program"}),e.jsx("input",{type:"text",value:x,onChange:v=>E(v.target.value),placeholder:"Program name (e.g., Push Pull Legs)",className:"w-full px-4 py-3 border-2 rounded-lg text-base"}),e.jsxs("div",{ref:U,className:"border-2 rounded-lg p-4 bg-slate-50",children:[e.jsx("h3",{className:"font-semibold mb-4 text-base sm:text-lg",children:"Build Training Day"}),e.jsx("input",{type:"text",value:d.name,onChange:v=>g({...d,name:v.target.value}),placeholder:"Day name (e.g., Upper A, Push, Legs)",className:"w-full px-4 py-3 border-2 rounded-lg mb-4 text-base"}),!d.isRestDay&&e.jsx(e.Fragment,{children:s.length===0?e.jsxs("div",{className:"text-center py-6 text-slate-500",children:[e.jsx("p",{className:"mb-3",children:"No exercises available"}),e.jsx("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Go to Exercises"})]}):e.jsxs(e.Fragment,{children:[e.jsx(pt,{exercises:s,exercisesByMuscle:w,onSelect:W,placeholder:"2ï¸âƒ£ Choose exercise to add...",className:"mb-4"}),d.exercises.length>0&&e.jsx("div",{className:"space-y-3 mb-4",children:d.exercises.map((v,T)=>e.jsxs("div",{draggable:!0,onDragStart:D=>B(D,T),onDragOver:D=>z(D,T),onDragEnd:k,className:`bg-white p-4 rounded-lg border-2 cursor-move transition-all ${O===T?"opacity-50 scale-95":"hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 cursor-grab",children:"â‹®â‹®"}),e.jsx("span",{className:"font-semibold text-base",children:v.name})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>A(T),className:"text-blue-500 text-lg hover:text-blue-700",title:"Duplicate exercise",children:"ðŸ“‹"}),e.jsx("button",{onClick:()=>y(T),className:"text-red-500 text-xl px-2",children:"Ã—"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-1",children:"Sets"}),e.jsx("input",{type:"number",value:v.sets,onChange:D=>u(T,"sets",D.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-base text-center font-semibold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-1",children:"Reps"}),e.jsx("input",{type:"number",value:v.reps,onChange:D=>u(T,"reps",D.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-base text-center font-semibold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-1",children:"RIR"}),e.jsx("input",{type:"number",value:v.rir,onChange:D=>u(T,"rir",D.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-base text-center font-semibold"})]})]})]},T))})]})}),e.jsx("div",{className:"flex gap-2",children:d.isRestDay?e.jsx("button",{onClick:le,disabled:!d.name,className:"flex-1 bg-blue-500 text-white py-3 rounded-lg font-bold text-base hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"âœ“ Add Rest Day"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:le,disabled:!d.name||d.exercises.length===0,className:"flex-1 bg-green-600 text-white py-3 rounded-lg font-bold text-base hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:j!==null?"âœ“ Update Day":"âœ“ Add Training Day"}),e.jsx("button",{onClick:()=>{const v=d.name||`Rest Day ${b.filter(T=>T.isRestDay).length+1}`;p([...b,{name:v,exercises:[],isRestDay:!0,id:Date.now()}]),g({name:"",exercises:[],isRestDay:!1})},className:"bg-blue-500 text-white px-6 py-3 rounded-lg font-bold text-base hover:bg-blue-600 whitespace-nowrap",title:"Add rest day",children:"ðŸ˜´ Add Rest"})]})}),j!==null&&e.jsx("button",{onClick:Q,className:"w-full bg-gray-400 text-white py-3 rounded-lg font-bold text-base hover:bg-gray-500 mt-2",children:"Cancel Editing Day"})]}),b.length>0&&e.jsxs("div",{className:"border-2 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-semibold text-base sm:text-lg",children:["Program Days (",b.length,")"]}),e.jsx("div",{className:"text-sm text-slate-600",children:(()=>{const v=$(b);return`${v.trainingDays} training, ${v.restDays} rest`})()})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"ðŸ’¡ Drag to reorder days"}),b.map((v,T)=>e.jsxs("div",{draggable:!0,onDragStart:D=>ue(D,T),onDragOver:D=>we(D,T),onDragEnd:Se,className:`mb-4 p-4 rounded-lg border cursor-move transition-all ${F===T?"opacity-50 scale-95":"hover:shadow-md"} ${v.isRestDay?"bg-blue-50 border-blue-200":"bg-slate-50 border-slate-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 cursor-grab",children:"â‹®â‹®"}),v.isRestDay&&e.jsx("span",{className:"text-2xl",children:"ðŸ˜´"}),e.jsxs("div",{children:[e.jsx("div",{className:`font-bold text-base ${v.isRestDay?"text-blue-900":""}`,children:v.name}),v.isRestDay&&e.jsx("div",{className:"text-xs text-blue-600",children:"Scheduled recovery"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>G(T),className:"text-blue-500 text-lg hover:text-blue-700",title:"Duplicate day",children:"ðŸ“‹"}),e.jsx("button",{onClick:()=>I(T),className:`text-lg ${(S==null?void 0:S.accent)||"text-blue-500"} hover:opacity-80`,children:"âœï¸"}),e.jsx("button",{onClick:()=>se(T),className:"text-red-500 text-xl hover:text-red-700",children:"ðŸ—‘ï¸"})]})]}),!v.isRestDay&&v.exercises.map((D,H)=>e.jsxs("div",{className:"text-sm text-slate-600 py-1",children:["â€¢ ",D.name," - ",D.sets,"Ã—",D.reps," @ ",D.rir,"RIR"]},H))]},T))]}),f?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ye,disabled:b.length===0,className:"flex-1 bg-green-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-green-700 disabled:bg-slate-300",children:"Update Program"}),e.jsx("button",{onClick:Z,className:"flex-1 bg-gray-400 text-white py-4 rounded-lg font-bold text-lg hover:bg-gray-500",children:"Cancel"})]}):e.jsx("button",{onClick:Ne,disabled:b.length===0,className:`w-full text-white py-4 rounded-lg font-bold text-lg disabled:bg-slate-300 ${(S==null?void 0:S.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"Save Program"})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold mb-4",children:["Saved Programs (",t.length,")"]}),t.length===0?e.jsx("p",{className:"text-slate-500 text-center py-8",children:"No programs yet"}):e.jsx("div",{className:"space-y-4 stagger-children",children:t.map(v=>{const T=$(v.days);return e.jsxs("div",{className:"border-2 p-5 rounded-lg hover:shadow-md transition-shadow card-hover",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-xl",children:v.name}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:[T.trainingDays," training days Â· ",T.restDays," rest days Â· ",T.totalExercises," exercises"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ge(v),className:"text-blue-500 text-xl hover:text-blue-700",title:"Duplicate program",children:"ðŸ“‹"}),e.jsx("button",{onClick:()=>be(v),className:`text-xl ${(S==null?void 0:S.accent)||"text-blue-500"} hover:opacity-80`,children:"âœï¸"}),e.jsx("button",{onClick:()=>{confirm(`Delete ${v.name}?`)&&m(v.id)},className:"text-red-500 text-xl hover:text-red-700",children:"ðŸ—‘ï¸"}),e.jsx("button",{onClick:()=>o(v.id),disabled:r&&r.id===v.id,className:"bg-green-600 text-white px-5 py-2 rounded-lg text-base font-semibold hover:bg-green-700 disabled:bg-green-300",children:r&&r.id===v.id?"âœ“ Active":"Start"})]})]}),e.jsx("div",{className:"space-y-3",children:v.days.map((D,H)=>e.jsxs("div",{className:`pl-4 border-l-4 ${D.isRestDay?"border-blue-400 bg-blue-50 p-2 rounded":(S==null?void 0:S.primary.split(" ")[0].replace("bg-","border-"))||"border-blue-500"}`,children:[e.jsxs("div",{className:"font-semibold text-base mb-1 flex items-center gap-2",children:[D.isRestDay&&e.jsx("span",{className:"text-xl",children:"ðŸ˜´"}),"Day ",H+1,": ",D.name,D.isRestDay&&e.jsx("span",{className:"text-xs text-blue-600",children:"(Rest)"})]}),!D.isRestDay&&D.exercises.map((q,re)=>e.jsxs("div",{className:"text-sm text-slate-600",children:["â€¢ ",q.name," - ",q.sets,"Ã—",q.reps," @ ",q.rir,"RIR"]},re))]},H))})]},v.id)})})]})]})}function _s({settings:t,onUpdateSetting:s,onResetSettings:r,themeColors:a}){const{changePassword:n}=ut(),[l,m]=c.useState(""),[o,i]=c.useState(""),[S,x]=c.useState(""),[E,b]=c.useState(""),[p,d]=c.useState(""),g=h=>{s("themeColor",h)},f=h=>{s("restTimerEnabled",h)},C=h=>{s("defaultRestTime",parseInt(h))},j=async h=>{if(h.preventDefault(),b(""),o!==S){b("New passwords do not match"),d("error");return}const F=await n(l,o);F.success?(b("Password changed successfully!"),d("success"),m(""),i(""),x("")):(b(F.error),d("error"))};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 max-w-3xl mx-auto animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Settings"}),e.jsxs("div",{className:"mb-8 pb-8 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Theme Color"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choose your preferred accent color for buttons and highlights"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:Object.entries(a).map(([h,F])=>e.jsx("button",{onClick:()=>g(h),className:`
                relative p-4 rounded-lg border-2 transition-all card-hover
                ${t.themeColor===h?"border-gray-900 shadow-md scale-105":"border-gray-200 hover:border-gray-400"}
              `,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`w-12 h-12 rounded-full ${F.primary.split(" ")[0]}`}),e.jsx("span",{className:"text-sm font-medium",children:F.name}),t.themeColor===h&&e.jsx("span",{className:"text-xs text-green-600 font-semibold",children:"âœ“ Active"})]})},h))})]}),e.jsxs("div",{className:"mb-8 pb-8 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Rest Timer"}),e.jsx("div",{className:"mb-6",children:e.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Enable Rest Timer"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Automatically start a countdown timer after each set"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:t.restTimerEnabled,onChange:h=>f(h.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-14 h-8 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-blue-600"})]})]})}),e.jsxs("div",{className:`transition-opacity ${t.restTimerEnabled?"opacity-100":"opacity-50"}`,children:[e.jsxs("label",{className:"block mb-3",children:[e.jsx("span",{className:"font-semibold block mb-2",children:"Default Rest Time"}),e.jsx("span",{className:"text-sm text-gray-600 block mb-3",children:"How long should the rest timer count down by default?"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4",children:[60,90,120,150,180,240,300].map(h=>e.jsx("button",{onClick:()=>C(h),disabled:!t.restTimerEnabled,className:`
                  px-4 py-3 rounded-lg border-2 font-semibold transition-all btn-press
                  ${t.defaultRestTime===h?"border-blue-600 bg-blue-50 text-blue-900":"border-gray-200 bg-white hover:border-gray-400"}
                  ${!t.restTimerEnabled&&"cursor-not-allowed"}
                `,children:h<60?`${h}s`:`${Math.floor(h/60)}:${(h%60).toString().padStart(2,"0")}`},h))}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Or enter custom time (seconds):"}),e.jsx("input",{type:"number",value:t.defaultRestTime,onChange:h=>C(h.target.value),disabled:!t.restTimerEnabled,min:"10",max:"600",className:"w-full sm:w-48 px-4 py-2 border-2 rounded-lg text-lg font-semibold text-center disabled:bg-gray-100 disabled:cursor-not-allowed"})]})]})]}),e.jsxs("div",{className:"mb-8 pb-8 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Change Password"}),e.jsxs("form",{onSubmit:j,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Current Password"}),e.jsx("input",{type:"password",value:l,onChange:h=>m(h.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none",placeholder:"Enter current password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:o,onChange:h=>i(h.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none",placeholder:"Enter new password (min 6 chars)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:S,onChange:h=>x(h.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none",placeholder:"Confirm new password"})]}),E&&e.jsx("div",{className:`p-3 rounded-lg ${p==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:E}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 font-semibold transition-colors",children:"Change Password"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Reset"}),e.jsx("button",{onClick:()=>{confirm("Reset all settings to default values?")&&r()},className:"px-6 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors",children:"Reset to Defaults"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"This will restore all settings to their original values"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Current Settings"}),e.jsxs("div",{className:"text-sm space-y-1 text-gray-700",children:[e.jsxs("div",{children:["Theme: ",e.jsx("span",{className:"font-medium",children:a[t.themeColor].name})]}),e.jsxs("div",{children:["Rest Timer: ",e.jsx("span",{className:"font-medium",children:t.restTimerEnabled?"Enabled":"Disabled"})]}),e.jsxs("div",{children:["Default Rest Time: ",e.jsxs("span",{className:"font-medium",children:[t.defaultRestTime,"s (",Math.floor(t.defaultRestTime/60),":",(t.defaultRestTime%60).toString().padStart(2,"0"),")"]})]})]})]})]})}function Is(){const[t,s]=c.useState("session"),[r,a]=c.useState(!1),{userId:n,username:l,isAuthenticated:m,isLoading:o,login:i,logout:S}=ut(),{settings:x,updateSetting:E,resetSettings:b,themeColors:p,currentTheme:d}=ys(n),{workouts:g,updateSession:f,deleteWorkout:C}=rs(n),{exercises:j,addExercise:h,updateExercise:F,deleteExercise:_,resetToPresets:O}=ns(),{programs:M,activeProgram:U,currentDayIndex:w,addProgram:W,updateProgram:u,deleteProgram:y,startProgram:A,stopProgram:B,advanceToNextDay:z,getCurrentDay:k}=ls(n),{localFatigue:I,weeklyStimulus:G,muscleReadiness:Y,systemicReadiness:Q,lastWorkoutDate:le,readinessHistory:se,processWorkoutSession:ue}=bs(n,g),we=fs(),Se=N=>{const $=g.map(L=>L.timestamp===N.timestamp?N:L);X.saveUserData("workouts",$,n)},Ne=async N=>{await C(N)},be=async(N,$)=>{if(console.log("ðŸŸ¡ APP handleAutoSave CALLED"),console.log("  Session:",N),console.log("  Session length:",N.length),console.log("  Date:",$),N.length===0){console.log("  âš ï¸ Empty session - skipping");return}try{console.log("  â³ Calling updateSession..."),await f(N,$),console.log("  âœ… handleAutoSave COMPLETE")}catch(L){console.error("  âŒ Auto-save failed:",L)}},ge=async(N,$,L,v)=>{const T=k(),D=(T==null?void 0:T.isRestDay)||!1,H=U?{activeProgram:U,currentDayIndex:w,lastDayIndex:w>0?w-1:U.days.length-1,isRestDay:D}:null;D?await ue([],$,{perceivedFatigue:L,muscleSoreness:v},H):await ue(N,$,{perceivedFatigue:L,muscleSoreness:v},H),U&&z()},ye=async(N,$,L)=>{console.log("ðŸ’¾ handleSaveRecoveryOnly called:"),console.log("  date:",N),console.log("  perceivedFatigue:",$),console.log("  muscleSoreness:",L);try{await ue([],N,{perceivedFatigue:$,muscleSoreness:L},null)}catch(v){console.error("Failed to save recovery data:",v)}},Z=()=>{const N=k();return N||(alert("No program day to load"),null)};return o?e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:e.jsx("div",{className:"text-white text-2xl",children:"Loading..."})}):m?e.jsx("div",{className:`min-h-screen p-4 transition-colors duration-300 ${x.themeColor==="blue"?"bg-gradient-to-br from-slate-900 to-blue-900":x.themeColor==="green"?"bg-gradient-to-br from-slate-900 to-green-900":x.themeColor==="purple"?"bg-gradient-to-br from-slate-900 to-purple-900":x.themeColor==="orange"?"bg-gradient-to-br from-slate-900 to-orange-900":x.themeColor==="red"?"bg-gradient-to-br from-slate-900 to-red-900":x.themeColor==="indigo"?"bg-gradient-to-br from-slate-900 to-indigo-900":x.themeColor==="pink"?"bg-gradient-to-br from-slate-900 to-pink-900":x.themeColor==="teal"?"bg-gradient-to-br from-slate-900 to-teal-900":"bg-gradient-to-br from-slate-900 to-slate-800"}`,children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:()=>a(!r),className:"text-white p-2 hover:bg-slate-700 rounded-lg transition-colors","aria-label":"Menu",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"text-white",children:[e.jsx("span",{className:"text-sm opacity-75",children:"Logged in as:"}),e.jsx("span",{className:"ml-2 font-semibold",children:l})]}),e.jsx("button",{onClick:S,className:"text-white text-sm opacity-75 hover:opacity-100 underline transition-opacity",children:"Logout"})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 animate-fadeIn",onClick:()=>a(!1)}),e.jsxs("div",{className:"fixed top-0 left-0 h-full w-64 bg-white shadow-2xl z-50 flex flex-col animate-slideInLeft",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"font-bold text-xl",children:"Menu"}),e.jsx("button",{onClick:()=>a(!1),className:"text-gray-500 hover:text-gray-700 text-2xl transition-transform hover:rotate-90",children:"Ã—"})]}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 stagger-children",children:[e.jsxs("button",{onClick:()=>{s("session"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="session"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ’ª"}),e.jsx("span",{children:"Session"})]}),e.jsxs("button",{onClick:()=>{s("history"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="history"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ“Š"}),e.jsx("span",{children:"History"})]}),e.jsxs("button",{onClick:()=>{s("recovery"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="recovery"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"â¤ï¸"}),e.jsx("span",{children:"Recovery"})]}),e.jsxs("button",{onClick:()=>{s("exercises"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="exercises"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ‹ï¸"}),e.jsx("span",{children:"Exercises"})]}),e.jsxs("button",{onClick:()=>{s("programs"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="programs"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ“…"}),e.jsx("span",{children:"Programs"})]}),e.jsx("div",{className:"my-2 border-t"}),e.jsxs("button",{onClick:()=>{s("settings"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="settings"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"âš™ï¸"}),e.jsx("span",{children:"Settings"})]})]}),e.jsx("div",{className:"p-4 border-t bg-slate-50",children:e.jsx("div",{className:"text-xs text-slate-600 text-center",children:"Workout Tracker v1.0"})})]})]}),t==="session"&&e.jsx(Rs,{exercises:j,workouts:g,muscleReadiness:Y,systemicReadiness:Q,weeklyStimulus:G,activeProgram:U,currentDayIndex:w,getCurrentDay:k,onSessionComplete:ge,onAutoSave:be,onSaveRecoveryOnly:ye,onLoadProgramDay:Z,useRestTimer:()=>we,settings:x,theme:d}),t==="history"&&e.jsx(Ds,{workouts:g,readinessHistory:se,onUpdateWorkout:Se,onDeleteWorkout:Ne,theme:d}),t==="recovery"&&e.jsx(Ls,{muscleReadiness:Y,systemicReadiness:Q,weeklyStimulus:G,localFatigue:I,lastWorkoutDate:le,workouts:g,theme:d}),t==="exercises"&&e.jsx(Ps,{exercises:j,onAddExercise:h,onUpdateExercise:F,onDeleteExercise:_,onResetToPresets:O,theme:d}),t==="programs"&&e.jsx(Ms,{programs:M,exercises:j,activeProgram:U,currentDayIndex:w,onAddProgram:W,onUpdateProgram:u,onDeleteProgram:y,onStartProgram:A,onStopProgram:B,theme:d}),t==="settings"&&e.jsx(_s,{settings:x,onUpdateSetting:E,onResetSettings:b,themeColors:p})]})}):e.jsx(vs,{onLogin:i})}ze.createRoot(document.getElementById("root")).render(e.jsx(ft.StrictMode,{children:e.jsx(Is,{})}));
