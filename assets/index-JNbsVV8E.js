import{r as c,a as pt,R as ht}from"./react-vendor-wGySg1uH.js";import{i as bt,g as ft,d as pe,a as rt,s as Pe,b as Me,c as yt,e as vt}from"./firebase-vendor-DArFBOnq.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var at={exports:{}},Ue={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jt=c,wt=Symbol.for("react.element"),Nt=Symbol.for("react.fragment"),St=Object.prototype.hasOwnProperty,Et=jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Rt={key:!0,ref:!0,__self:!0,__source:!0};function nt(t,s,r){var a,n={},l=null,m=null;r!==void 0&&(l=""+r),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(m=s.ref);for(a in s)St.call(s,a)&&!Rt.hasOwnProperty(a)&&(n[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:wt,type:t,key:l,ref:m,props:n,_owner:Et.current}}Ue.Fragment=Nt;Ue.jsx=nt;Ue.jsxs=nt;at.exports=Ue;var e=at.exports,ze={},Qe=pt;ze.createRoot=Qe.createRoot,ze.hydrateRoot=Qe.hydrateRoot;const Le="workout_tracker_";class ke extends Error{constructor(s,r,a){super(s),this.name="StorageError",this.operation=r,this.key=a}}function Dt(){try{const t="__storage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch{return!1}}function We(t){return`${Le}${t}`}function lt(t,s=null){try{const r=We(t),a=localStorage.getItem(r);if(a===null)return s;try{return JSON.parse(a)}catch{return a}}catch(r){throw console.error(`Storage get error for key "${t}":`,r),new ke(`Failed to get item: ${r.message}`,"get",t)}}function ot(t,s){try{const r=We(t),a=JSON.stringify(s);return localStorage.setItem(r,a),!0}catch(r){throw console.error(`Storage set error for key "${t}":`,r),r.name==="QuotaExceededError"?new ke("Storage quota exceeded. Please clear some data.","set",t):new ke(`Failed to set item: ${r.message}`,"set",t)}}function Ct(t){try{const s=We(t);return localStorage.removeItem(s),!0}catch(s){throw console.error(`Storage remove error for key "${t}":`,s),new ke(`Failed to remove item: ${s.message}`,"remove",t)}}function kt(){try{return Object.keys(localStorage).forEach(s=>{s.startsWith(Le)&&localStorage.removeItem(s)}),!0}catch(t){throw console.error("Storage clear error:",t),new ke(`Failed to clear storage: ${t.message}`,"clear",null)}}function Ft(){try{return Object.keys(localStorage).filter(s=>s.startsWith(Le)).map(s=>s.replace(Le,""))}catch(t){throw console.error("Storage getAllKeys error:",t),new ke(`Failed to get keys: ${t.message}`,"getAllKeys",null)}}function it(){try{let t=0;return Object.keys(localStorage).forEach(r=>{if(r.startsWith(Le)){const a=localStorage.getItem(r);a&&(t+=r.length+a.length)}}),t*2}catch(t){return console.error("Storage size calculation error:",t),0}}function Tt(){const t=it();return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(2)} KB`:`${(t/(1024*1024)).toFixed(2)} MB`}function At(t){try{const s=We(t);return localStorage.getItem(s)!==null}catch(s){return console.error(`Storage hasKey error for "${t}":`,s),!1}}function Lt(t){const s={};return t.forEach(r=>{try{s[r]=lt(r)}catch(a){console.error(`Error getting key "${r}":`,a),s[r]=null}}),s}function Pt(t){try{return Object.entries(t).forEach(([s,r])=>{ot(s,r)}),!0}catch(s){return console.error("Error setting multiple items:",s),!1}}function Mt(t,s=null){try{return t()}catch(r){return console.error("Storage operation failed:",r),s}}const ie={isAvailable:Dt,get:lt,set:ot,remove:Ct,clear:kt,getAllKeys:Ft,getSize:it,getSizeFormatted:Tt,hasKey:At,getMultiple:Lt,setMultiple:Pt,safe:Mt},J={LOCAL_RECOVERY_RATE:.2,SYSTEMIC_RECOVERY_RATE:.15,RIR_DECAY_CONSTANT:.3,PRIMARY_MUSCLE_MULTIPLIER:1,SECONDARY_MUSCLE_MULTIPLIER:.5,TERTIARY_MUSCLE_MULTIPLIER:.25,AXIAL_LOAD_MULTIPLIER:1.3,COMPOUND_SYSTEMIC_MULTIPLIER:1.5,RIR_MISS_FATIGUE_PENALTY:.15,SORENESS_FATIGUE_WEIGHT:.1,PERCEIVED_FATIGUE_WEIGHT:.08,STIMULUS_DECAY_RATE:.14,PROGRESSION_THRESHOLD:.85,DELOAD_THRESHOLD:.6,DELOAD_TRACKING_DAYS:7,DELOAD_MIN_CONDITIONS:2,PERFORMANCE_ERROR_THRESHOLD:-1,PERFORMANCE_ERROR_SESSIONS:2,USE_EPLEY_FORMULA:!0,BASE_FATIGUE_PER_SET:.033,MAX_FATIGUE_THRESHOLD:.6},Ke={RIR_PROGRESSION_THRESHOLD:1,OPTIMAL_SETS_PER_WEEK:15,MAX_WEEKLY_STIMULUS:25},ce={USER_ID:"userId",USERNAME:"username",ACTIVE_PROGRAM:t=>`ap_${t}`,CURRENT_DAY_INDEX:t=>`cdi_${t}`,THEME_PREFERENCE:"theme",LAST_SYNC:"lastSync"},ee={EXERCISES:"exercises",WORKOUTS:"workouts",PROGRAMS:"programs",FATIGUE:"fatigue",USER_PREFERENCES:"preferences"},_t={apiKey:"AIzaSyC_nkyWikwTCHDIBOvpXkEvk7Cfl8w5GLE",authDomain:"workout-tracker-e57d4.firebaseapp.com",projectId:"workout-tracker-e57d4",storageBucket:"workout-tracker-e57d4.firebasestorage.app",messagingSenderId:"20708564104",appId:"1:20708564104:web:e7457b6f3fc63cd271933d"},It=bt(_t),de=ft(It);class te extends Error{constructor(s,r,a){super(s),this.name="DatabaseError",this.operation=r,this.collection=a}}async function $t(t,s){try{const r=pe(de,t,"data");return await Pe(r,{items:s,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved to ${t}:`,s.length,"items"),!0}catch(r){throw console.error(`âŒ Save error for ${t}:`,r),new te(`Failed to save collection: ${r.message}`,"save",t)}}async function Ot(t){try{const s=await yt(vt(de,t));let r=[];return s.forEach(a=>{a.id==="data"&&a.data().items&&(r=a.data().items)}),console.log(`âœ… Loaded from ${t}:`,r.length,"items"),r}catch(s){throw console.error(`âŒ Load error for ${t}:`,s),new te(`Failed to load collection: ${s.message}`,"load",t)}}async function Ut(t,s,r){if(!r)throw new te("User ID is required","saveUserData",t);try{const a=pe(de,t,r);if(s===null)return await rt(a),console.log(`âœ… Deleted user data from ${t} for user ${r}`),!0;const n=Array.isArray(s)?{items:s,userId:r,updatedAt:new Date().toISOString()}:{...s,userId:r,updatedAt:new Date().toISOString()};await Pe(a,n);const l=Array.isArray(s)?s.length:"object";return console.log(`âœ… Saved user data to ${t} for user ${r}:`,l,Array.isArray(s)?"items":""),!0}catch(a){throw console.error(`âŒ Save user data error for ${t}:`,a),new te(`Failed to save user data: ${a.message}`,"saveUserData",t)}}async function Wt(t,s){if(!s)throw new te("User ID is required","loadUserData",t);try{const r=pe(de,t,s),a=await Me(r);if(a.exists()){const n=a.data();if(n.items&&Array.isArray(n.items))return console.log(`âœ… Loaded user data from ${t} for user ${s}:`,n.items.length,"items"),n.items;const{userId:l,updatedAt:m,...o}=n;return console.log(`âœ… Loaded user data from ${t} for user ${s}:`,"object"),o}else return console.log(`â„¹ï¸ No data found in ${t} for user ${s}`),null}catch(r){throw console.error(`âŒ Load user data error for ${t}:`,r),new te(`Failed to load user data: ${r.message}`,"loadUserData",t)}}async function Ht(t,s){if(!s)throw new te("User ID is required","getUserData",t);try{const r=pe(de,t,s),a=await Me(r);if(a.exists()){const n=a.data(),{userId:l,updatedAt:m,...o}=n;return console.log(`âœ… Loaded user data from ${t} for user ${s}`),o}else return console.log(`â„¹ï¸ No data found in ${t} for user ${s}`),null}catch(r){throw console.error(`âŒ Get user data error for ${t}:`,r),new te(`Failed to get user data: ${r.message}`,"getUserData",t)}}async function Bt(t,s){if(!t)throw new te("User ID is required","saveFatigueState",ee.FATIGUE);try{const r=pe(de,ee.FATIGUE,t);return await Pe(r,{...s,userId:t,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved fatigue state for user ${t}`),!0}catch(r){throw console.error("âŒ Save fatigue state error:",r),new te(`Failed to save fatigue state: ${r.message}`,"saveFatigueState",ee.FATIGUE)}}async function Gt(t){if(!t)throw new te("User ID is required","loadFatigueState",ee.FATIGUE);try{const s=pe(de,ee.FATIGUE,t),r=await Me(s);if(r.exists()){const a=r.data();return console.log(`âœ… Loaded fatigue state for user ${t}`),a}else return console.log(`â„¹ï¸ No fatigue state found for user ${t}`),{}}catch(s){throw console.error("âŒ Load fatigue state error:",s),new te(`Failed to load fatigue state: ${s.message}`,"loadFatigueState",ee.FATIGUE)}}async function Vt(t,s){if(!t)throw new te("User ID is required","saveActiveProgram","activeProgram");try{const r=pe(de,"activeProgram",t);return s===null?(await rt(r),console.log(`âœ… Cleared active program for user ${t}`),!0):(await Pe(r,{...s,userId:t,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved active program for user ${t}:`,s.programId),!0)}catch(r){throw console.error("âŒ Save active program error:",r),new te(`Failed to save active program: ${r.message}`,"saveActiveProgram","activeProgram")}}async function zt(t){if(!t)throw new te("User ID is required","loadActiveProgram","activeProgram");try{const s=pe(de,"activeProgram",t),r=await Me(s);if(r.exists()){const a=r.data();return console.log(`âœ… Loaded active program for user ${t}`),a}else return console.log(`â„¹ï¸ No active program found for user ${t}`),null}catch(s){throw console.error("âŒ Load active program error:",s),new te(`Failed to load active program: ${s.message}`,"loadActiveProgram","activeProgram")}}async function Yt(t,s){if(!t)throw new te("User ID is required","saveSettings",ee.USER_PREFERENCES);try{const r=pe(de,ee.USER_PREFERENCES,t);return await Pe(r,{...s,userId:t,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved settings for user ${t}`),!0}catch(r){throw console.error("âŒ Save settings error:",r),new te(`Failed to save settings: ${r.message}`,"saveSettings",ee.USER_PREFERENCES)}}async function qt(t){if(!t)throw new te("User ID is required","loadSettings",ee.USER_PREFERENCES);try{const s=pe(de,ee.USER_PREFERENCES,t),r=await Me(s);if(r.exists()){const a=r.data();return console.log(`âœ… Loaded settings for user ${t}`),a}else return console.log(`â„¹ï¸ No settings found for user ${t}`),null}catch(s){throw console.error("âŒ Load settings error:",s),new te(`Failed to load settings: ${s.message}`,"loadSettings",ee.USER_PREFERENCES)}}const X={saveCollection:$t,loadCollection:Ot,saveUserData:Ut,loadUserData:Wt,getUserData:Ht,saveFatigueState:Bt,loadFatigueState:Gt,saveActiveProgram:Vt,loadActiveProgram:zt,saveSettings:Yt,loadSettings:qt};async function $e(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(a)).map(m=>m.toString(16).padStart(2,"0")).join("")}function ct(){const[t,s]=c.useState(null),[r,a]=c.useState(""),[n,l]=c.useState(!1),[m,o]=c.useState(!0);c.useEffect(()=>{(()=>{try{const g=ie.get(ce.USER_ID),f=ie.get(ce.USERNAME);g&&f&&(s(g),a(f),l(!0))}catch(g){console.error("Auth initialization error:",g)}finally{o(!1)}})()},[]);const i=async(d,g,f=!1)=>{if(!d||!d.trim())return{success:!1,error:"Username is required"};if(!g)return{success:!1,error:"Password is required"};const D=d.trim();try{if(f)return await N(D,g);{const w=D.toLowerCase().replace(/[^a-z0-9]/g,"_"),p=await X.getUserData("users",w);if(!p)return{success:!1,error:"Username not found. Please register first."};const C=await $e(g);return p.passwordHash!==C?{success:!1,error:"Incorrect password"}:(ie.set(ce.USER_ID,w),ie.set(ce.USERNAME,D),s(w),a(D),l(!0),{success:!0})}}catch(w){return console.error("Login error:",w),{success:!1,error:"Failed to login. Please try again."}}},N=async(d,g)=>{if(!d||d.trim().length<3)return{success:!1,error:"Username must be at least 3 characters"};if(!g||g.length<6)return{success:!1,error:"Password must be at least 6 characters"};const f=d.trim(),D=f.toLowerCase().replace(/[^a-z0-9]/g,"_");try{if(await X.getUserData("users",D))return{success:!1,error:"Username already exists"};const p=await $e(g),C={username:f,passwordHash:p,createdAt:new Date().toISOString()};return await X.saveUserData("users",C,D),ie.set(ce.USER_ID,D),ie.set(ce.USERNAME,f),s(D),a(f),l(!0),{success:!0}}catch(w){return console.error("Registration error:",w),{success:!1,error:"Failed to register. Please try again."}}};return{userId:t,username:r,isAuthenticated:n,isLoading:m,login:i,register:N,logout:()=>{try{return ie.remove(ce.USER_ID),ie.remove(ce.USERNAME),t&&(ie.remove(ce.ACTIVE_PROGRAM(t)),ie.remove(ce.CURRENT_DAY_INDEX(t))),s(null),a(""),l(!1),!0}catch(d){throw console.error("Logout error:",d),new Error("Failed to logout. Please try again.")}},changePassword:async(d,g)=>{if(!t)return{success:!1,error:"Not authenticated"};if(!d)return{success:!1,error:"Current password is required"};if(!g||g.length<6)return{success:!1,error:"New password must be at least 6 characters"};try{const f=await X.getUserData("users",t);if(!f)return{success:!1,error:"User not found"};const D=await $e(d);if(f.passwordHash!==D)return{success:!1,error:"Current password is incorrect"};const w=await $e(g),p={...f,passwordHash:w,passwordUpdatedAt:new Date().toISOString()};return await X.saveUserData("users",p,t),{success:!0}}catch(f){return console.error("Change password error:",f),{success:!1,error:"Failed to change password"}}},updateUsername:d=>{if(!d||!d.trim())throw new Error("Username is required");try{const g=d.trim();return ie.set(ce.USERNAME,g),a(g),!0}catch(g){throw console.error("Update username error:",g),new Error("Failed to update username.")}},checkAuth:()=>n&&t!==null}}function Ye(t){const s=typeof t=="string"?new Date(t):t,r=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0");return`${r}-${a}-${n}`}function Kt(t,s={}){const r=typeof t=="string"?new Date(t+"T12:00:00"):t,a={year:"numeric",month:"long",day:"numeric"};return r.toLocaleDateString("en-US",{...a,...s})}function Xt(t=new Date){const s=t.getFullYear(),r=t.getMonth(),a=new Date(s,r,1),n=new Date(s,r+1,0),l=[],m=a.getDay();for(let o=0;o<m;o++)l.push(null);for(let o=1;o<=n.getDate();o++)l.push(new Date(s,r,o));return l}function Jt(t=new Date){const s=new Date(t);s.setDate(t.getDate()-t.getDay()),s.setHours(0,0,0,0);const r=new Date(s);return r.setDate(s.getDate()+7),{start:s,end:r}}function Qt(t){const s={};return t.forEach(r=>{const a=r.date;s[a]||(s[a]=[]),s[a].push(r)}),s}function dt(t,s,r){const a=typeof s=="string"?new Date(s):s,n=typeof r=="string"?new Date(r):r;return t.filter(l=>{const m=new Date(l.date);return m>=a&&m<=n})}function He(){return Ye(new Date)}const re=["Chest","Back","Shoulders","Biceps","Triceps","Quads","Hamstrings","Glutes","Calves","Abs","Forearms","Traps"];function Zt(t){return(t.w||0)*(t.r||0)}function ut(t){return!t.sets||!Array.isArray(t.sets)?0:t.sets.reduce((s,r)=>s+Zt(r),0)}function es(t,s=new Date){const{start:r,end:a}=Jt(s),n=dt(t,r,a);let l=0,m=0;const o=new Set,i={},N={};return n.forEach(x=>{if(x.sets&&Array.isArray(x.sets)){const S=ut(x);l+=S,m+=x.sets.length,x.prim&&x.prim.forEach(h=>{o.add(h),i[h]=(i[h]||0)+S});const b=x.name||"Unknown";N[b]=(N[b]||0)+1}}),{workouts:n.length,totalVolume:l,totalSets:m,musclesWorked:Array.from(o),volumePerMuscle:i,exerciseCount:N,avgVolumePerWorkout:n.length>0?l/n.length:0}}function ts(t){const[s,r]=c.useState([]),[a,n]=c.useState(!1),[l,m]=c.useState(null),o=c.useCallback(async()=>{if(!t){r([]);return}n(!0),m(null);try{const u=await X.loadUserData(ee.WORKOUTS,t);r(u||[])}catch(u){console.error("Failed to load workouts:",u),m(u.message),r([])}finally{n(!1)}},[t]),i=c.useCallback(async u=>{if(!t)throw new Error("User ID required to save workouts");try{return await X.saveUserData(ee.WORKOUTS,u,t),r(u),!0}catch(y){return console.error("Failed to save workouts:",y),m(y.message),!1}},[t]),N=c.useCallback(async u=>{try{const A=[{...u,timestamp:Date.now(),createdAt:new Date().toISOString()},...s];return await i(A)}catch(y){return console.error("Failed to add workout:",y),m(y.message),!1}},[s,i]),x=c.useCallback(async(u,y)=>{try{const B=[...u.map(Y=>({...Y,date:y,timestamp:Date.now(),createdAt:new Date().toISOString()})),...s];return await i(B)}catch(A){return console.error("Failed to add session:",A),m(A.message),!1}},[s,i]),S=c.useCallback(async(u,y)=>{console.log("ðŸ”µ UPDATE SESSION CALLED"),console.log("  Input session:",u),console.log("  Input date:",y),console.log("  Session length:",u.length),console.log("  Current workouts in state:",s.length);try{const A=s.filter(I=>I.date!==y);console.log("  Other workouts (different dates):",A.length);const B=u.map(I=>{var ne;console.log("  Processing exercise:",I);const G=`${I.id}_${y}`,z=(ne=s.find(se=>se.date===y&&se.id===I.id))==null?void 0:ne.timestamp,Q={id:I.id,name:I.name,sets:I.sets||[],date:y,timestamp:z||I.timestamp||Date.now(),createdAt:I.createdAt||new Date().toISOString()};return I.muscles&&(Q.muscles=I.muscles),I.type&&(Q.type=I.type),I.prim&&(Q.prim=I.prim),I.sec&&(Q.sec=I.sec),I.ter&&(Q.ter=I.ter),I.axial!==void 0&&(Q.axial=I.axial),I.prescribedSets!==void 0&&(Q.prescribedSets=I.prescribedSets),I.prescribedReps!==void 0&&(Q.prescribedReps=I.prescribedReps),I.prescribedRir!==void 0&&(Q.prescribedRir=I.prescribedRir),I.prescribedWeight!==void 0&&(Q.prescribedWeight=I.prescribedWeight),console.log("  Cleaned exercise:",Q),Q});console.log("  Session workouts prepared:",B),console.log("  Session workouts count:",B.length);const Y=[...B,...A];console.log("  Total workouts to save:",Y.length);const k=await i(Y);return console.log("  âœ… SAVE RESULT:",k),k}catch(A){return console.error("  âŒ Failed to update session:",A),m(A.message),!1}},[s,i]),b=c.useCallback(async u=>{try{const y=s.filter(A=>A.timestamp!==u);return await i(y)}catch(y){return console.error("Failed to delete workout:",y),m(y.message),!1}},[s,i]),h=c.useCallback(async u=>{try{const y=s.filter(k=>k.date===u),A=s.filter(k=>k.date!==u),B={};y.forEach(k=>{const I=B[k.id];(!I||k.timestamp>I.timestamp)&&(B[k.id]=k)});const Y=[...Object.values(B),...A];return console.log(`Removed ${y.length-Object.keys(B).length} duplicates from ${u}`),await i(Y)}catch(y){return console.error("Failed to remove duplicates:",y),m(y.message),!1}},[s,i]),d=c.useCallback(async u=>{try{const y=s.filter(A=>A.date!==u);return await i(y)}catch(y){return console.error("Failed to delete workouts for date:",y),m(y.message),!1}},[s,i]),g=c.useCallback(u=>s.filter(y=>y.id===u).sort((y,A)=>new Date(A.date)-new Date(y.date)),[s]),f=c.useCallback(u=>s.filter(y=>y.date===u),[s]),D=c.useCallback(()=>Qt(s),[s]),w=c.useCallback((u,y)=>dt(s,u,y),[s]),p=c.useCallback(u=>{const y=g(u);return y.length>0?y[0]:null},[g]),C=c.useCallback(()=>s.length,[s]),$=c.useCallback(()=>[...new Set(s.map(u=>u.date))].sort().reverse(),[s]),U=c.useCallback(()=>s.reduce((u,y)=>u+ut(y),0),[s]),_=c.useCallback(()=>{const u=$(),y=U();return{totalWorkouts:s.length,totalSessions:u.length,totalVolume:y,avgVolumePerWorkout:s.length>0?y/s.length:0,avgExercisesPerSession:u.length>0?s.length/u.length:0}},[s,$,U]),W=c.useCallback(async()=>{try{return await i([])}catch(u){return console.error("Failed to clear workouts:",u),m(u.message),!1}},[i]),j=c.useCallback(()=>JSON.stringify(s,null,2),[s]),O=c.useCallback(async(u,y=!1)=>{try{const A=JSON.parse(u);if(!Array.isArray(A))throw new Error("Invalid workout data format");const B=y?[...s,...A]:A;return await i(B)}catch(A){return console.error("Failed to import workouts:",A),m(A.message),!1}},[s,i]);return c.useEffect(()=>{o()},[o]),{workouts:s,isLoading:a,error:l,addWorkout:N,addSession:x,updateSession:S,deleteWorkout:b,deleteWorkoutsForDate:d,clearAllWorkouts:W,removeDuplicates:h,getWorkoutsForExercise:g,getWorkoutsForDate:f,getWorkoutsByDate:D,getWorkoutsInDateRange:w,getLastWorkoutForExercise:p,getUniqueDates:$,getWorkoutCount:C,getTotalVolume:U,getWorkoutStats:_,loadWorkouts:o,exportWorkouts:j,importWorkouts:O}}const ss=[{id:1,name:"Barbell Bench Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:2,name:"Incline Barbell Bench Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:3,name:"Dumbbell Bench Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:4,name:"Incline Dumbbell Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:5,name:"Cable Fly",type:"isolation_upper",axial:!1,prim:["Chest"],sec:[],ter:["Shoulders"]},{id:6,name:"Push-ups",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:["Abs"]},{id:7,name:"Barbell Row",type:"compound_upper",axial:!0,prim:["Back"],sec:["Biceps","Traps"],ter:["Forearms"]},{id:8,name:"Pull-ups",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps"],ter:["Forearms","Traps"]},{id:9,name:"Lat Pulldown",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps"],ter:["Forearms"]},{id:10,name:"Seated Cable Row",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps","Traps"],ter:["Forearms"]},{id:11,name:"Dumbbell Row",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps","Traps"],ter:["Forearms"]},{id:12,name:"Deadlift",type:"compound_lower",axial:!0,prim:["Back","Hamstrings"],sec:["Glutes","Traps","Forearms"],ter:["Quads","Abs"]},{id:13,name:"Overhead Press",type:"compound_upper",axial:!0,prim:["Shoulders"],sec:["Triceps","Traps"],ter:["Abs"]},{id:14,name:"Dumbbell Shoulder Press",type:"compound_upper",axial:!1,prim:["Shoulders"],sec:["Triceps"],ter:["Traps"]},{id:15,name:"Lateral Raises",type:"isolation_upper",axial:!1,prim:["Shoulders"],sec:[],ter:["Traps"]},{id:16,name:"Front Raises",type:"isolation_upper",axial:!1,prim:["Shoulders"],sec:[],ter:[]},{id:17,name:"Face Pulls",type:"isolation_upper",axial:!1,prim:["Shoulders","Traps"],sec:["Back"],ter:[]},{id:18,name:"Barbell Curl",type:"isolation_upper",axial:!1,prim:["Biceps"],sec:["Forearms"],ter:[]},{id:19,name:"Dumbbell Curl",type:"isolation_upper",axial:!1,prim:["Biceps"],sec:["Forearms"],ter:[]},{id:20,name:"Hammer Curl",type:"isolation_upper",axial:!1,prim:["Biceps","Forearms"],sec:[],ter:[]},{id:21,name:"Tricep Pushdown",type:"isolation_upper",axial:!1,prim:["Triceps"],sec:[],ter:[]},{id:22,name:"Overhead Tricep Extension",type:"isolation_upper",axial:!1,prim:["Triceps"],sec:[],ter:[]},{id:23,name:"Dips",type:"compound_upper",axial:!1,prim:["Triceps","Chest"],sec:["Shoulders"],ter:[]},{id:24,name:"Barbell Squat",type:"compound_lower",axial:!0,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:["Abs","Calves"]},{id:25,name:"Front Squat",type:"compound_lower",axial:!0,prim:["Quads"],sec:["Glutes"],ter:["Abs","Hamstrings"]},{id:26,name:"Leg Press",type:"compound_lower",axial:!1,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:[]},{id:27,name:"Romanian Deadlift",type:"compound_lower",axial:!0,prim:["Hamstrings"],sec:["Glutes","Back"],ter:["Forearms"]},{id:28,name:"Leg Curl",type:"isolation_lower",axial:!1,prim:["Hamstrings"],sec:[],ter:[]},{id:29,name:"Leg Extension",type:"isolation_lower",axial:!1,prim:["Quads"],sec:[],ter:[]},{id:30,name:"Bulgarian Split Squat",type:"compound_lower",axial:!1,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:["Abs"]},{id:31,name:"Lunges",type:"compound_lower",axial:!1,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:[]},{id:32,name:"Hip Thrust",type:"compound_lower",axial:!1,prim:["Glutes"],sec:["Hamstrings"],ter:[]},{id:33,name:"Calf Raises",type:"isolation_lower",axial:!1,prim:["Calves"],sec:[],ter:[]},{id:34,name:"Plank",type:"isolation_upper",axial:!1,prim:["Abs"],sec:["Shoulders"],ter:[]},{id:35,name:"Cable Crunch",type:"isolation_upper",axial:!1,prim:["Abs"],sec:[],ter:[]},{id:36,name:"Hanging Leg Raise",type:"isolation_upper",axial:!1,prim:["Abs"],sec:[],ter:["Forearms"]},{id:37,name:"Russian Twist",type:"isolation_upper",axial:!1,prim:["Abs"],sec:[],ter:[]},{id:38,name:"Barbell Shrug",type:"isolation_upper",axial:!1,prim:["Traps"],sec:["Forearms"],ter:[]},{id:39,name:"Dumbbell Shrug",type:"isolation_upper",axial:!1,prim:["Traps"],sec:["Forearms"],ter:[]},{id:40,name:"Wrist Curl",type:"isolation_upper",axial:!1,prim:["Forearms"],sec:[],ter:[]},{id:41,name:"Farmer Carry",type:"compound_upper",axial:!0,prim:["Forearms","Traps"],sec:["Abs"],ter:["Calves"]}];function Be(){return[...ss]}function rs(){const[t,s]=c.useState([]),[r,a]=c.useState(!1),[n,l]=c.useState(null),m=c.useCallback(async()=>{a(!0),l(null);try{const w=await X.loadCollection(ee.EXERCISES);if(w&&w.length>0)s(w);else{const p=Be();s(p),await X.saveCollection(ee.EXERCISES,p)}}catch(w){console.error("Failed to load exercises:",w),l(w.message);const p=Be();s(p)}finally{a(!1)}},[]),o=c.useCallback(async w=>{try{return await X.saveCollection(ee.EXERCISES,w),s(w),!0}catch(p){return console.error("Failed to save exercises:",p),l(p.message),!1}},[]),i=c.useCallback(async w=>{try{const p=t.length>0?Math.max(...t.map(_=>_.id))+1:1,C={...w,id:p,createdAt:new Date().toISOString()},$=[...t,C];return await o($)?C:null}catch(p){return console.error("Failed to add exercise:",p),l(p.message),null}},[t,o]),N=c.useCallback(async(w,p)=>{try{const C=t.map($=>$.id===w?{...$,...p,updatedAt:new Date().toISOString()}:$);return await o(C)}catch(C){return console.error("Failed to update exercise:",C),l(C.message),!1}},[t,o]),x=c.useCallback(async w=>{try{const p=t.filter(C=>C.id!==w);return await o(p)}catch(p){return console.error("Failed to delete exercise:",p),l(p.message),!1}},[t,o]),S=c.useCallback(w=>t.find(p=>p.id===w)||null,[t]),b=c.useCallback(w=>t.filter(p=>{var C,$,U;return((C=p.prim)==null?void 0:C.includes(w))||(($=p.sec)==null?void 0:$.includes(w))||((U=p.ter)==null?void 0:U.includes(w))}),[t]),h=c.useCallback(w=>t.filter(p=>p.type===w),[t]),d=c.useCallback(w=>{const p=w.toLowerCase();return t.filter(C=>C.name.toLowerCase().includes(p))},[t]),g=c.useCallback(async()=>{try{const w=Be();return await o(w)}catch(w){return console.error("Failed to reset exercises:",w),l(w.message),!1}},[o]),f=c.useCallback(async w=>{try{const p=new Set(t.map(_=>_.name.toLowerCase()));let C=t.length>0?Math.max(...t.map(_=>_.id)):0;const $=w.filter(_=>!p.has(_.name.toLowerCase())).map(_=>({..._,id:++C,createdAt:new Date().toISOString()})),U=[...t,...$];return await o(U)}catch(p){return console.error("Failed to import exercises:",p),l(p.message),!1}},[t,o]),D=c.useCallback(()=>t.length,[t]);return c.useEffect(()=>{m()},[m]),{exercises:t,isLoading:r,error:n,addExercise:i,updateExercise:N,deleteExercise:x,getExerciseById:S,getExercisesByMuscle:b,getExercisesByType:h,searchExercises:d,loadExercises:m,resetToPresets:g,importExercises:f,getExerciseCount:D}}function as(t){const[s,r]=c.useState([]),[a,n]=c.useState(null),[l,m]=c.useState(0),[o,i]=c.useState(!1),[N,x]=c.useState(null),S=c.useCallback(async()=>{i(!0),x(null);try{const u=await X.loadCollection(ee.PROGRAMS);r(u||[])}catch(u){console.error("Failed to load programs:",u),x(u.message),r([])}finally{i(!1)}},[]),b=c.useCallback(async()=>{if(t)try{const u=await X.loadActiveProgram(t);if(u&&u.programId){const A=(await X.loadCollection(ee.PROGRAMS)).find(B=>B.id===u.programId);A?(n(A),m(u.currentDayIndex||0)):await X.saveActiveProgram(t,null)}}catch(u){console.error("Failed to load active program:",u)}},[t]),h=c.useCallback(async(u,y)=>{if(t)try{await X.saveActiveProgram(t,{programId:u,currentDayIndex:y})}catch(A){console.error("Failed to save active program state:",A)}},[t]),d=c.useCallback(async u=>{try{return await X.saveCollection(ee.PROGRAMS,u),r(u),!0}catch(y){return console.error("Failed to save programs:",y),x(y.message),!1}},[]),g=c.useCallback(async u=>{try{const y=s.length>0?Math.max(...s.map(k=>k.id))+1:1,A={...u,id:y,createdAt:new Date().toISOString()},B=[...s,A];return await d(B)?A:null}catch(y){return console.error("Failed to add program:",y),x(y.message),null}},[s,d]),f=c.useCallback(async(u,y)=>{try{const A=s.map(Y=>Y.id===u?{...Y,...y,updatedAt:new Date().toISOString()}:Y),B=await d(A);if(B&&(a==null?void 0:a.id)===u){const Y=A.find(k=>k.id===u);n(Y),await h(u,l)}return B}catch(A){return console.error("Failed to update program:",A),x(A.message),!1}},[s,a,l,d,h]),D=c.useCallback(async u=>{try{const y=s.filter(B=>B.id!==u),A=await d(y);return A&&(a==null?void 0:a.id)===u&&await C(),A}catch(y){return console.error("Failed to delete program:",y),x(y.message),!1}},[s,a,d]),w=c.useCallback(u=>s.find(y=>y.id===u)||null,[s]),p=c.useCallback(async u=>{if(!t)return x("User ID required to start program"),!1;try{const y=w(u);return y?(n(y),m(0),await h(u,0),!0):(x("Program not found"),!1)}catch(y){return console.error("Failed to start program:",y),x(y.message),!1}},[t,w,h]),C=c.useCallback(async()=>{if(!t)return!1;try{return n(null),m(0),await X.saveActiveProgram(t,null),!0}catch(u){return console.error("Failed to stop program:",u),x(u.message),!1}},[t]),$=c.useCallback(async()=>{if(!a||!a.days)return null;try{const u=(l+1)%a.days.length;return m(u),t&&await h(a.id,u),a.days[u]}catch(u){return console.error("Failed to advance day:",u),x(u.message),null}},[a,l,t,h]),U=c.useCallback(async u=>{if(!a||!a.days)return!1;if(u<0||u>=a.days.length)return x("Invalid day index"),!1;try{return m(u),t&&await h(a.id,u),!0}catch(y){return console.error("Failed to go to day:",y),x(y.message),!1}},[a,t,h]),_=c.useCallback(()=>!a||!a.days||a.days.length===0?null:a.days[l]||null,[a,l]),W=c.useCallback(()=>!a||!a.days?{currentDay:0,totalDays:0,percentage:0,daysCompleted:0}:{currentDay:l+1,totalDays:a.days.length,percentage:(l+1)/a.days.length*100,daysCompleted:l},[a,l]),j=c.useCallback(async u=>{const y=w(u);if(!y)return x("Program not found"),null;const A={...y,name:`${y.name} (Copy)`,id:void 0};return await g(A)},[w,g]),O=c.useCallback(()=>s.length,[s]);return c.useEffect(()=>{S()},[S]),c.useEffect(()=>{b()},[b]),{programs:s,activeProgram:a,currentDayIndex:l,isLoading:o,error:N,addProgram:g,updateProgram:f,deleteProgram:D,duplicateProgram:j,getProgramById:w,getProgramCount:O,startProgram:p,stopProgram:C,advanceToNextDay:$,goToDay:U,getCurrentDay:_,getProgramProgress:W,loadPrograms:S}}const gt={compound_upper:{name:"Compound Upper",description:"Multi-joint upper body movements",fatigueMultiplier:1.2,systemicFatigueImpact:.15,recommendedRepRange:{min:5,max:12},recommendedSets:{min:3,max:6},progressionIncrement:2.5,examples:["Bench Press","Pull-ups","Overhead Press","Rows"]},compound_lower:{name:"Compound Lower",description:"Multi-joint lower body movements",fatigueMultiplier:1.5,systemicFatigueImpact:.25,recommendedRepRange:{min:5,max:15},recommendedSets:{min:3,max:6},progressionIncrement:5,examples:["Squat","Deadlift","Lunges","Leg Press"]},isolation_upper:{name:"Isolation Upper",description:"Single-joint upper body movements",fatigueMultiplier:.8,systemicFatigueImpact:.05,recommendedRepRange:{min:8,max:20},recommendedSets:{min:2,max:5},progressionIncrement:2.5,examples:["Bicep Curls","Tricep Extensions","Lateral Raises","Flyes"]},isolation_lower:{name:"Isolation Lower",description:"Single-joint lower body movements",fatigueMultiplier:.9,systemicFatigueImpact:.08,recommendedRepRange:{min:10,max:20},recommendedSets:{min:2,max:5},progressionIncrement:5,examples:["Leg Curls","Leg Extensions","Calf Raises","Hip Abduction"]}};function ns(t){return t==="compound_upper"||t==="compound_lower"}function Ze(t){const s=gt[t];return s?s.progressionIncrement:2.5}function ls(t,s,r=0){const a=s+r;return t*(1+a/30)}function Ge(t,s,r,a){const{w:n,r:l,rir:m}=t,o=Math.exp(-.3*m),i=a>0?n/a:.5,N=r==="primary"?J.PRIMARY_MUSCLE_MULTIPLIER:r==="secondary"?J.SECONDARY_MUSCLE_MULTIPLIER:J.TERTIARY_MUSCLE_MULTIPLIER;return o*i*N}function Ve(t,s,r,a=!1){const{w:n,r:l}=t,m=n*l,o=r==="primary"?J.PRIMARY_MUSCLE_MULTIPLIER:r==="secondary"?J.SECONDARY_MUSCLE_MULTIPLIER:J.TERTIARY_MUSCLE_MULTIPLIER,i=a?J.AXIAL_LOAD_MULTIPLIER:1;return m*o*i}function os(t,s,r=!1){const{w:a,r:n}=t;if(!ns(s))return 0;const l=a*n,m=r?J.AXIAL_LOAD_MULTIPLIER:1,o=J.COMPOUND_SYSTEMIC_MULTIPLIER;return l*m*o}function is(t){const{sets:s,type:r,axial:a,prim:n=[],sec:l=[],ter:m=[]}=t;if(!s||s.length===0)return{stimulus:{},localFatigue:{},systemicFatigue:0,setCount:0};const o=s.reduce((b,h)=>h.w*h.r>b.w*b.r?h:b,s[0]),i=ls(o.w,o.r,o.rir),N={},x={};let S=0;return s.forEach(b=>{n.forEach(h=>{N[h]=(N[h]||0)+Ge(b,h,"primary",i),x[h]=(x[h]||0)+Ve(b,h,"primary",a)}),l.forEach(h=>{N[h]=(N[h]||0)+Ge(b,h,"secondary",i),x[h]=(x[h]||0)+Ve(b,h,"secondary",a)}),m.forEach(h=>{N[h]=(N[h]||0)+Ge(b,h,"tertiary",i),x[h]=(x[h]||0)+Ve(b,h,"tertiary",a)}),S+=os(b,r,a)}),{stimulus:N,localFatigue:x,systemicFatigue:S,setCount:s.length,estimated1RM:i}}function cs(t,s){const{localFatigue:r={},systemicFatigue:a=0}=t,{rirError:n=0,soreness:l={},perceivedFatigue:m=5}=s,o={...r};let i=a;if(n<0){const x=Math.abs(n)*J.RIR_MISS_FATIGUE_PENALTY;i+=x,Object.keys(r).forEach(S=>{o[S]=(o[S]||0)+x})}Object.entries(l).forEach(([x,S])=>{if(S>0){const b=S/10*J.SORENESS_FATIGUE_WEIGHT;o[x]=(o[x]||0)*(1+b)}});const N=m-5;if(N!==0){const x=N/5*J.PERCEIVED_FATIGUE_WEIGHT;i*=1+x}return{localFatigue:o,systemicFatigue:i}}function ds(t,s,r,a=null){const{localFatigue:n={},systemicFatigue:l=0,weeklyStimulus:m={},perceivedFatigue:o=5,muscleSoreness:i={},lastWorkoutDate:N=null}=r;if(a!=null&&a.isRestDay||t.length===0&&a){const $=qe({localFatigue:n,systemicFatigue:l},N||s,s,{plannedRestDays:1});return{localFatigue:$.localFatigue,systemicFatigue:$.systemicFatigue,weeklyStimulus:m,sessionStimulus:{},muscleReadiness:Ae($.localFatigue),systemicReadiness:Oe($.systemicFatigue),lastWorkoutDate:N,isRestDay:!0}}let x=0;a!=null&&a.activeProgram&&N&&(x=us(a.activeProgram,a.lastDayIndex||0,a.currentDayIndex||0));const S=qe({localFatigue:n,systemicFatigue:l},N,s,{plannedRestDays:x}),b={...S.localFatigue};let h=S.systemicFatigue;const d={...m},g={};t.forEach($=>{const U=is($);Object.entries(U.stimulus).forEach(([_,W])=>{g[_]=(g[_]||0)+W,d[_]=(d[_]||0)+W}),Object.entries(U.localFatigue).forEach(([_,W])=>{b[_]=(b[_]||0)+W}),h+=U.systemicFatigue});const f=cs({localFatigue:b,systemicFatigue:h},{rirError:0,soreness:i,perceivedFatigue:o}),D={};Object.entries(f.localFatigue).forEach(([$,U])=>{D[$]=Math.log1p(U/1e3)});const w=Math.log1p(f.systemicFatigue/1e3),p=Ae(D),C=Oe(w);return{localFatigue:D,systemicFatigue:w,weeklyStimulus:d,sessionStimulus:g,muscleReadiness:p,systemicReadiness:C,lastWorkoutDate:s,restBonus:S.restBonus,isRestDay:!1}}function us(t,s,r){var l;if(!t||!t.days)return 0;let a=0,n=s;for(;n!==r&&(n=(n+1)%t.days.length,n!==r);)(l=t.days[n])!=null&&l.isRestDay&&a++;return a}function qe(t,s,r,a=null){if(!s)return t;const n=xs(s,r);if(n<=0)return t;const{localFatigue:l={},systemicFatigue:m=0}=t;let o=1;a&&a.plannedRestDays>0&&(o=1+Math.min(.5,a.plannedRestDays*.1));const i=J.LOCAL_RECOVERY_RATE*o,N=J.SYSTEMIC_RECOVERY_RATE*o,x={};Object.entries(l).forEach(([b,h])=>{x[b]=Math.max(0,h*Math.exp(-i*n))});const S=Math.max(0,m*Math.exp(-N*n));return{localFatigue:x,systemicFatigue:S,restBonus:o}}function Ae(t){const s={};return re.forEach(r=>{const a=t[r]||0;s[r]=Math.exp(-a)}),s}function Oe(t){return Math.exp(-t)}function gs(t,s){const r={};return Object.entries(t).forEach(([a,n])=>{r[a]=Math.max(0,n*Math.exp(-.14*s))}),r}function ms(t,s,r={}){const a=J.DELOAD_THRESHOLD;if(s<.5)return{needed:!0,type:"systemic",severity:"high",message:"Systemic fatigue is critically high - immediate deload needed",recommendation:"Reduce volume 40-60%, increase RIR by 2-3, remove axial loads"};if(s<a)return{needed:!0,type:"systemic",severity:"moderate",message:"Systemic deload needed - reduce overall training volume",recommendation:"Reduce sets by 40%, increase RIR by 2, lighter axial loads"};const n=Object.entries(t).filter(([l,m])=>m<a).map(([l,m])=>({muscle:l,readiness:m}));return n.length>0?{needed:!0,type:"local",severity:n.length>3?"high":"moderate",muscles:n,message:`Local deload needed for: ${n.map(l=>l.muscle).join(", ")}`,recommendation:"Reduce volume 30-40% for affected muscles, add 1-2 RIR"}:{needed:!1,type:null,severity:"none",message:"Recovery is adequate"}}function xs(t,s){const r=new Date(t),a=new Date(s),n=Math.abs(a-r);return Math.floor(n/(1e3*60*60*24))}function ps(t,s){const r={};return Object.keys(t).forEach(a=>{const n=t[a]||0,l=s[a]||.001;r[a]=n/l}),r}function hs(t,s=[]){const[r,a]=c.useState({}),[n,l]=c.useState(0),[m,o]=c.useState({}),[i,N]=c.useState([]),[x,S]=c.useState({}),[b,h]=c.useState(1),[d,g]=c.useState(5),[f,D]=c.useState({}),[w,p]=c.useState([]),[C,$]=c.useState([]),[U,_]=c.useState(null),[W,j]=c.useState(null),[O,u]=c.useState(!1),[y,A]=c.useState(null),B=F=>{if(F==null)return null;if(typeof F!="object")return F;if(Array.isArray(F))return F.filter(L=>L!==void 0).map(L=>B(L));const P={};return Object.keys(F).forEach(L=>{const v=F[L];v!==void 0&&(Array.isArray(v)?P[L]=v.filter(T=>T!==void 0).map(T=>B(T)):v&&typeof v=="object"?P[L]=B(v):P[L]=v)}),P},Y=c.useCallback(async()=>{if(!t){ue();return}u(!0),A(null);try{const F=await X.loadFatigueState(t);if(F&&Object.keys(F).length>0)if(a(F.localFatigue||{}),l(F.systemicFatigue||0),o(F.weeklyStimulus||{}),N(F.stimulusHistory||[]),_(F.lastWorkoutDate||null),j(F.lastUpdateDate||null),p(F.performanceErrors||[]),$(F.readinessHistory||[]),F.lastUpdateDate){const P=new Date().toISOString().split("T")[0];G(P)}else{const P=Ae(F.localFatigue||{}),L=Oe(F.systemicFatigue||0);S(P),h(L)}else ue()}catch(F){console.error("Failed to load fatigue state:",F),A(F.message),ue()}finally{u(!1)}},[t]),k=c.useCallback(async()=>{if(!t)throw new Error("User ID required to save fatigue state");try{console.log("ðŸ’¾ Saving fatigue state...");const F={localFatigue:r,systemicFatigue:n,weeklyStimulus:m,stimulusHistory:i,lastWorkoutDate:U,lastUpdateDate:new Date().toISOString().split("T")[0],performanceErrors:w,readinessHistory:C};console.log("  Raw data:",F);try{JSON.stringify(F)}catch(L){console.error("  âŒ Data contains non-serializable values:",L)}const P=B(F);console.log("  Cleaned data:",P);try{const L=JSON.stringify(P);console.log("  Stringified successfully, length:",L.length)}catch(L){console.error("  âŒ Cleaned data still has issues:",L)}return await X.saveFatigueState(t,P),console.log("  âœ… Fatigue saved successfully"),!0}catch(F){return console.error("Failed to save fatigue state:",F),A(F.message),!1}},[t,r,n,m,i,U,w,C]),I=c.useCallback(async(F,P,L={},v=null)=>{console.log("ðŸ‹ï¸ processWorkoutSession:"),console.log("  observationalData received:",L);try{const T=v?{...v,workoutHistory:s}:{workoutHistory:s},R=ds(F,P,{localFatigue:r,systemicFatigue:n,weeklyStimulus:m,perceivedFatigue:L.perceivedFatigue||d,muscleSoreness:L.muscleSoreness||f,lastWorkoutDate:U},T);if(console.log("ðŸ“Š Updating fatigue state after session:"),console.log("  weeklyStimulus:",R.weeklyStimulus),console.log("  sessionStimulus:",R.sessionStimulus),console.log("  totalStimulus:",Object.values(R.weeklyStimulus||{}).reduce((oe,me)=>oe+me,0)),a(R.localFatigue),l(R.systemicFatigue),o(R.weeklyStimulus),S(R.muscleReadiness),h(R.systemicReadiness),R.isRestDay||_(R.lastWorkoutDate),j(P),!R.isRestDay&&R.sessionStimulus){const oe=[...i.slice(-6),{date:P,stimulus:R.sessionStimulus,totalStimulus:Object.values(R.sessionStimulus).reduce((me,Ee)=>me+Ee,0)}];N(oe)}const H=[...C.slice(-6),{date:P,systemicReadiness:R.systemicReadiness,avgMuscleReadiness:Object.values(R.muscleReadiness).reduce((oe,me)=>oe+me,0)/re.length,isRestDay:R.isRestDay||!1,actualRestDays:R.actualRestDays,plannedRestDays:R.plannedRestDays,perceivedFatigue:L.perceivedFatigue||d,muscleSoreness:L.muscleSoreness||f}],q=H[H.length-1];if(console.log("ðŸ“ New readiness entry:"),console.log("  Full object:",JSON.stringify(q,null,2)),console.log("  perceivedFatigue:",q.perceivedFatigue),console.log("  muscleSoreness:",q.muscleSoreness),$(H),!R.isRestDay&&L.rirErrors&&L.rirErrors.length>0){const oe=[...w.slice(-9),{date:P,errors:L.rirErrors}];p(oe)}console.log("ðŸ’¾ Saving fatigue from processWorkoutSession...");const ae={localFatigue:R.localFatigue,systemicFatigue:R.systemicFatigue,weeklyStimulus:R.weeklyStimulus,stimulusHistory:(R.isRestDay,i),lastWorkoutDate:R.isRestDay?U:R.lastWorkoutDate,lastUpdateDate:P,performanceErrors:w,readinessHistory:H};console.log("  Raw fatigue data:",ae);const ge=B(ae);console.log("  Cleaned fatigue data:",ge);const Fe=(oe,me="")=>{Object.keys(oe).forEach(Ee=>{const fe=oe[Ee],Re=me?`${me}.${Ee}`:Ee;fe===void 0?console.error(`  âŒ FOUND UNDEFINED at: ${Re}`):fe&&typeof fe=="object"&&!Array.isArray(fe)?Fe(fe,Re):Array.isArray(fe)&&fe.forEach((De,_e)=>{De===void 0?console.error(`  âŒ FOUND UNDEFINED at: ${Re}[${_e}]`):De&&typeof De=="object"&&Fe(De,`${Re}[${_e}]`)})})};return Fe(ge),await X.saveFatigueState(t,ge),console.log("  âœ… Fatigue from processWorkoutSession saved"),!0}catch(T){return console.error("Failed to process workout session:",T),A(T.message),!1}},[t,r,n,m,i,d,f,U,w,C,s]),G=c.useCallback((F,P=null)=>{if(!W&&!U)return{localFatigue:r,systemicFatigue:n};const v=qe({localFatigue:r,systemicFatigue:n},W||U,F,P);a(v.localFatigue),l(v.systemicFatigue),j(F);const T=Ae(v.localFatigue),R=Oe(v.systemicFatigue);S(T),h(R);const H=W?bs(W,F):0;if(console.log("ðŸ“‰ Weekly Stimulus Decay Check:"),console.log("  Last update date:",W),console.log("  Current date:",F),console.log("  Days since:",H),console.log("  Current weeklyStimulus:",m),H>0){const q=gs(m,H);console.log("  Decayed weeklyStimulus:",q),o(q)}return v},[r,n,m,U,W]),z=c.useCallback(()=>{let F=0;const P=[];b<J.DELOAD_THRESHOLD&&(F++,P.push("Low systemic readiness")),Object.values(f).filter(H=>H>6).length>2&&(F++,P.push("Persistent muscle soreness"));const v=i.slice(-3).map(H=>H.totalStimulus);if(v.length>=3){const H=v.reduce((ae,ge)=>ae+ge,0)/v.length;v.every(ae=>Math.abs(ae-H)<H*.1)&&b>.65&&(F++,P.push("Stimulus plateau despite recovery"))}const T=w.slice(-2);T.length>=J.PERFORMANCE_ERROR_SESSIONS&&T.every(q=>q.errors.some(ae=>ae<J.PERFORMANCE_ERROR_THRESHOLD))&&(F++,P.push("Consistent performance decline"));const R=ms(x,b);return R.needed||F>=J.DELOAD_MIN_CONDITIONS?{...R,needed:!0,conditionsMet:F,conditions:P,message:R.needed?R.message:`Deload recommended: ${F} conditions met`}:R},[x,b,f,i,w]),Q=c.useCallback(()=>{var T;if(i.length===0)return{efficiency:{},trend:"insufficient_data"};const F=((T=i[i.length-1])==null?void 0:T.stimulus)||{},P=ps(F,r),L=i.slice(-4).map(R=>R.totalStimulus),v=L.length>=4&&L.every((R,H,q)=>H===0||R>=q[H-1])?"increasing":L.length>=4&&L.every((R,H,q)=>H===0||R<=q[H-1])?"decreasing":"stable";return{efficiency:P,trend:v,recentStimulus:L}},[r,i]),ne=c.useCallback(()=>{const F={};Object.entries(r).forEach(([L,v])=>{if(v>0){const R=J.LOCAL_RECOVERY_RATE;try{const H=-Math.log(.85);if(v<=H)F[L]=0;else{const q=Math.log(v/H)/R;F[L]=Math.max(0,Math.ceil(q))}}catch{F[L]=0}}else F[L]=0});let P=0;if(n>0)try{const L=-Math.log(.85),v=J.SYSTEMIC_RECOVERY_RATE;n>L&&(P=Math.ceil(Math.log(n/L)/v))}catch{P=0}return{muscleRecoveryDays:F,systemicRecoveryDays:P,maxRecoveryDays:Math.max(P,...Object.values(F))}},[r,n]),se=c.useCallback(F=>{g(Math.max(0,Math.min(10,F)))},[]),ye=c.useCallback((F,P)=>{D(L=>({...L,[F]:Math.max(0,Math.min(10,P))}))},[]),he=c.useCallback(()=>{D({})},[]),Ne=c.useCallback(F=>x[F]||1,[x]),Se=c.useCallback(F=>r[F]||0,[r]),be=c.useCallback(F=>m[F]||0,[m]),ue=c.useCallback(()=>{a({}),l(0),o({}),N([]),_(null),j(null),g(5),D({}),p([]),$([]);const F={};re.forEach(P=>{F[P]=1}),S(F),h(1)},[]),ve=c.useCallback(()=>{const F=re.reduce((v,T)=>v+(x[T]||1),0)/re.length,P=z();let L="optimal";return b<.6||F<.6?L="poor":b<.75||F<.75?L="moderate":(b<.85||F<.85)&&(L="good"),{status:L,systemicReadiness:b,avgMuscleReadiness:F,deloadNeeded:P.needed,deloadMessage:P.message,deloadConditions:P.conditions||[]}},[x,b,z]),Z=c.useCallback((F,P)=>{const L={...r};L[F]=Math.max(0,P),a(L);const v=Ae(L);S(v)},[r]);return c.useEffect(()=>{Y()},[Y]),c.useEffect(()=>{if(t&&!O){const F=setTimeout(()=>{k()},1e3);return()=>clearTimeout(F)}},[t,r,n,m,i,O,k]),c.useEffect(()=>{if(W){const F=new Date().toISOString().split("T")[0];F!==W&&G(F)}},[W,G]),{localFatigue:r,systemicFatigue:n,weeklyStimulus:m,stimulusHistory:i,muscleReadiness:x,systemicReadiness:b,lastWorkoutDate:U,perceivedFatigue:d,muscleSoreness:f,performanceErrors:w,readinessHistory:C,isLoading:O,error:y,processWorkoutSession:I,applyRecovery:G,getMuscleReadiness:Ne,getMuscleFatigue:Se,getMuscleStimulus:be,getDeloadRecommendation:z,getRecoveryTimeline:ne,getRecoveryStatus:ve,getStimulusEfficiency:Q,updatePerceivedFatigue:se,updateMuscleSoreness:ye,clearMuscleSoreness:he,setManualFatigue:Z,loadFatigueState:Y,saveFatigueState:k,resetFatigueState:ue}}function bs(t,s){const r=new Date(t),a=new Date(s),n=Math.abs(a-r);return Math.floor(n/(1e3*60*60*24))}function fs(t=120){const[s,r]=c.useState(0),[a,n]=c.useState(!1),l=c.useRef(null),m=(b=t)=>{r(b),n(!0)},o=()=>{n(!1),r(0),l.current&&clearInterval(l.current)},i=()=>{n(!1)},N=()=>{s>0&&n(!0)},x=b=>{r(h=>h+b)};return c.useEffect(()=>(a&&s>0?l.current=setInterval(()=>{r(b=>b<=1?(n(!1),0):b-1)},1e3):l.current&&clearInterval(l.current),()=>{l.current&&clearInterval(l.current)}),[a,s]),{timeRemaining:s,isActive:a,start:m,stop:o,pause:i,resume:N,addTime:x,formattedTime:(()=>{const b=Math.floor(s/60),h=s%60;return`${b}:${h.toString().padStart(2,"0")}`})()}}const we={themeColor:"blue",restTimerEnabled:!0,defaultRestTime:120},et={blue:{name:"Blue",primary:"bg-blue-600 hover:bg-blue-700",light:"bg-blue-50 border-blue-200",text:"text-blue-900",accent:"text-blue-700"},green:{name:"Green",primary:"bg-green-600 hover:bg-green-700",light:"bg-green-50 border-green-200",text:"text-green-900",accent:"text-green-700"},purple:{name:"Purple",primary:"bg-purple-600 hover:bg-purple-700",light:"bg-purple-50 border-purple-200",text:"text-purple-900",accent:"text-purple-700"},orange:{name:"Orange",primary:"bg-orange-600 hover:bg-orange-700",light:"bg-orange-50 border-orange-200",text:"text-orange-900",accent:"text-orange-700"},red:{name:"Red",primary:"bg-red-600 hover:bg-red-700",light:"bg-red-50 border-red-200",text:"text-red-900",accent:"text-red-700"},indigo:{name:"Indigo",primary:"bg-indigo-600 hover:bg-indigo-700",light:"bg-indigo-50 border-indigo-200",text:"text-indigo-900",accent:"text-indigo-700"},pink:{name:"Pink",primary:"bg-pink-600 hover:bg-pink-700",light:"bg-pink-50 border-pink-200",text:"text-pink-900",accent:"text-pink-700"},teal:{name:"Teal",primary:"bg-teal-600 hover:bg-teal-700",light:"bg-teal-50 border-teal-200",text:"text-teal-900",accent:"text-teal-700"}};function ys(t){const[s,r]=c.useState(we),[a,n]=c.useState(!1),[l,m]=c.useState(null);return c.useEffect(()=>{if(!t){r(we),n(!0),m(null);return}(async()=>{try{const x=await X.loadSettings(t);if(x){const{userId:S,updatedAt:b,...h}=x,d={...we,...h};r(d),m(JSON.stringify(d)),console.log("âœ… Loaded settings from database")}else r(we),m(JSON.stringify(we)),console.log("â„¹ï¸ No settings found, using defaults")}catch(x){console.error("Failed to load settings:",x),r(we),m(JSON.stringify(we))}finally{n(!0)}})()},[t]),c.useEffect(()=>{if(!t||!a)return;const N=JSON.stringify(s);if(N===l)return;const S=setTimeout(async()=>{try{await X.saveSettings(t,s),m(N),console.log("âœ… Saved settings to database")}catch(b){console.error("Failed to save settings:",b)}},500);return()=>clearTimeout(S)},[s,t,a,l]),{settings:s,updateSetting:(N,x)=>{r(S=>({...S,[N]:x}))},resetSettings:()=>{r(we)},themeColors:et,currentTheme:et[s.themeColor],isLoaded:a}}function vs({onLogin:t}){const[s,r]=c.useState("login"),[a,n]=c.useState(""),[l,m]=c.useState(""),[o,i]=c.useState(""),[N,x]=c.useState(""),[S,b]=c.useState(!1),[h,d]=c.useState(!1),g=async w=>{if(w.preventDefault(),x(""),!a.trim()){x("Please enter a username");return}if(!l){x("Please enter a password");return}if(s==="register"){if(a.trim().length<3){x("Username must be at least 3 characters");return}if(l.length<6){x("Password must be at least 6 characters");return}if(!o){x("Please confirm your password");return}if(l!==o){x("Passwords do not match");return}}b(!0);try{const p=s==="register",C=await t(a.trim(),l,p);C.success||x(C.error||"Authentication failed")}catch(p){x(p.message||"An error occurred. Please try again.")}finally{b(!1)}},f=()=>{r(s==="login"?"register":"login"),x(""),m(""),i("")},D=w=>{w.key==="Enter"&&g(w)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("h1",{className:"text-3xl font-bold mb-2 text-slate-900",children:"Workout Tracker"}),e.jsx("p",{className:"text-slate-600",children:s==="login"?"Welcome back!":"Create your account"})]}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Username"}),e.jsx("input",{id:"username",type:"text",value:a,onChange:w=>n(w.target.value),onKeyPress:D,placeholder:"Enter your username",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg text-lg focus:outline-none focus:border-blue-500 transition-colors",autoFocus:!0,disabled:S,autoComplete:"username"}),s==="register"&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"At least 3 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:h?"text":"password",value:l,onChange:w=>m(w.target.value),onKeyPress:D,placeholder:"Enter your password",className:"w-full px-4 py-3 pr-12 border-2 border-slate-300 rounded-lg text-lg focus:outline-none focus:border-blue-500 transition-colors",disabled:S,autoComplete:s==="login"?"current-password":"new-password"}),e.jsx("button",{type:"button",onClick:()=>d(!h),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",tabIndex:-1,children:h?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),s==="register"&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"At least 6 characters"})]}),s==="register"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Confirm Password"}),e.jsx("input",{id:"confirmPassword",type:h?"text":"password",value:o,onChange:w=>i(w.target.value),onKeyPress:D,placeholder:"Confirm your password",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg text-lg focus:outline-none focus:border-blue-500 transition-colors",disabled:S,autoComplete:"new-password"})]}),N&&e.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-700 text-sm font-medium",children:N})}),e.jsx("button",{type:"submit",disabled:S,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 active:bg-blue-800 disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors",children:S?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="login"?"Logging in...":"Creating account..."]}):s==="login"?"Login":"Create Account"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:f,className:"text-sm text-blue-600 hover:text-blue-700 font-medium hover:underline",disabled:S,children:s==="login"?"Don't have an account? Register":"Already have an account? Login"})}),s==="register"&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-700",children:"ðŸ”’ Your password is securely hashed and stored. Make sure to remember it!"})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"space-y-2 text-xs text-slate-500",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),"Your workouts and progress are private"]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),"Exercises and programs are shared globally"]})]})}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Features"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-blue-600 font-semibold text-sm mb-1",children:"ðŸ“Š Progress Tracking"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Log sets, reps, and weight"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-green-600 font-semibold text-sm mb-1",children:"ðŸ’ª Recovery Metrics"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Smart fatigue tracking"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-purple-600 font-semibold text-sm mb-1",children:"ðŸ“… Program Builder"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Create custom routines"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-orange-600 font-semibold text-sm mb-1",children:"ðŸ“ˆ Progression"}),e.jsx("p",{className:"text-xs text-slate-600",children:"AI-powered advice"})]})]})]})]})})}function tt({weight:t,reps:s,rir:r,onWeightChange:a,onRepsChange:n,onRirChange:l,onSubmit:m,onCancel:o,weightLabel:i="Weight (lbs)",repsLabel:N="Reps",rirLabel:x="RIR",submitLabel:S="Add Set",showCancel:b=!1,autoFocusReps:h=!1,disabled:d=!1}){const g=c.useRef(null),f=c.useRef(null);c.useEffect(()=>{h&&g.current&&g.current.focus()},[h]);const D=(p,C)=>{p.key==="Enter"&&(p.preventDefault(),C&&C.current?C.current.focus():t&&s&&r!==""&&m())},w=t&&s&&r!=="";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:i}),e.jsx("input",{type:"number",step:"0.5",value:t,onChange:p=>a(p.target.value),onKeyPress:p=>D(p,g),placeholder:"lbs",disabled:d,className:"w-full px-4 py-4 border-2 border-slate-300 rounded-lg text-lg text-center font-semibold focus:outline-none focus:border-blue-500 disabled:bg-slate-100 disabled:cursor-not-allowed transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:N}),e.jsx("input",{ref:g,type:"number",value:s,onChange:p=>n(p.target.value),onKeyPress:p=>D(p,f),placeholder:"reps",disabled:d,className:"w-full px-4 py-4 border-2 border-slate-300 rounded-lg text-lg text-center font-semibold focus:outline-none focus:border-blue-500 disabled:bg-slate-100 disabled:cursor-not-allowed transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:x}),e.jsx("input",{ref:f,type:"number",min:"0",max:"10",value:r,onChange:p=>l(p.target.value),onKeyPress:p=>{p.key==="Enter"&&w&&(p.preventDefault(),m())},placeholder:"RIR",disabled:d,className:"w-full px-4 py-4 border-2 border-slate-300 rounded-lg text-lg text-center font-semibold focus:outline-none focus:border-blue-500 disabled:bg-slate-100 disabled:cursor-not-allowed transition-colors"})]})]}),e.jsxs("div",{className:"text-xs text-slate-500 text-center",children:[e.jsx("span",{className:"font-semibold",children:"RIR"})," = Reps In Reserve (0 = failure, 3 = could do 3 more)"]}),e.jsxs("div",{className:`flex gap-2 ${b?"grid grid-cols-2":""}`,children:[e.jsx("button",{onClick:m,disabled:!w||d,className:`${b?"":"w-full"} bg-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-blue-700 active:bg-blue-800 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors`,children:S}),b&&e.jsx("button",{onClick:o,disabled:d,className:"bg-slate-400 text-white py-4 rounded-lg font-bold text-lg hover:bg-slate-500 active:bg-slate-600 disabled:bg-slate-200 disabled:cursor-not-allowed transition-colors",children:"Cancel"})]})]})}function js({progression:t,className:s=""}){if(!t)return null;const{advice:r,readiness:a,suggestion:n,reason:l,muscleReadiness:m,systemicReadiness:o}=t;if(r==="first_time")return e.jsxs("div",{className:`border-2 border-blue-200 bg-blue-50 rounded-lg p-4 ${s}`,children:[e.jsx("div",{className:"text-sm font-semibold text-blue-900 mb-1",children:"ðŸ’¡ First Time"}),e.jsx("p",{className:"text-sm text-blue-800",children:n})]});const N=(()=>{switch(a){case"deload":return{bg:"bg-orange-100",border:"border-orange-300",icon:"ðŸ”„",title:"DELOAD NEEDED",titleColor:"text-orange-900"};case"high":return{bg:"bg-green-50",border:"border-green-200",icon:r==="progress"?"ðŸ“ˆ":"ðŸ’ª",title:r==="progress"?"Progress":"Ready to Push",titleColor:"text-green-900"};case"low":return{bg:"bg-red-50",border:"border-red-200",icon:"âš ï¸",title:"Reduce Load",titleColor:"text-red-900"};case"moderate":default:return{bg:"bg-yellow-50",border:"border-yellow-200",icon:"âž¡ï¸",title:"Maintain",titleColor:"text-yellow-900"}}})();return e.jsxs("div",{className:`border-2 rounded-lg p-4 ${N.bg} ${N.border} ${s}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:`text-base font-bold ${N.titleColor}`,children:[N.icon," ",N.title]}),(m!==void 0||o!==void 0)&&e.jsxs("div",{className:"flex gap-2 text-xs",children:[m!==void 0&&e.jsxs("span",{className:"bg-white bg-opacity-50 px-2 py-1 rounded font-semibold",children:["M: ",(m*100).toFixed(0),"%"]}),o!==void 0&&e.jsxs("span",{className:"bg-white bg-opacity-50 px-2 py-1 rounded font-semibold",children:["S: ",(o*100).toFixed(0),"%"]})]})]}),e.jsx("p",{className:"text-sm leading-relaxed mb-2",children:n}),l&&e.jsx("div",{className:`text-sm font-semibold ${a==="deload"?"text-orange-700":"text-slate-700"}`,children:l}),(m!==void 0||o!==void 0)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-opacity-30",style:{borderColor:"currentColor"},children:[e.jsx("div",{className:"text-xs font-semibold mb-2 opacity-75",children:"Readiness"}),e.jsxs("div",{className:"space-y-2",children:[m!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs w-16",children:"Muscle:"}),e.jsx("div",{className:"flex-1 bg-white bg-opacity-30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${m>.85?"bg-green-600":m>.65?"bg-yellow-600":m>.5?"bg-orange-600":"bg-red-600"}`,style:{width:`${m*100}%`}})}),e.jsxs("span",{className:"text-xs w-10 text-right font-semibold",children:[(m*100).toFixed(0),"%"]})]}),o!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs w-16",children:"System:"}),e.jsx("div",{className:"flex-1 bg-white bg-opacity-30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${o>.85?"bg-green-600":o>.65?"bg-yellow-600":o>.5?"bg-orange-600":"bg-red-600"}`,style:{width:`${o*100}%`}})}),e.jsxs("span",{className:"text-xs w-10 text-right font-semibold",children:[(o*100).toFixed(0),"%"]})]})]})]})]})}function mt({exercises:t,onSelect:s,placeholder:r="Select an exercise...",className:a="",exercisesByMuscle:n=null}){const[l,m]=c.useState(""),[o,i]=c.useState(""),[N,x]=c.useState(""),S=c.useMemo(()=>{if(n)return n;const f={};return t.forEach(D=>{f[D.muscle]||(f[D.muscle]=[]),f[D.muscle].push(D)}),f},[t,n]),b=c.useMemo(()=>{if(l&&S[l]){let f=S[l];return o&&(f=f.filter(D=>D.name.toLowerCase().includes(o.toLowerCase()))),f}return o?t.filter(f=>f.name.toLowerCase().includes(o.toLowerCase())):[]},[t,S,l,o]),h=f=>{m(f),x(""),i("")},d=f=>{i(f),m(""),x("")},g=f=>{x(f),f&&s&&(s(f),m(""),i(""),x(""))};return e.jsxs("div",{className:`space-y-3 ${a}`,children:[e.jsx("div",{children:e.jsx("input",{type:"text",value:o,onChange:f=>d(f.target.value),placeholder:"ðŸ” Search exercises...",className:"w-full px-4 py-3 border-2 rounded-lg text-base focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 border-t-2 border-gray-300"}),e.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"OR"}),e.jsx("div",{className:"flex-1 border-t-2 border-gray-300"})]}),e.jsx("div",{children:e.jsxs("select",{value:l,onChange:f=>h(f.target.value),className:"w-full px-4 py-3 border-2 rounded-lg text-base font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"1ï¸âƒ£ Select muscle group..."}),Object.entries(S).map(([f,D])=>e.jsxs("option",{value:f,children:[f," (",D.length,")"]},f))]})}),e.jsx("div",{children:e.jsxs("select",{value:N,onChange:f=>g(f.target.value),disabled:!l&&!o,className:"w-full px-4 py-3 border-2 rounded-lg text-base font-medium disabled:bg-gray-100 disabled:cursor-not-allowed focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:l||o?`2ï¸âƒ£ Choose exercise... (${b.length})`:r}),b.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]})}),(l||o)&&e.jsxs("div",{className:"flex gap-2 items-center text-sm flex-wrap",children:[e.jsx("span",{className:"text-gray-600",children:"Active filters:"}),l&&e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full font-medium",children:[l,e.jsx("button",{onClick:()=>m(""),className:"ml-2 text-blue-500 hover:text-blue-700",children:"Ã—"})]}),o&&e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full font-medium",children:['"',o,'"',e.jsx("button",{onClick:()=>i(""),className:"ml-2 text-green-500 hover:text-green-700",children:"Ã—"})]})]})]})}function xt(t){const s={};return t.forEach(r=>{r.prim&&Array.isArray(r.prim)&&r.prim.forEach(a=>{s[a]||(s[a]=[]),s[a].push(r)})}),Object.keys(s).sort().reduce((r,a)=>(r[a]=s[a],r),{})}function st(t,s,r,a,n,l,m=null){const o=s.find(f=>f.id==t);if(!o)return{advice:"error",suggestion:"Exercise not found",readiness:"unknown"};const i=r.filter(f=>f.id==t).sort((f,D)=>new Date(D.date)-new Date(f.date));if(i.length===0)return{advice:"first_time",suggestion:"Start conservative - focus on technique and find your working weight",readiness:"high",muscleReadiness:1,systemicReadiness:1};const N=i[0],x=i[1],S=o.prim||[],b=S.length>0?Math.min(...S.map(f=>a[f]||1)):1,h=ws(b,n,o,l,i);if(h.needed)return{advice:"deload",readiness:"deload",suggestion:h.suggestion,reason:h.reason,deloadProtocol:h.protocol,muscleReadiness:b,systemicReadiness:n};const d=Ns(N,x,o,i),g=Ss(i,b,l,o);return Es(d,g,b,n,o,N)}function ws(t,s,r,a,n){const l=J.DELOAD_THRESHOLD;if(s<.5)return{needed:!0,reason:"Critical systemic fatigue",suggestion:"Take 3-5 days off or do very light activity only",protocol:{action:"rest",duration:"3-5 days"}};if(s<l)return{needed:!0,reason:"Systemic fatigue is high",suggestion:"Reduce all training volume by 40-50%, increase RIR by 2-3, remove or lighten axial loads",protocol:{setReduction:.5,rirIncrease:2,weightReduction:r.axial?.3:.2,duration:"4-7 days"}};if(t<l)return{needed:!0,reason:"Target muscles need recovery",suggestion:"Reduce volume by 30-40% for this exercise, add 1-2 RIR, or take an extra rest day",protocol:{setReduction:.35,rirIncrease:1,weightMaintain:!0,duration:"1-2 sessions"}};if(n.length>=3&&t>.75&&n.slice(0,3).map(S=>!S.sets||S.sets.length===0?0:S.sets.reduce((b,h)=>b+h.w*h.r,0)).every((S,b,h)=>b===0||S<=h[b-1]))return{needed:!0,reason:"Performance declining despite adequate recovery - possible overtraining",suggestion:"Take a deload week to resensitize to training stimulus",protocol:{setReduction:.4,rirIncrease:2,weightReduction:.2,duration:"1 week"}};const m=r.prim||[];return(m.length>0?m.reduce((i,N)=>i+(a[N]||0),0)/m.length:0)>Ke.MAX_WEEKLY_STIMULUS?{needed:!0,reason:"Weekly volume is excessive for target muscles",suggestion:"Reduce total sets this week to allow adaptation",protocol:{setReduction:.3,rirIncrease:1,duration:"1 week"}}:{needed:!1}}function Ns(t,s,r,a){if(!t||!t.sets||t.sets.length===0)return{trend:"insufficient_data"};const n=t.sets,l=n.reduce((x,S)=>S.w*S.r>x.w*x.r?S:x,n[0]),m=n.reduce((x,S)=>x+S.rir,0)/n.length;let o="stable",i="stable";if(s&&s.sets&&s.sets.length>0){const x=s.sets.reduce((h,d)=>d.w*d.r>h.w*h.r?d:h,s.sets[0]),S=l.w*l.r,b=x.w*x.r;S>b*1.05?o="improved":S<b*.95&&(o="declined"),l.w>x.w*1.02?i="increasing":l.w<x.w*.98&&(i="decreasing")}let N="stable";if(a.length>=4){const S=a.slice(0,4).map(d=>{if(!d.sets||d.sets.length===0)return 0;const g=d.sets.reduce((f,D)=>D.w*D.r>f.w*f.r?D:f,d.sets[0]);return g.w*g.r}).reverse(),b=S.every((d,g,f)=>g===0||d>=f[g-1]*.95),h=S.every((d,g,f)=>g===0||d<=f[g-1]*1.05);b?N="increasing":h&&(N="decreasing")}return{trend:o,volumeTrend:i,longTermTrend:N,avgRir:m,topSet:l,setCount:n.length}}function Ss(t,s,r,a){if(t.length<3)return{stagnant:!1,message:"Insufficient history to detect stagnation"};const n=t.slice(0,4).map(o=>!o.sets||o.sets.length===0?0:o.sets.reduce((i,N)=>i+N.w*N.r,0)),l=n.reduce((o,i)=>o+i,0)/n.length;if(n.every(o=>Math.abs(o-l)<l*.15)&&s>.8){const o=a.prim||[];return(o.length>0?o.reduce((N,x)=>N+(r[x]||0),0)/o.length:0)<Ke.OPTIMAL_SETS_PER_WEEK?{stagnant:!0,message:"Volume has plateaued but you can handle more",recommendation:"add_volume"}:{stagnant:!0,message:"Performance has plateaued at current volume",recommendation:"increase_intensity"}}return{stagnant:!1,message:"Progressing normally"}}function Es(t,s,r,a,n,l,m){var b;const{trend:o,avgRir:i,topSet:N,longTermTrend:x}=t,S=J.PROGRESSION_THRESHOLD;if(r>=S&&a>=S){if(s.stagnant){if(s.recommendation==="add_volume")return{advice:"add_volume",readiness:"high",suggestion:"Add 1-2 sets to increase stimulus. Your recovery can handle more volume.",recommendedSets:(((b=l.sets)==null?void 0:b.length)||3)+1,muscleReadiness:r,systemicReadiness:a};if(i<=1){const h=Ze(n.type);return{advice:"progress",readiness:"high",suggestion:`Great work! Increase weight by ${h}lb. You're consistently close to failure.`,recommendedWeight:N.w+h,muscleReadiness:r,systemicReadiness:a}}else return{advice:"reduce_rir",readiness:"high",suggestion:"Push closer to failure (reduce RIR by 1-2) before adding weight",recommendedRirReduction:i>3?2:1,muscleReadiness:r,systemicReadiness:a}}if(i<=Ke.RIR_PROGRESSION_THRESHOLD){const h=Ze(n.type);return x==="increasing"?{advice:"progress",readiness:"high",suggestion:`Excellent progress! Increase weight by ${h}lb.`,recommendedWeight:N.w+h,reason:"Consistent performance improvement with low RIR",muscleReadiness:r,systemicReadiness:a}:{advice:"progress",readiness:"high",suggestion:`Time to progress. Increase weight by ${h}lb.`,recommendedWeight:N.w+h,muscleReadiness:r,systemicReadiness:a}}return i>=3?{advice:"push_harder",readiness:"high",suggestion:"You have room to push harder. Reduce RIR by 1-2 to maximize stimulus.",recommendedRirReduction:2,muscleReadiness:r,systemicReadiness:a}:{advice:"maintain",readiness:"high",suggestion:"Maintain current approach - you're in the optimal stimulus zone.",reason:"Good RIR range (2-3) with high readiness",muscleReadiness:r,systemicReadiness:a}}return r>=.65&&a>=.65?o==="declined"||x==="decreasing"?{advice:"reduce",readiness:"moderate",suggestion:"Performance is declining. Add 1 RIR and maintain weight to prioritize recovery.",reason:"Recent performance decline suggests accumulated fatigue",recommendedRirIncrease:1,muscleReadiness:r,systemicReadiness:a}:{advice:"maintain",readiness:"moderate",suggestion:"Maintain current load and focus on movement quality and technique.",reason:"Moderate readiness - prioritize quality over progression",muscleReadiness:r,systemicReadiness:a}:{advice:"reduce",readiness:"low",suggestion:"Add 1-2 RIR to reduce fatigue accumulation. Maintain technique focus.",reason:"Readiness is below optimal - reducing intensity prevents further fatigue accumulation",recommendedRirIncrease:r<.5?2:1,muscleReadiness:r,systemicReadiness:a}}function Rs({exercises:t,workouts:s,muscleReadiness:r,systemicReadiness:a,weeklyStimulus:n,activeProgram:l,currentDayIndex:m,getCurrentDay:o,onSessionComplete:i,onAutoSave:N,onSaveRecoveryOnly:x,onLoadProgramDay:S,useRestTimer:b,settings:h,theme:d}){var Xe,Je;const[g,f]=c.useState(He()),[D,w]=c.useState(null),[p,C]=c.useState(""),[$,U]=c.useState([]),[_,W]=c.useState({w:"",r:"",rir:""}),[j,O]=c.useState([]),[u,y]=c.useState(null),[A,B]=c.useState(!1),[Y,k]=c.useState(!1),[I,G]=c.useState(5),[z,Q]=c.useState({}),ne=c.useRef(null),se=b?b():null,ye=(h==null?void 0:h.restTimerEnabled)??!0;c.useEffect(()=>{const E=s.filter(M=>M.date===g);E.length>0?O(E):O([]),C(""),U([]),W({w:"",r:"",rir:""}),w(null)},[g,s]);const he=()=>{const E=new Date(g);E.setDate(E.getDate()-1),f(E.toISOString().split("T")[0])},Ne=()=>{const E=new Date(g);E.setDate(E.getDate()+1),f(E.toISOString().split("T")[0])},Se=()=>{f(He())},be=E=>{const M=new Date(E+"T00:00:00"),V=new Date(He()+"T00:00:00"),K=new Date(V);K.setDate(K.getDate()-1);const le=new Date(V);return le.setDate(le.getDate()+1),M.toDateString()===V.toDateString()?"Today":M.toDateString()===K.toDateString()?"Yesterday":M.toDateString()===le.toDateString()?"Tomorrow":M.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},ue=xt(t),ve=t.find(E=>E.id==p),Z=j.find(E=>E.id==p&&E.sets.length===0),F=Z&&Z.prescribedSets,P=p?st(p,t,s,r,a,n):null,L=p?s.filter(E=>E.id==p).sort((E,M)=>new Date(M.date)-new Date(E.date))[0]:null,v=E=>{C(E),U([]),W({w:"",r:"",rir:""}),y(null),B(!1),se&&se.stop();const M=s.filter(K=>K.id==E).sort((K,le)=>new Date(le.date)-new Date(K.date))[0],V=j.find(K=>K.id==E&&K.prescribedWeight);V&&V.prescribedWeight?W({w:V.prescribedWeight.toString(),r:"",rir:""}):M&&M.sets&&M.sets.length>0&&W({w:M.sets[0].w.toString(),r:"",rir:""})},T=()=>{C(""),U([]),W({w:"",r:"",rir:""}),B(!0)},R=()=>{if(!_.w||!_.r||_.rir===""){alert("Fill all fields");return}const E={w:parseFloat(_.w),r:parseInt(_.r),rir:parseInt(_.rir)};U([...$,E]),W({w:_.w,r:"",rir:""}),se&&ye&&se.start(h.defaultRestTime||120)},H=E=>{U($.filter((M,V)=>V!==E))},q=E=>{const M=$[E];y(E),W({w:M.w.toString(),r:M.r.toString(),rir:M.rir.toString()}),setTimeout(()=>{var V;(V=ne.current)==null||V.scrollIntoView({behavior:"smooth",block:"center"})},100)},ae=()=>{if(!_.w||!_.r||_.rir===""){alert("Fill all fields");return}const E=[...$];E[u]={w:parseFloat(_.w),r:parseInt(_.r),rir:parseInt(_.rir)},U(E),y(null),W({w:"",r:"",rir:""})},ge=()=>{y(null),W({w:"",r:"",rir:""})},Fe=async E=>{if(console.log("ðŸŸ¢ AUTO-SAVE SESSION CALLED"),console.log("  Updated session:",E),console.log("  Updated session length:",E.length),console.log("  Date:",g),E.length===0){console.log("  âš ï¸ Session is empty - skipping save");return}try{console.log("  â³ Calling onAutoSave..."),await N(E,g),console.log("  âœ… AUTO-SAVE COMPLETE")}catch(M){console.error("  âŒ Auto-save failed:",M)}},oe=async()=>{if(!p||$.length===0){alert("Select exercise and add sets");return}const E=t.find(K=>K.id==p);if(!E)return;j.length===0&&!D&&w(g);const M=j.findIndex(K=>K.id==p&&K.sets.length===0);let V;M!==-1?(V=[...j],V[M]={...V[M],sets:[...$]},O(V)):(V=[...j,{...E,sets:[...$],timestamp:Date.now()}],O(V)),await Fe(V),U([]),W({w:"",r:"",rir:""}),C(""),se&&se.stop()},me=(E,M)=>{const V=st(E.id,t,s,r,a,n),K=s.filter(Ce=>Ce.id==E.id);if(K.length===0)return{sets:M.sets,reps:M.reps,rir:M.rir,isAdapted:!1,progression:V};K.sort((Ce,Ie)=>new Date(Ie.date)-new Date(Ce.date))[0];let le=M.sets,xe=M.reps,je=M.rir,Te=null;switch(V.advice){case"progress":Te=V.recommendedWeight;break;case"push_harder":je=Math.max(0,M.rir-1);break;case"deload":le=Math.max(1,Math.ceil(M.sets*.5)),je=Math.min(5,M.rir+2);break;case"reduce":V.readiness==="low"?(je=Math.min(5,M.rir+1),le=Math.max(1,M.sets-1)):je=Math.min(5,M.rir+1);break}return{sets:le,reps:xe,rir:je,weight:Te,isAdapted:!0,progression:V,basePrescription:M}},Ee=()=>{const E=S();if(!E)return;const M=E.exercises.map(K=>{var je,Te,Ce;const le=t.find(Ie=>Ie.id===K.exId||Ie.id===K.id);if(!le)return console.warn("Exercise not found:",K),null;const xe=me(le,{sets:K.sets,reps:K.reps,rir:K.rir});return{...le,prescribedSets:xe.sets,prescribedReps:xe.reps,prescribedRir:xe.rir,prescribedWeight:xe.weight,basePrescribedSets:(je=xe.basePrescription)==null?void 0:je.sets,basePrescribedReps:(Te=xe.basePrescription)==null?void 0:Te.reps,basePrescribedRir:(Ce=xe.basePrescription)==null?void 0:Ce.rir,isAdapted:xe.isAdapted,sets:[],timestamp:Date.now()+Math.random()}}).filter(Boolean);if(M.length===0){alert("No valid exercises found in program day");return}O([...j,...M]),!p&&M.length>0&&v(M[0].id);const V=M.filter(K=>K.isAdapted).length;V>0?alert(`Loaded ${M.length} exercises from ${E.name}
${V} prescriptions adapted based on your progress and recovery`):alert(`Loaded ${M.length} exercises from ${E.name}`)},fe=E=>{O(j.filter(M=>M.timestamp!==E))},Re=async()=>{await i([],g,I,z),alert("Rest day complete. Enhanced recovery applied! ðŸ’ª")},De=async()=>{await x(g,I,z),G(5),Q({}),k(!1),alert("Recovery data saved! ðŸ“Š")},_e=async()=>{if(j.length===0){alert("Add exercises to session");return}await i(j,D||g,I,z),w(null),alert("Workout complete! Program advanced to next day. ðŸ’ª")};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Log Session"}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border-2 border-blue-200 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-blue-700",children:"Recording for:"}),e.jsxs("span",{className:"ml-2 font-bold text-blue-900",children:[be(D||g),D&&D!==g&&e.jsxs("span",{className:"ml-2 text-xs text-blue-600",children:["(Session started ",be(D),")"]})]})]}),D&&e.jsx("button",{onClick:()=>w(null),className:"text-xs text-blue-700 hover:text-blue-900 underline",children:"Unlock Date"})]}),l&&o&&((Xe=o())==null?void 0:Xe.isRestDay)&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"text-6xl mb-3",children:"ðŸ˜´"}),e.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-2",children:"Rest Day"}),e.jsxs("p",{className:"text-blue-700 mb-4",children:["Today is a scheduled rest day in your ",l.name," program."]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Recovery Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Systemic Readiness:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${a>.85?"bg-green-500":a>.65?"bg-yellow-500":"bg-red-500"}`,style:{width:`${a*100}%`}})}),e.jsxs("span",{className:"text-sm font-bold",children:[(a*100).toFixed(0),"%"]})]})]}),Object.entries(r).sort(([,E],[,M])=>E-M).slice(0,3).map(([E,M])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm",children:[E,":"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${M>.85?"bg-green-500":M>.65?"bg-yellow-500":"bg-red-500"}`,style:{width:`${M*100}%`}})}),e.jsxs("span",{className:"text-sm font-bold",children:[(M*100).toFixed(0),"%"]})]})]},E))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>{confirm("Mark this rest day as complete and advance to next day?")&&Re()},className:"w-full bg-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-blue-700",children:"âœ“ Complete Rest Day"}),e.jsx("button",{onClick:()=>{confirm("Are you sure you want to train on a scheduled rest day? This may impact recovery.")},className:"w-full bg-yellow-500 text-white py-3 rounded-lg font-semibold text-base hover:bg-yellow-600",children:"âš ï¸ Train Anyway (Not Recommended)"})]}),e.jsx("p",{className:"text-xs text-blue-600 text-center mt-4",children:"ðŸ’¡ Rest days help maximize muscle growth and prevent overtraining"})]})}),e.jsxs("div",{className:"mb-4 flex items-center justify-between bg-slate-100 rounded-lg p-2",children:[e.jsx("button",{onClick:he,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors","aria-label":"Previous day",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:Se,className:"px-4 py-2 font-semibold text-base hover:bg-slate-200 rounded-lg transition-colors",children:be(g)}),e.jsx("button",{onClick:Ne,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors","aria-label":"Next day",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("button",{onClick:()=>k(!Y),className:"w-full mb-4 py-3 px-4 bg-slate-100 rounded-lg text-base font-semibold hover:bg-slate-200 transition-colors",children:[Y?"Hide":"+ Log"," Fatigue & Soreness"]}),Y&&e.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg border-2",children:[e.jsx("h3",{className:"font-semibold mb-4 text-lg",children:"How do you feel today?"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-base font-medium mb-3",children:["Overall Fatigue: ",I,"/10"]}),e.jsx("input",{type:"range",min:"0",max:"10",value:I,onChange:E=>G(parseInt(E.target.value)),className:"w-full h-3"}),e.jsxs("div",{className:"flex justify-between text-sm text-slate-600 mt-2",children:[e.jsx("span",{children:"Energized"}),e.jsx("span",{children:"Neutral"}),e.jsx("span",{children:"Exhausted"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-base font-medium mb-3",children:"Muscle Soreness (0-10)"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:re.map(E=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-base w-20 font-medium",children:E}),e.jsx("input",{type:"number",min:"0",max:"10",value:z[E]||0,onChange:M=>Q({...z,[E]:parseInt(M.target.value)||0}),className:"flex-1 px-3 py-2 border rounded-lg text-base text-center"})]},E))})]}),e.jsx("button",{onClick:De,className:"w-full bg-blue-600 text-white py-3 rounded-lg text-base font-bold hover:bg-blue-700 transition-colors",children:"ðŸ’¾ Save Recovery Data (No Exercises)"}),e.jsx("p",{className:"text-xs text-slate-600 text-center mt-2",children:"Save how you feel without logging exercises"})]}),l&&e.jsx("div",{className:"mb-6 p-4 bg-purple-50 border-2 border-purple-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-purple-900 text-lg",children:l.name}),e.jsxs("div",{className:"text-base text-purple-700",children:["Day ",m+1," of ",l.days.length,":"," ",(Je=l.days[m])==null?void 0:Je.name]})]}),e.jsx("button",{onClick:Ee,className:"bg-purple-600 text-white px-5 py-3 rounded-lg text-base font-semibold whitespace-nowrap hover:bg-purple-700",children:"Load Day"})]})}),t.length===0?e.jsxs("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg p-6 text-center",children:[e.jsx("p",{className:"mb-4 text-lg",children:"No exercises in library"}),e.jsx("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg text-lg font-semibold",children:"Go to Exercises"})]}):e.jsxs(e.Fragment,{children:[!p&&!A&&e.jsx("button",{onClick:()=>B(!0),className:`w-full py-4 rounded-lg font-bold text-lg mb-4 text-white ${(d==null?void 0:d.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"+ Add Exercise"}),A&&!p&&e.jsxs("div",{className:"mb-4 p-4 border-2 rounded-lg bg-slate-50 animate-slideDown",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Select Exercise"}),e.jsx("button",{onClick:()=>B(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"Ã—"})]}),e.jsx(mt,{exercises:t,exercisesByMuscle:ue,onSelect:v,placeholder:"2ï¸âƒ£ Choose exercise..."})]}),ve&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`mb-4 p-4 rounded-lg border-2 ${(d==null?void 0:d.primary)||"bg-blue-600"} bg-opacity-10`,children:[e.jsx("div",{className:"text-sm font-semibold opacity-75 mb-1",children:"Currently Logging:"}),e.jsx("div",{className:"text-xl font-bold",children:ve.name})]}),P&&e.jsx(js,{progression:P,className:"mb-4"}),F&&Z&&e.jsxs("div",{className:"bg-purple-50 border-2 border-purple-200 rounded-lg p-4 mb-4",children:[e.jsx("div",{className:"text-base font-semibold text-purple-900 mb-1",children:Z.isAdapted?"Adapted Prescription":"Program Prescription"}),e.jsxs("div",{className:"text-sm text-purple-800 mb-2",children:[Z.prescribedSets," sets Ã—"," ",Z.prescribedReps," reps @ ",Z.prescribedRir," RIR",Z.prescribedWeight&&e.jsxs("span",{className:"font-semibold",children:[" Â· ",Z.prescribedWeight,"lb"]})]}),Z.isAdapted&&Z.basePrescribedSets&&e.jsxs("div",{className:"text-xs text-purple-600 pt-2 border-t border-purple-200",children:["Base program: ",Z.basePrescribedSets,"Ã—",Z.basePrescribedReps," @ ",Z.basePrescribedRir,"RIR",e.jsx("span",{className:"ml-2 italic",children:"(adjusted for recovery & progress)"})]})]}),L&&L.sets&&L.sets.length>0&&e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"text-base font-semibold text-blue-900 mb-1",children:["Last Performance (",new Date(L.date).toLocaleDateString(),")"]}),e.jsx("div",{className:"text-sm text-blue-800",children:L.sets.map((E,M)=>e.jsxs("span",{children:[M>0&&", ",E.w,"lb Ã— ",E.r," @ ",E.rir,"RIR"]},M))})]}),ye&&se&&se.isActive&&se.timeRemaining>0&&e.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-6 text-center mb-4",children:[e.jsx("div",{className:"text-base font-semibold text-green-900 mb-2",children:"Rest Timer"}),e.jsx("div",{className:"text-5xl font-bold text-green-700",children:se.formattedTime})]}),$.length>0&&e.jsx("div",{className:"bg-slate-50 p-4 rounded-lg mb-4 border-2 stagger-children",children:$.map((E,M)=>u===M?e.jsx("div",{className:"border-2 border-blue-300 rounded p-2 mb-2",children:e.jsx(tt,{weight:_.w,reps:_.r,rir:_.rir,onWeightChange:V=>W({..._,w:V}),onRepsChange:V=>W({..._,r:V}),onRirChange:V=>W({..._,rir:V}),onSubmit:ae,onCancel:ge,submitLabel:"Save",showCancel:!0})},M):e.jsxs("div",{className:"flex justify-between items-center text-base mb-2 py-2 border-b last:border-b-0",children:[e.jsxs("span",{className:"font-semibold",children:["Set ",M+1,": ",E.w,"lb Ã— ",E.r," @ ",E.rir,"RIR"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>q(M),className:"text-blue-500 text-lg",children:"âœï¸"}),e.jsx("button",{onClick:()=>H(M),className:"text-red-500 text-2xl px-2",children:"Ã—"})]})]},M))}),u===null&&e.jsx("div",{ref:ne,children:e.jsx(tt,{weight:_.w,reps:_.r,rir:_.rir,onWeightChange:E=>W({..._,w:E}),onRepsChange:E=>W({..._,r:E}),onRirChange:E=>W({..._,rir:E}),onSubmit:R,autoFocusReps:$.length>0})}),$.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:oe,className:"w-full bg-green-600 text-white py-4 rounded-lg font-bold text-lg mt-3 hover:bg-green-700 btn-press",children:"âœ“ Finish Exercise"}),e.jsx("button",{onClick:T,className:"w-full bg-gray-400 text-white py-3 rounded-lg font-semibold text-base mt-2 hover:bg-gray-500 btn-press",children:"Change Exercise"})]})]})]}),j.length>0&&e.jsxs("div",{className:"mt-8 border-t-2 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Session (",j.length,")"]}),e.jsx("button",{onClick:_e,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-bold text-lg hover:bg-blue-700 btn-press",children:"Finish"})]}),e.jsx("div",{className:"stagger-children space-y-3",children:j.map((E,M)=>e.jsxs("div",{className:`border-2 p-4 rounded-lg transition-all ${E.id===p&&E.sets.length===0?"bg-blue-50 border-blue-400 shadow-md":E.sets.length===0?"bg-yellow-50 border-yellow-300":"bg-slate-50 border-slate-200"} card-hover`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-lg flex items-center gap-2",children:[E.name,E.id===p&&E.sets.length===0&&e.jsx("span",{className:"text-xs bg-blue-500 text-white px-2 py-1 rounded",children:"â† Logging"}),E.sets.length===0&&e.jsx("span",{className:"text-xs bg-yellow-500 text-white px-2 py-1 rounded",children:"Incomplete"})]}),E.prescribedSets&&e.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:["Target: ",E.prescribedSets,"Ã—",E.prescribedReps," @ ",E.prescribedRir,"RIR",E.prescribedWeight&&` Â· ${E.prescribedWeight}lb`,E.isAdapted&&e.jsx("span",{className:"ml-1 bg-purple-100 px-1 rounded text-purple-700",children:"adapted"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[E.sets.length===0&&E.id!==p&&e.jsx("button",{onClick:()=>v(E.id),className:"bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600",children:"Log Sets"}),e.jsx("button",{onClick:()=>{confirm(`Remove ${E.name} from session?`)&&fe(E.timestamp)},className:"text-red-500 text-xl",children:"Ã—"})]})]}),E.sets.length>0?E.sets.map((V,K)=>e.jsxs("div",{className:"text-sm py-1",children:["Set ",K+1,": ",V.w,"lb Ã— ",V.r," @ ",V.rir,"RIR"]},K)):e.jsx("div",{className:"text-sm text-slate-500 italic",children:"No sets logged yet"})]},M))})]})]})}function Ds({workouts:t,readinessHistory:s=[],onUpdateWorkout:r,onDeleteWorkout:a,theme:n}){const[l,m]=c.useState(null),[o,i]=c.useState(new Date),[N,x]=c.useState(null),[S,b]=c.useState([]);console.log("ðŸ“Š HistoryView readinessHistory:",s);const h=Xt(o),d={};t.forEach(j=>{d[j.date]||(d[j.date]=[]),d[j.date].push(j)});const g=Ye(new Date),f=()=>{const j=new Date(o);j.setMonth(o.getMonth()-1),i(j)},D=()=>{const j=new Date(o);j.setMonth(o.getMonth()+1),i(j)},w=()=>{i(new Date)},p=j=>{x(j.timestamp),b([...j.sets])},C=()=>{x(null),b([])},$=j=>{const O={...j,sets:S};r(O),x(null),b([])},U=(j,O,u)=>{const y=[...S];y[j]={...y[j],[O]:O==="rir"?parseInt(u):parseFloat(u)},b(y)},_=j=>{b(S.filter((O,u)=>u!==j))},W=()=>{const j=S[S.length-1];b([...S,{w:(j==null?void 0:j.w)||0,r:(j==null?void 0:j.r)||0,rir:(j==null?void 0:j.rir)||0}])};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6",children:"History"}),t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“Š"}),e.jsx("p",{className:"text-slate-500 text-lg mb-4",children:"No workout history yet"}),e.jsx("p",{className:"text-slate-400",children:"Complete your first workout to see it here"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-semibold text-xl",children:o.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:f,className:"px-3 py-2 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:"â†"}),e.jsx("button",{onClick:w,className:`px-4 py-2 rounded-lg font-semibold text-sm ${(n==null?void 0:n.light)||"bg-blue-100"} ${(n==null?void 0:n.accent)||"text-blue-700"} hover:opacity-80 transition-opacity`,children:"Today"}),e.jsx("button",{onClick:D,className:"px-3 py-2 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:"â†’"})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 sm:gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(j=>e.jsx("div",{className:"text-center font-semibold text-xs sm:text-sm py-2 text-slate-600",children:j},j)),h.map((j,O)=>{if(!j)return e.jsx("div",{},O);const u=Ye(j),y=d[u]||[],A=s.find(G=>G.date===u),B=A&&(A.perceivedFatigue!==void 0||A.muscleSoreness&&Object.keys(A.muscleSoreness).length>0),Y=y.length>0||B,k=u===g,I=u===l;return e.jsxs("button",{onClick:()=>Y&&m(u),className:`aspect-square rounded-lg flex flex-col items-center justify-center text-sm sm:text-base transition-all ${Y?y.length>0?"bg-green-100 hover:bg-green-200 cursor-pointer font-semibold border-2 border-green-300":"bg-blue-100 hover:bg-blue-200 cursor-pointer font-semibold border-2 border-blue-300":"bg-slate-50 border-2 border-slate-200"} ${k?`ring-2 ${(n==null?void 0:n.primary.split(" ")[0].replace("bg-","ring-"))||"ring-blue-500"}`:""} ${I?"ring-2 ring-purple-500":""}`,children:[e.jsx("span",{children:j.getDate()}),y.length>0?e.jsx("span",{className:"text-xs text-green-700 font-bold",children:y.length}):B?e.jsx("span",{className:"text-xs text-blue-700 font-bold",children:"ðŸ“Š"}):null]},O)})]})]}),l&&(d[l]||s.find(j=>j.date===l))&&e.jsxs("div",{className:"border-t-2 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold",children:Kt(l)}),e.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 bg-slate-200 rounded-lg text-sm font-semibold hover:bg-slate-300 transition-colors",children:"Close"})]}),d[l]&&d[l].length>0&&e.jsx("div",{className:"space-y-4 stagger-children",children:d[l].map((j,O)=>e.jsxs("div",{className:"border-2 p-5 rounded-lg bg-slate-50 card-hover",children:[e.jsxs("div",{className:"font-bold text-lg mb-3 flex justify-between items-start",children:[e.jsx("span",{children:j.name}),e.jsx("div",{className:"flex flex-wrap gap-1",children:j.prim&&j.prim.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:j.prim.map(u=>e.jsx("span",{className:`text-xs px-2 py-1 rounded font-semibold ${(n==null?void 0:n.light)||"bg-blue-100"} ${(n==null?void 0:n.accent)||"text-blue-700"}`,children:u},u))})})]}),j.sets&&j.sets.length>0?N===j.timestamp?e.jsxs("div",{children:[e.jsx("div",{className:"space-y-2 mb-4",children:S.map((u,y)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("span",{className:"text-sm font-semibold w-12",children:["Set ",y+1,":"]}),e.jsx("input",{type:"number",step:"0.5",value:u.w,onChange:A=>U(y,"w",A.target.value),className:"w-20 px-2 py-1 border-2 rounded text-center",placeholder:"lbs"}),e.jsx("span",{className:"text-sm",children:"Ã—"}),e.jsx("input",{type:"number",value:u.r,onChange:A=>U(y,"r",A.target.value),className:"w-16 px-2 py-1 border-2 rounded text-center",placeholder:"reps"}),e.jsx("span",{className:"text-sm",children:"@"}),e.jsx("input",{type:"number",value:u.rir,onChange:A=>U(y,"rir",A.target.value),className:"w-16 px-2 py-1 border-2 rounded text-center",placeholder:"RIR"}),e.jsx("button",{onClick:()=>_(y),className:"text-red-500 hover:text-red-700 px-2",children:"Ã—"})]},y))}),e.jsx("div",{className:"flex gap-2 mb-3",children:e.jsx("button",{onClick:W,className:`flex-1 text-white py-2 rounded text-sm ${(n==null?void 0:n.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"+ Add Set"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>$(j),className:"flex-1 bg-green-600 text-white py-2 rounded font-semibold hover:bg-green-700",children:"âœ“ Save Changes"}),e.jsx("button",{onClick:C,className:"flex-1 bg-gray-400 text-white py-2 rounded font-semibold hover:bg-gray-500",children:"Cancel"})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:"space-y-1 mb-3",children:j.sets.map((u,y)=>e.jsxs("div",{className:"text-base text-slate-700 py-1",children:["Set ",y+1,":"," ",e.jsxs("span",{className:"font-semibold",children:[u.w,"lb Ã— ",u.r]})," ","@ ",u.rir,"RIR"]},y))}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-slate-300",children:[e.jsx("button",{onClick:()=>p(j),className:`flex-1 text-white py-2 rounded font-semibold ${(n==null?void 0:n.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"âœï¸ Edit"}),e.jsx("button",{onClick:()=>{confirm(`Delete ${j.name}?`)&&a(j.timestamp)},className:"flex-1 bg-red-600 text-white py-2 rounded font-semibold hover:bg-red-700",children:"ðŸ—‘ï¸ Delete"})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-300",children:[e.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[e.jsx("span",{children:"Total Volume:"}),e.jsxs("span",{className:"font-semibold",children:[j.sets.reduce((u,y)=>u+y.w*y.r,0).toLocaleString()," ","lbs"]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[e.jsx("span",{children:"Total Sets:"}),e.jsx("span",{className:"font-semibold",children:j.sets.length})]})]})]}):e.jsx("p",{className:"text-slate-500 italic",children:"No set data"})]},O))}),d[l]&&d[l].length>0&&e.jsxs("div",{className:`border-2 rounded-lg p-4 mt-4 ${(n==null?void 0:n.light)||"bg-blue-50 border-blue-200"}`,children:[e.jsx("div",{className:`font-semibold mb-2 ${(n==null?void 0:n.text)||"text-blue-900"}`,children:"Day Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Total Exercises"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:d[l].length})]}),e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Total Sets"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:d[l].reduce((j,O)=>{var u;return j+(((u=O.sets)==null?void 0:u.length)||0)},0)})]}),e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Total Volume"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:d[l].reduce((j,O)=>{var u;return j+(((u=O.sets)==null?void 0:u.reduce((y,A)=>y+A.w*A.r,0))||0)},0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Muscles Trained"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:new Set(d[l].flatMap(j=>j.prim||[])).size})]})]})]}),(()=>{console.log("ðŸ” Looking for recovery data for date:",l),console.log("  Available readinessHistory:",s);const j=s.find(u=>u.date===l);if(console.log("  Found recovery data:",j),!j||!j.perceivedFatigue&&!j.muscleSoreness)return console.log("  âŒ No recovery data to display"),null;const O=j.muscleSoreness&&Object.values(j.muscleSoreness).some(u=>u>0);return console.log("  âœ… Displaying recovery data"),e.jsxs("div",{className:"mt-4 p-5 bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:[e.jsxs("h4",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ“Š"}),"Recovery Data"]}),j.perceivedFatigue!==void 0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Overall Fatigue:"}),e.jsxs("span",{className:"text-lg font-bold",children:[j.perceivedFatigue,"/10"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${j.perceivedFatigue<=3?"bg-green-500":j.perceivedFatigue<=6?"bg-yellow-500":j.perceivedFatigue<=8?"bg-orange-500":"bg-red-500"}`,style:{width:`${j.perceivedFatigue*10}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mt-1",children:[e.jsx("span",{children:"Energized"}),e.jsx("span",{children:"Exhausted"})]})]}),O&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-3",children:"Muscle Soreness:"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(j.muscleSoreness).filter(([u,y])=>y>0).sort((u,y)=>y[1]-u[1]).map(([u,y])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium w-20",children:[u,":"]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-2 rounded-full ${y<=3?"bg-green-500":y<=6?"bg-yellow-500":y<=8?"bg-orange-500":"bg-red-500"}`,style:{width:`${y*10}%`}})}),e.jsx("span",{className:"text-sm font-bold w-8 text-right",children:y})]},u))})]})]})})()]}),!l&&e.jsxs("div",{className:"mt-8 pt-8 border-t-2",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"All-Time Stats"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 stagger-children",children:[e.jsxs("div",{className:`rounded-lg p-4 border-2 bg-gradient-to-br card-hover ${(n==null?void 0:n.light)||"from-blue-50 to-blue-100 border-blue-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 ${(n==null?void 0:n.accent)||"text-blue-700"}`,children:"Total Workouts"}),e.jsx("div",{className:`text-3xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:new Set(t.map(j=>j.date)).size})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border-2 border-green-200 card-hover",children:[e.jsx("div",{className:"text-sm text-green-700 mb-1",children:"Total Sets"}),e.jsx("div",{className:"text-3xl font-bold text-green-900",children:t.reduce((j,O)=>{var u;return j+(((u=O.sets)==null?void 0:u.length)||0)},0)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 border-2 border-purple-200 card-hover",children:[e.jsx("div",{className:"text-sm text-purple-700 mb-1",children:"Total Volume"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-900",children:[(t.reduce((j,O)=>{var u;return j+(((u=O.sets)==null?void 0:u.reduce((y,A)=>y+A.w*A.r,0))||0)},0)/1e3).toFixed(1),"k"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 border-2 border-orange-200 card-hover",children:[e.jsx("div",{className:"text-sm text-orange-700 mb-1",children:"Exercises"}),e.jsx("div",{className:"text-3xl font-bold text-orange-900",children:new Set(t.map(j=>j.id)).size})]})]})]})]})]})}function Cs({systemicReadiness:t,muscleReadiness:s,weeklyStimulus:r,weeklySummary:a,theme:n}){const l=i=>i>=.85?"bg-green-500":i>=.65?"bg-yellow-500":i>=.5?"bg-orange-500":"bg-red-500",m=Object.values(s).reduce((i,N)=>i+N,0)/re.length,o=Object.values(r).reduce((i,N)=>i+N,0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"p-5 bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Systemic Readiness"}),e.jsxs("div",{className:"text-4xl font-bold mb-3 text-blue-700",children:[(t*100).toFixed(0),"%"]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${l(t)}`,style:{width:`${t*100}%`}})})]}),e.jsxs("div",{className:"p-5 bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-semibold text-green-900 mb-2",children:"Avg Muscle Readiness"}),e.jsxs("div",{className:"text-4xl font-bold text-green-700 mb-3",children:[(m*100).toFixed(0),"%"]}),e.jsx("div",{className:"flex gap-1",children:re.slice(0,10).map(i=>e.jsx("div",{className:"flex-1 h-3 rounded",style:{backgroundColor:s[i]>=.85?"#22c55e":s[i]>=.65?"#eab308":s[i]>=.5?"#f97316":"#ef4444"},title:`${i}: ${(s[i]*100).toFixed(0)}%`},i))})]}),e.jsxs("div",{className:"p-5 bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-semibold text-purple-900 mb-2",children:"Total Weekly Stimulus"}),e.jsx("div",{className:"text-4xl font-bold text-purple-700 mb-3",children:o.toFixed(1)}),e.jsx("div",{className:"text-sm text-purple-700",children:"sets equivalent across all muscles"})]})]}),e.jsxs("div",{className:"mb-8 p-5 bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-200 rounded-lg",children:[e.jsx("h2",{className:"font-bold text-xl mb-4",children:"This Week's Progress"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-700",children:a.workouts}),e.jsx("div",{className:"text-sm text-slate-600",children:"Workouts"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-3xl font-bold ${(n==null?void 0:n.accent)||"text-blue-700"}`,children:a.totalSets}),e.jsx("div",{className:"text-sm text-slate-600",children:"Total Sets"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-700",children:a.musclesWorked.length}),e.jsx("div",{className:"text-sm text-slate-600",children:"Muscles Hit"})]})]})]})]})}function ks({chartData:t,chartType:s,metricView:r,metricInfo:a,trend:n,timeframe:l,selectedMuscle:m,theme:o,onMetricChange:i,onTimeframeChange:N,onMuscleChange:x,onChartTypeChange:S}){const b=Math.max(...t.map(g=>g.value),1),h=Math.min(...t.map(g=>g.value),0),d=b-h||1;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6 p-5 bg-slate-50 rounded-lg border-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Metric"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["volume","fatigue","stimulus","efficiency"].map(g=>e.jsx("button",{onClick:()=>i(g),className:`px-3 py-2 rounded-lg text-xs font-semibold transition-all ${r===g?`${(o==null?void 0:o.primary)||"bg-blue-600"} text-white shadow-md`:"bg-white hover:bg-slate-100 border-2"}`,children:g.charAt(0).toUpperCase()+g.slice(1)},g))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Timeframe"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[4,8,12,16].map(g=>e.jsxs("button",{onClick:()=>N(g),className:`px-3 py-2 rounded-lg text-sm font-semibold transition-all ${l===g?`${(o==null?void 0:o.primary)||"bg-blue-600"} text-white shadow-md`:"bg-white hover:bg-slate-100 border-2"}`,children:[g,"w"]},g))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Muscle Group"}),e.jsxs("select",{value:m,onChange:g=>x(g.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-sm font-medium bg-white",children:[e.jsx("option",{value:"all",children:"All Muscles"}),re.map(g=>e.jsx("option",{value:g,children:g},g))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Chart Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["line","bar"].map(g=>e.jsx("button",{onClick:()=>S(g),className:`px-3 py-2 rounded-lg text-sm font-semibold transition-all ${s===g?`${(o==null?void 0:o.primary)||"bg-blue-600"} text-white shadow-md`:"bg-white hover:bg-slate-100 border-2"}`,children:g.charAt(0).toUpperCase()+g.slice(1)},g))})]})]})}),e.jsx("div",{className:`mb-6 p-4 bg-gradient-to-r ${(o==null?void 0:o.light)||"from-slate-50 to-blue-50"} border-2 ${(o==null?void 0:o.primary.split(" ")[0].replace("bg-","border-"))||"border-blue-200"} rounded-lg`,children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-lg",style:{color:a.color},children:a.label}),e.jsx("div",{className:"text-sm text-slate-600",children:a.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Trend"}),e.jsxs("div",{className:`text-lg font-bold ${n.direction==="increasing"?"text-green-600":n.direction==="decreasing"?"text-red-600":"text-slate-600"}`,children:[n.direction==="increasing"?"â†—":n.direction==="decreasing"?"â†˜":"â†’"," ",Math.abs(parseFloat(n.change)),"%"]})]})]})}),e.jsx("div",{className:"mb-8 p-5 bg-white border-2 rounded-lg shadow-sm",children:t.length>0&&t.some(g=>g.value>0)?e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute left-0 top-0 bottom-8 w-16 flex flex-col justify-between text-xs text-slate-600 text-right pr-2",children:[e.jsx("span",{children:b.toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:(b*.75).toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:(b*.5).toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:(b*.25).toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:h.toLocaleString(void 0,{maximumFractionDigits:1})})]}),e.jsxs("div",{className:"ml-20 mr-4",children:[e.jsxs("svg",{viewBox:"0 0 500 250",className:"w-full",style:{height:"250px"},children:[[0,.25,.5,.75,1].map((g,f)=>e.jsx("line",{x1:"0",y1:250-g*250,x2:"500",y2:250-g*250,stroke:"#e2e8f0",strokeWidth:"1"},f)),s==="line"?e.jsxs(e.Fragment,{children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"areaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:a.color,stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:a.color,stopOpacity:"0.05"})]})}),e.jsx("polygon",{points:["0,250",...t.map((g,f)=>{const D=t.length>1?f/(t.length-1)*500:250,w=250-(g.value-h)/d*250;return`${D},${w}`}),`${t.length>1?500:250},250`].join(" "),fill:"url(#areaGradient)"}),t.length>1&&e.jsx("polyline",{points:t.map((g,f)=>{const D=f/(t.length-1)*500,w=250-(g.value-h)/d*250;return`${D},${w}`}).join(" "),fill:"none",stroke:a.color,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),t.map((g,f)=>{const D=t.length>1?f/(t.length-1)*500:250,w=250-(g.value-h)/d*250;return e.jsxs("g",{children:[e.jsx("circle",{cx:D,cy:w,r:"6",fill:"white",stroke:a.color,strokeWidth:"3"}),e.jsxs("title",{children:[g.week,": ",g.value.toLocaleString(void 0,{maximumFractionDigits:1})," ",a.unit]})]},f)})]}):t.map((g,f)=>{const D=500/t.length*.8,w=f/t.length*500+500/t.length*.1,p=(g.value-h)/d*250,C=250-p;return e.jsxs("g",{children:[e.jsx("rect",{x:w,y:C,width:D,height:p,fill:a.color,opacity:"0.8",rx:"3"}),e.jsxs("title",{children:[g.week,": ",g.value.toLocaleString(void 0,{maximumFractionDigits:1})," ",a.unit]})]},f)})]}),e.jsx("div",{className:"flex justify-between mt-2 text-xs text-slate-600",children:t.map((g,f)=>{const D=f===0||f===t.length-1||t.length>8&&f%Math.floor(t.length/4)===0;return e.jsx("span",{className:D?"":"invisible",children:g.week},f)})})]})]}):e.jsx("p",{className:"text-slate-500 text-center py-8",children:m==="all"?"Complete more workouts to see trends":`No ${m} data in this timeframe`})})]})}function Fs({muscleReadiness:t,weeklyStimulus:s,selectedMuscle:r,onMuscleSelect:a,theme:n}){const l=m=>m>=.85?"bg-green-500":m>=.65?"bg-yellow-500":m>=.5?"bg-orange-500":"bg-red-500";return e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"font-bold text-xl mb-4",children:"Muscle Readiness Breakdown"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:re.map(m=>{const o=t[m]||1,i=s[m]||0;return e.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all cursor-pointer hover:shadow-md ${r===m?`${(n==null?void 0:n.primary.split(" ")[0].replace("bg-","border-"))||"border-blue-500"} ${(n==null?void 0:n.light)||"bg-blue-50"} shadow-md`:"border-slate-200 hover:border-slate-300"}`,onClick:()=>a(m===r?"all":m),children:[e.jsx("div",{className:"text-sm font-semibold mb-2 text-slate-700",children:m}),e.jsxs("div",{className:"text-2xl font-bold mb-2",children:[(o*100).toFixed(0),"%"]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2 overflow-hidden mb-2",children:e.jsx("div",{className:`h-full transition-all ${l(o)}`,style:{width:`${o*100}%`}})}),e.jsxs("div",{className:"text-xs text-slate-600",children:[i.toFixed(1)," sets/wk"]})]},m)})})]})}function Ts({muscleReadiness:t,systemicReadiness:s,trend:r,lastWorkoutDate:a,theme:n}){var l,m;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"p-5 bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-green-900",children:"ðŸ’ª Recovery Recommendations"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[Object.entries(t).filter(([o,i])=>i<.65).sort((o,i)=>o[1]-i[1]).slice(0,3).map(([o,i])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"âš ï¸"}),e.jsxs("span",{className:"font-medium text-slate-800",children:[o,":"]}),e.jsx("span",{className:"text-slate-700",children:i<.5?"Needs deload":"Reduce volume 20-30%"})]},o)),Object.entries(t).every(([o,i])=>i>=.65)&&e.jsx("div",{className:"text-green-700 font-medium",children:"âœ“ All muscle groups adequately recovered"})]})]}),e.jsxs("div",{className:"p-5 bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-blue-900",children:"ðŸ“Š Training Insights"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-700",children:"Volume trend:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:r.direction})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-700",children:"Most recovered:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:((l=Object.entries(t).sort((o,i)=>i[1]-o[1])[0])==null?void 0:l[0])||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-700",children:"Needs attention:"}),e.jsx("span",{className:"font-semibold text-orange-600",children:((m=Object.entries(t).sort((o,i)=>o[1]-i[1])[0])==null?void 0:m[0])||"N/A"})]})]})]})]}),a&&e.jsxs("div",{className:"p-4 bg-slate-50 border-2 border-slate-200 rounded-lg mb-6",children:[e.jsxs("p",{className:"text-base text-slate-900",children:[e.jsx("strong",{children:"Last workout:"})," ",new Date(a).toLocaleDateString()]}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:"Recovery is calculated automatically based on time since last session"})]}),e.jsxs("div",{className:"p-5 border-2 border-slate-300 bg-white rounded-lg shadow-sm",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-slate-900",children:"Readiness Guide"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:">85%:"})," Ready to progress"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:"65-85%:"})," Maintain current load"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:"50-65%:"})," Reduce intensity"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:"<50%:"})," Deload needed"]})]})]})]})]})}function As({workouts:t,readinessHistory:s,stimulusHistory:r,weeklyStimulus:a,localFatigue:n,timeframe:l,selectedMuscle:m,metricView:o,theme:i}){const N=c.useMemo(()=>{const h=[],d=new Date;for(let g=l-1;g>=0;g--){const f=new Date(d);f.setDate(d.getDate()-g*7);const D=new Date(f);D.setDate(f.getDate()+7);const w={week:g===0?"This week":`${g}w ago`,weekLabel:f.toLocaleDateString("en-US",{month:"short",day:"numeric"}),date:f.toISOString().split("T")[0],volume:{},fatigue:{},stimulus:{},efficiency:{}},p=t.filter(C=>{const $=new Date(C.date);return $>=f&&$<D});re.forEach(C=>{let $=0;p.forEach(O=>{const u=(O.sets||[]).reduce((y,A)=>y+A.w*A.r,0);O.prim&&O.prim.includes(C)&&($+=u*1),O.sec&&O.sec.includes(C)&&($+=u*.6),O.ter&&O.ter.includes(C)&&($+=u*.3)}),w.volume[C]=$;const U=s.find(O=>{const u=new Date(O.date);return u>=f&&u<D});U&&U.muscleFatigue?w.fatigue[C]=U.muscleFatigue[C]||0:g===0?w.fatigue[C]=n[C]||0:w.fatigue[C]=0;const _=r.find(O=>{const u=new Date(O.date);return u>=f&&u<D});_&&_.stimulus?w.stimulus[C]=_.stimulus[C]||0:g===0?w.stimulus[C]=a[C]||0:w.stimulus[C]=0;const W=w.fatigue[C]||.001,j=w.stimulus[C]||0;w.efficiency[C]=W>0?j/W:0}),h.push(w)}return h},[t,s,r,a,n,l]),x=c.useMemo(()=>N.map(h=>{let d=0;return m==="all"?(d=re.map(f=>h[o][f]||0).reduce((f,D)=>f+D,0),o==="efficiency"&&(d=d/re.length)):d=h[o][m]||0,{week:h.week,weekLabel:h.weekLabel,value:d}}),[N,m,o]),S=c.useMemo(()=>{if(x.length<2)return{direction:"stable",change:0};const h=x.slice(0,Math.floor(x.length/2)),d=x.slice(Math.floor(x.length/2)),g=h.reduce((p,C)=>p+C.value,0)/h.length,f=d.reduce((p,C)=>p+C.value,0)/d.length,D=g>0?(f-g)/g*100:0;return{direction:D>5?"increasing":D<-5?"decreasing":"stable",change:D.toFixed(1)}},[x]),b=c.useMemo(()=>({volume:{label:"Volume (lbs)",color:i!=null&&i.primary.includes("blue")?"#2563eb":i!=null&&i.primary.includes("green")?"#16a34a":i!=null&&i.primary.includes("purple")?"#9333ea":i!=null&&i.primary.includes("orange")?"#ea580c":i!=null&&i.primary.includes("red")?"#dc2626":i!=null&&i.primary.includes("indigo")?"#4f46e5":i!=null&&i.primary.includes("pink")?"#db2777":i!=null&&i.primary.includes("teal")?"#0d9488":"#2563eb",unit:"lbs",description:"Total weight Ã— reps lifted"},fatigue:{label:"Fatigue Index",color:"#dc2626",unit:"",description:"Accumulated fatigue (logarithmic scale)"},stimulus:{label:"Stimulus (sets)",color:"#16a34a",unit:"sets",description:"Effective training volume"},efficiency:{label:"Stimulus:Fatigue Ratio",color:"#9333ea",unit:"",description:"Training efficiency (higher is better)"}})[o],[o,i]);return{historicalData:N,chartData:x,trend:S,metricInfo:b}}function Ls({muscleReadiness:t,systemicReadiness:s,weeklyStimulus:r,localFatigue:a,lastWorkoutDate:n,workouts:l,stimulusHistory:m=[],readinessHistory:o=[],theme:i}){const[N,x]=c.useState(8),[S,b]=c.useState("all"),[h,d]=c.useState("volume"),[g,f]=c.useState("line"),D=es(l),{chartData:w,trend:p,metricInfo:C}=As({workouts:l,readinessHistory:o,stimulusHistory:m,weeklyStimulus:r,localFatigue:a,timeframe:N,selectedMuscle:S,metricView:h,theme:i});return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Recovery & Training Analytics"}),e.jsx(Cs,{systemicReadiness:s,muscleReadiness:t,weeklyStimulus:r,weeklySummary:D,theme:i}),e.jsx(ks,{chartData:w,chartType:g,metricView:h,metricInfo:C,trend:p,timeframe:N,selectedMuscle:S,theme:i,onMetricChange:d,onTimeframeChange:x,onMuscleChange:b,onChartTypeChange:f}),e.jsx(Fs,{muscleReadiness:t,weeklyStimulus:r,selectedMuscle:S,onMuscleSelect:b,theme:i}),e.jsx(Ts,{muscleReadiness:t,systemicReadiness:s,trend:p,lastWorkoutDate:n,theme:i})]})}function Ps({exercises:t,onAddExercise:s,onUpdateExercise:r,onDeleteExercise:a,onResetToPresets:n,theme:l}){const[m,o]=c.useState(""),[i,N]=c.useState("compound_upper"),[x,S]=c.useState(!1),[b,h]=c.useState([]),[d,g]=c.useState([]),[f,D]=c.useState([]),[w,p]=c.useState(!1),[C,$]=c.useState(null),[U,_]=c.useState(""),W=c.useRef(null),j=(k,I)=>{I==="primary"?(h(G=>G.includes(k)?G.filter(z=>z!==k):[...G,k]),g(G=>G.filter(z=>z!==k)),D(G=>G.filter(z=>z!==k))):I==="secondary"?(g(G=>G.includes(k)?G.filter(z=>z!==k):[...G,k]),h(G=>G.filter(z=>z!==k)),D(G=>G.filter(z=>z!==k))):I==="tertiary"&&(D(G=>G.includes(k)?G.filter(z=>z!==k):[...G,k]),h(G=>G.filter(z=>z!==k)),g(G=>G.filter(z=>z!==k)))},O=async()=>{if(!m||b.length===0){alert("Enter name and select primary muscles");return}await s({name:m,type:i,axial:x,prim:b,sec:d,ter:f}),B()},u=k=>{var I,G;$(k.id),o(k.name),N(k.type),S(k.axial),h(k.prim||[]),g(k.sec||[]),D(k.ter||[]),p(((I=k.sec)==null?void 0:I.length)>0||((G=k.ter)==null?void 0:G.length)>0),setTimeout(()=>{var z;(z=W.current)==null||z.scrollIntoView({behavior:"smooth",block:"start"})},100)},y=async()=>{if(!m||b.length===0){alert("Enter name and select primary muscles");return}await r(C,{name:m,type:i,axial:x,prim:b,sec:d,ter:f}),B()},A=()=>{B()},B=()=>{$(null),o(""),N("compound_upper"),S(!1),h([]),g([]),D([]),p(!1)},Y=t.filter(k=>k.name.toLowerCase().includes(U.toLowerCase()));return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Exercise Library"}),e.jsxs("div",{ref:W,className:"space-y-3 mb-6 pb-6 border-b",children:[e.jsx("input",{type:"text",value:m,onChange:k=>o(k.target.value),placeholder:"Exercise name",className:"w-full px-3 py-2 border rounded"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("select",{value:i,onChange:k=>N(k.target.value),className:"px-3 py-2 border rounded",children:Object.entries(gt).map(([k,I])=>e.jsx("option",{value:k,children:I.name},k))}),e.jsxs("label",{className:"flex items-center gap-2 border rounded px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:k=>S(k.target.checked)}),e.jsx("span",{className:"text-sm",children:"Axially Loaded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-2",children:"Primary Muscles *"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:re.map(k=>e.jsx("button",{onClick:()=>j(k,"primary"),className:`px-2 py-1 text-sm rounded border ${b.includes(k)?`${(l==null?void 0:l.primary)||"bg-blue-600 hover:bg-blue-700"} text-white`:"bg-white hover:bg-slate-50"}`,children:k},k))})]}),e.jsxs("button",{onClick:()=>p(!w),className:`text-sm ${(l==null?void 0:l.accent)||"text-blue-600"} hover:opacity-80`,children:[w?"Hide":"+ Add"," Secondary/Tertiary"]}),w&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold block mb-1",children:"Secondary Muscles"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:re.map(k=>e.jsx("button",{onClick:()=>j(k,"secondary"),className:`px-2 py-1 text-xs rounded border ${d.includes(k)?"bg-green-600 text-white":"bg-white hover:bg-slate-50"}`,children:k},k))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold block mb-1",children:"Tertiary Muscles"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:re.map(k=>e.jsx("button",{onClick:()=>j(k,"tertiary"),className:`px-2 py-1 text-xs rounded border ${f.includes(k)?"bg-purple-600 text-white":"bg-white hover:bg-slate-50"}`,children:k},k))})]})]}),C?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:y,className:"flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700",children:"Update Exercise"}),e.jsx("button",{onClick:A,className:"flex-1 bg-gray-400 text-white py-2 rounded hover:bg-gray-500",children:"Cancel"})]}):e.jsx("button",{onClick:O,className:`w-full text-white py-2 rounded ${(l==null?void 0:l.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"Save Exercise"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h2",{className:"font-bold",children:["All Exercises (",Y.length,")"]}),e.jsx("button",{onClick:n,className:`underline text-sm ${(l==null?void 0:l.accent)||"text-blue-600"} hover:opacity-80`,children:"Load Presets"})]}),e.jsx("input",{type:"text",value:U,onChange:k=>_(k.target.value),placeholder:"Search exercises...",className:"w-full px-3 py-2 border rounded mb-3"}),Y.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-slate-500",children:U?"No exercises match your search":"No exercises yet"})}):e.jsx("div",{className:"space-y-2 stagger-children",children:Y.map(k=>{var I;return e.jsxs("div",{className:"border p-3 rounded flex justify-between items-center hover:bg-slate-50 card-hover",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:k.name}),e.jsxs("div",{className:"text-xs text-slate-600",children:[(I=k.prim)==null?void 0:I.join(", "),k.axial&&e.jsx("span",{className:"ml-2 text-orange-600 font-semibold",children:"â€¢ Axial"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u(k),className:`text-lg ${(l==null?void 0:l.accent)||"text-blue-500"} hover:opacity-80`,children:"âœï¸"}),e.jsx("button",{onClick:()=>{confirm(`Delete ${k.name}?`)&&a(k.id)},className:"text-red-500 hover:text-red-700",children:"ðŸ—‘ï¸"})]})]},k.id)})})]})]})}function Ms({programs:t,exercises:s,activeProgram:r,currentDayIndex:a,onAddProgram:n,onUpdateProgram:l,onDeleteProgram:m,onStartProgram:o,onStopProgram:i,theme:N}){var L;const[x,S]=c.useState(""),[b,h]=c.useState([]),[d,g]=c.useState({name:"",exercises:[],isRestDay:!1}),[f,D]=c.useState(null),[w,p]=c.useState(null),[C,$]=c.useState(null),[U,_]=c.useState(null),W=c.useRef(null),j=xt(s),O=v=>{const T=s.find(R=>R.id==v);T&&g({...d,exercises:[...d.exercises,{...T,sets:3,reps:10,rir:2,exId:T.id}]})},u=(v,T,R)=>{const H=[...d.exercises];H[v][T]=parseInt(R),g({...d,exercises:H})},y=v=>{g({...d,exercises:d.exercises.filter((T,R)=>R!==v)})},A=v=>{const T=d.exercises[v];g({...d,exercises:[...d.exercises.slice(0,v+1),{...T},...d.exercises.slice(v+1)]})},B=(v,T)=>{_(T),v.dataTransfer.effectAllowed="move"},Y=(v,T)=>{if(v.preventDefault(),U===null||U===T)return;const R=[...d.exercises],H=R[U];R.splice(U,1),R.splice(T,0,H),g({...d,exercises:R}),_(T)},k=()=>{_(null)},I=v=>{p(v),g({...b[v]}),setTimeout(()=>{var T;(T=W.current)==null||T.scrollIntoView({behavior:"smooth",block:"start"})},100)},G=v=>{const T=b[v],R={...T,name:`${T.name} (Copy)`,id:Date.now()},H=[...b.slice(0,v+1),R,...b.slice(v+1)];h(H)},z=()=>{if(!d.name){alert("Add day name");return}const v=[...b];v[w]={...d},h(v),p(null),g({name:"",exercises:[],isRestDay:!1})},Q=()=>{p(null),g({name:"",exercises:[],isRestDay:!1})},ne=()=>{if(!d.name){alert("Add day name");return}w!==null?z():(h([...b,{...d,id:Date.now()}]),g({name:"",exercises:[],isRestDay:!1}))},se=v=>{h(b.filter((T,R)=>R!==v))},ye=(v,T)=>{$(T),v.dataTransfer.effectAllowed="move"},he=(v,T)=>{if(v.preventDefault(),C===null||C===T)return;const R=[...b],H=R[C];R.splice(C,1),R.splice(T,0,H),h(R),$(T)},Ne=()=>{$(null)},Se=async()=>{if(!x||b.length===0){alert("Add program name and days");return}await n({name:x,days:b}),F(),alert("Program saved!")},be=v=>{D(v.id),S(v.name),h(v.days)},ue=v=>{const T={...v,name:`${v.name} (Copy)`};D(null),S(T.name),h(T.days),window.scrollTo({top:0,behavior:"smooth"})},ve=async()=>{if(!x||b.length===0){alert("Add program name and days");return}await l(f,{name:x,days:b}),F(),alert("Program updated!")},Z=()=>{F()},F=()=>{D(null),S(""),h([]),g({name:"",exercises:[],isRestDay:!1})},P=v=>{const T=v.filter(q=>!q.isRestDay).length,R=v.filter(q=>q.isRestDay).length,H=v.reduce((q,ae)=>{var ge;return q+(((ge=ae.exercises)==null?void 0:ge.length)||0)},0);return{trainingDays:T,restDays:R,totalExercises:H}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Programs"}),r&&e.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-green-900",children:["Active: ",r.name]}),e.jsxs("div",{className:"text-sm text-green-700",children:["Day ",a+1," of ",r.days.length,((L=r.days[a])==null?void 0:L.isRestDay)&&" (Rest Day)"]})]}),e.jsx("button",{onClick:i,className:"text-sm text-red-600 hover:text-red-700",children:"Stop"})]})}),e.jsxs("div",{className:"space-y-4 mb-6 pb-6 border-b",children:[e.jsx("h3",{className:"font-semibold text-lg sm:text-xl",children:"Create Program"}),e.jsx("input",{type:"text",value:x,onChange:v=>S(v.target.value),placeholder:"Program name (e.g., Push Pull Legs)",className:"w-full px-4 py-3 border-2 rounded-lg text-base"}),e.jsxs("div",{ref:W,className:"border-2 rounded-lg p-4 bg-slate-50",children:[e.jsx("h3",{className:"font-semibold mb-4 text-base sm:text-lg",children:"Build Training Day"}),e.jsx("input",{type:"text",value:d.name,onChange:v=>g({...d,name:v.target.value}),placeholder:"Day name (e.g., Upper A, Push, Legs)",className:"w-full px-4 py-3 border-2 rounded-lg mb-4 text-base"}),!d.isRestDay&&e.jsx(e.Fragment,{children:s.length===0?e.jsxs("div",{className:"text-center py-6 text-slate-500",children:[e.jsx("p",{className:"mb-3",children:"No exercises available"}),e.jsx("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Go to Exercises"})]}):e.jsxs(e.Fragment,{children:[e.jsx(mt,{exercises:s,exercisesByMuscle:j,onSelect:O,placeholder:"2ï¸âƒ£ Choose exercise to add...",className:"mb-4"}),d.exercises.length>0&&e.jsx("div",{className:"space-y-3 mb-4",children:d.exercises.map((v,T)=>e.jsxs("div",{draggable:!0,onDragStart:R=>B(R,T),onDragOver:R=>Y(R,T),onDragEnd:k,className:`bg-white p-4 rounded-lg border-2 cursor-move transition-all ${U===T?"opacity-50 scale-95":"hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 cursor-grab",children:"â‹®â‹®"}),e.jsx("span",{className:"font-semibold text-base",children:v.name})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>A(T),className:"text-blue-500 text-lg hover:text-blue-700",title:"Duplicate exercise",children:"ðŸ“‹"}),e.jsx("button",{onClick:()=>y(T),className:"text-red-500 text-xl px-2",children:"Ã—"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-1",children:"Sets"}),e.jsx("input",{type:"number",value:v.sets,onChange:R=>u(T,"sets",R.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-base text-center font-semibold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-1",children:"Reps"}),e.jsx("input",{type:"number",value:v.reps,onChange:R=>u(T,"reps",R.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-base text-center font-semibold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-1",children:"RIR"}),e.jsx("input",{type:"number",value:v.rir,onChange:R=>u(T,"rir",R.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-base text-center font-semibold"})]})]})]},T))})]})}),e.jsx("div",{className:"flex gap-2",children:d.isRestDay?e.jsx("button",{onClick:ne,disabled:!d.name,className:"flex-1 bg-blue-500 text-white py-3 rounded-lg font-bold text-base hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"âœ“ Add Rest Day"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:ne,disabled:!d.name||d.exercises.length===0,className:"flex-1 bg-green-600 text-white py-3 rounded-lg font-bold text-base hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:w!==null?"âœ“ Update Day":"âœ“ Add Training Day"}),e.jsx("button",{onClick:()=>{const v=d.name||`Rest Day ${b.filter(T=>T.isRestDay).length+1}`;h([...b,{name:v,exercises:[],isRestDay:!0,id:Date.now()}]),g({name:"",exercises:[],isRestDay:!1})},className:"bg-blue-500 text-white px-6 py-3 rounded-lg font-bold text-base hover:bg-blue-600 whitespace-nowrap",title:"Add rest day",children:"ðŸ˜´ Add Rest"})]})}),w!==null&&e.jsx("button",{onClick:Q,className:"w-full bg-gray-400 text-white py-3 rounded-lg font-bold text-base hover:bg-gray-500 mt-2",children:"Cancel Editing Day"})]}),b.length>0&&e.jsxs("div",{className:"border-2 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-semibold text-base sm:text-lg",children:["Program Days (",b.length,")"]}),e.jsx("div",{className:"text-sm text-slate-600",children:(()=>{const v=P(b);return`${v.trainingDays} training, ${v.restDays} rest`})()})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"ðŸ’¡ Drag to reorder days"}),b.map((v,T)=>e.jsxs("div",{draggable:!0,onDragStart:R=>ye(R,T),onDragOver:R=>he(R,T),onDragEnd:Ne,className:`mb-4 p-4 rounded-lg border cursor-move transition-all ${C===T?"opacity-50 scale-95":"hover:shadow-md"} ${v.isRestDay?"bg-blue-50 border-blue-200":"bg-slate-50 border-slate-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 cursor-grab",children:"â‹®â‹®"}),v.isRestDay&&e.jsx("span",{className:"text-2xl",children:"ðŸ˜´"}),e.jsxs("div",{children:[e.jsx("div",{className:`font-bold text-base ${v.isRestDay?"text-blue-900":""}`,children:v.name}),v.isRestDay&&e.jsx("div",{className:"text-xs text-blue-600",children:"Scheduled recovery"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>G(T),className:"text-blue-500 text-lg hover:text-blue-700",title:"Duplicate day",children:"ðŸ“‹"}),e.jsx("button",{onClick:()=>I(T),className:`text-lg ${(N==null?void 0:N.accent)||"text-blue-500"} hover:opacity-80`,children:"âœï¸"}),e.jsx("button",{onClick:()=>se(T),className:"text-red-500 text-xl hover:text-red-700",children:"ðŸ—‘ï¸"})]})]}),!v.isRestDay&&v.exercises.map((R,H)=>e.jsxs("div",{className:"text-sm text-slate-600 py-1",children:["â€¢ ",R.name," - ",R.sets,"Ã—",R.reps," @ ",R.rir,"RIR"]},H))]},T))]}),f?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ve,disabled:b.length===0,className:"flex-1 bg-green-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-green-700 disabled:bg-slate-300",children:"Update Program"}),e.jsx("button",{onClick:Z,className:"flex-1 bg-gray-400 text-white py-4 rounded-lg font-bold text-lg hover:bg-gray-500",children:"Cancel"})]}):e.jsx("button",{onClick:Se,disabled:b.length===0,className:`w-full text-white py-4 rounded-lg font-bold text-lg disabled:bg-slate-300 ${(N==null?void 0:N.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"Save Program"})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold mb-4",children:["Saved Programs (",t.length,")"]}),t.length===0?e.jsx("p",{className:"text-slate-500 text-center py-8",children:"No programs yet"}):e.jsx("div",{className:"space-y-4 stagger-children",children:t.map(v=>{const T=P(v.days);return e.jsxs("div",{className:"border-2 p-5 rounded-lg hover:shadow-md transition-shadow card-hover",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-xl",children:v.name}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:[T.trainingDays," training days Â· ",T.restDays," rest days Â· ",T.totalExercises," exercises"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ue(v),className:"text-blue-500 text-xl hover:text-blue-700",title:"Duplicate program",children:"ðŸ“‹"}),e.jsx("button",{onClick:()=>be(v),className:`text-xl ${(N==null?void 0:N.accent)||"text-blue-500"} hover:opacity-80`,children:"âœï¸"}),e.jsx("button",{onClick:()=>{confirm(`Delete ${v.name}?`)&&m(v.id)},className:"text-red-500 text-xl hover:text-red-700",children:"ðŸ—‘ï¸"}),e.jsx("button",{onClick:()=>o(v.id),disabled:r&&r.id===v.id,className:"bg-green-600 text-white px-5 py-2 rounded-lg text-base font-semibold hover:bg-green-700 disabled:bg-green-300",children:r&&r.id===v.id?"âœ“ Active":"Start"})]})]}),e.jsx("div",{className:"space-y-3",children:v.days.map((R,H)=>e.jsxs("div",{className:`pl-4 border-l-4 ${R.isRestDay?"border-blue-400 bg-blue-50 p-2 rounded":(N==null?void 0:N.primary.split(" ")[0].replace("bg-","border-"))||"border-blue-500"}`,children:[e.jsxs("div",{className:"font-semibold text-base mb-1 flex items-center gap-2",children:[R.isRestDay&&e.jsx("span",{className:"text-xl",children:"ðŸ˜´"}),"Day ",H+1,": ",R.name,R.isRestDay&&e.jsx("span",{className:"text-xs text-blue-600",children:"(Rest)"})]}),!R.isRestDay&&R.exercises.map((q,ae)=>e.jsxs("div",{className:"text-sm text-slate-600",children:["â€¢ ",q.name," - ",q.sets,"Ã—",q.reps," @ ",q.rir,"RIR"]},ae))]},H))})]},v.id)})})]})]})}function _s({settings:t,onUpdateSetting:s,onResetSettings:r,themeColors:a}){const{changePassword:n}=ct(),[l,m]=c.useState(""),[o,i]=c.useState(""),[N,x]=c.useState(""),[S,b]=c.useState(""),[h,d]=c.useState(""),g=p=>{s("themeColor",p)},f=p=>{s("restTimerEnabled",p)},D=p=>{s("defaultRestTime",parseInt(p))},w=async p=>{if(p.preventDefault(),b(""),o!==N){b("New passwords do not match"),d("error");return}const C=await n(l,o);C.success?(b("Password changed successfully!"),d("success"),m(""),i(""),x("")):(b(C.error),d("error"))};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 max-w-3xl mx-auto animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Settings"}),e.jsxs("div",{className:"mb-8 pb-8 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Theme Color"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choose your preferred accent color for buttons and highlights"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:Object.entries(a).map(([p,C])=>e.jsx("button",{onClick:()=>g(p),className:`
                relative p-4 rounded-lg border-2 transition-all card-hover
                ${t.themeColor===p?"border-gray-900 shadow-md scale-105":"border-gray-200 hover:border-gray-400"}
              `,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`w-12 h-12 rounded-full ${C.primary.split(" ")[0]}`}),e.jsx("span",{className:"text-sm font-medium",children:C.name}),t.themeColor===p&&e.jsx("span",{className:"text-xs text-green-600 font-semibold",children:"âœ“ Active"})]})},p))})]}),e.jsxs("div",{className:"mb-8 pb-8 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Rest Timer"}),e.jsx("div",{className:"mb-6",children:e.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Enable Rest Timer"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Automatically start a countdown timer after each set"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:t.restTimerEnabled,onChange:p=>f(p.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-14 h-8 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-blue-600"})]})]})}),e.jsxs("div",{className:`transition-opacity ${t.restTimerEnabled?"opacity-100":"opacity-50"}`,children:[e.jsxs("label",{className:"block mb-3",children:[e.jsx("span",{className:"font-semibold block mb-2",children:"Default Rest Time"}),e.jsx("span",{className:"text-sm text-gray-600 block mb-3",children:"How long should the rest timer count down by default?"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4",children:[60,90,120,150,180,240,300].map(p=>e.jsx("button",{onClick:()=>D(p),disabled:!t.restTimerEnabled,className:`
                  px-4 py-3 rounded-lg border-2 font-semibold transition-all btn-press
                  ${t.defaultRestTime===p?"border-blue-600 bg-blue-50 text-blue-900":"border-gray-200 bg-white hover:border-gray-400"}
                  ${!t.restTimerEnabled&&"cursor-not-allowed"}
                `,children:p<60?`${p}s`:`${Math.floor(p/60)}:${(p%60).toString().padStart(2,"0")}`},p))}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Or enter custom time (seconds):"}),e.jsx("input",{type:"number",value:t.defaultRestTime,onChange:p=>D(p.target.value),disabled:!t.restTimerEnabled,min:"10",max:"600",className:"w-full sm:w-48 px-4 py-2 border-2 rounded-lg text-lg font-semibold text-center disabled:bg-gray-100 disabled:cursor-not-allowed"})]})]})]}),e.jsxs("div",{className:"mb-8 pb-8 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Change Password"}),e.jsxs("form",{onSubmit:w,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Current Password"}),e.jsx("input",{type:"password",value:l,onChange:p=>m(p.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none",placeholder:"Enter current password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:o,onChange:p=>i(p.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none",placeholder:"Enter new password (min 6 chars)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:N,onChange:p=>x(p.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none",placeholder:"Confirm new password"})]}),S&&e.jsx("div",{className:`p-3 rounded-lg ${h==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:S}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 font-semibold transition-colors",children:"Change Password"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Reset"}),e.jsx("button",{onClick:()=>{confirm("Reset all settings to default values?")&&r()},className:"px-6 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors",children:"Reset to Defaults"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"This will restore all settings to their original values"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Current Settings"}),e.jsxs("div",{className:"text-sm space-y-1 text-gray-700",children:[e.jsxs("div",{children:["Theme: ",e.jsx("span",{className:"font-medium",children:a[t.themeColor].name})]}),e.jsxs("div",{children:["Rest Timer: ",e.jsx("span",{className:"font-medium",children:t.restTimerEnabled?"Enabled":"Disabled"})]}),e.jsxs("div",{children:["Default Rest Time: ",e.jsxs("span",{className:"font-medium",children:[t.defaultRestTime,"s (",Math.floor(t.defaultRestTime/60),":",(t.defaultRestTime%60).toString().padStart(2,"0"),")"]})]})]})]})]})}function Is(){const[t,s]=c.useState("session"),[r,a]=c.useState(!1),{userId:n,username:l,isAuthenticated:m,isLoading:o,login:i,logout:N}=ct(),{settings:x,updateSetting:S,resetSettings:b,themeColors:h,currentTheme:d}=ys(n),{workouts:g,addSession:f,updateSession:D,deleteWorkout:w}=ts(n),{exercises:p,addExercise:C,updateExercise:$,deleteExercise:U,resetToPresets:_}=rs(),{programs:W,activeProgram:j,currentDayIndex:O,addProgram:u,updateProgram:y,deleteProgram:A,startProgram:B,stopProgram:Y,advanceToNextDay:k,getCurrentDay:I}=as(n),{localFatigue:G,weeklyStimulus:z,muscleReadiness:Q,systemicReadiness:ne,lastWorkoutDate:se,readinessHistory:ye,processWorkoutSession:he}=hs(n,g),Ne=fs(),Se=P=>{const L=g.map(v=>v.timestamp===P.timestamp?P:v);X.saveUserData("workouts",L,n)},be=async P=>{await w(P)},ue=async(P,L)=>{if(console.log("ðŸŸ¡ APP handleAutoSave CALLED"),console.log("  Session:",P),console.log("  Session length:",P.length),console.log("  Date:",L),P.length===0){console.log("  âš ï¸ Empty session - skipping");return}try{console.log("  â³ Calling updateSession..."),await D(P,L),console.log("  âœ… handleAutoSave COMPLETE")}catch(v){console.error("  âŒ Auto-save failed:",v)}},ve=async(P,L,v,T)=>{const R=I(),H=(R==null?void 0:R.isRestDay)||!1,q=j?{activeProgram:j,currentDayIndex:O,lastDayIndex:O>0?O-1:j.days.length-1,isRestDay:H}:null;H?await he([],L,{perceivedFatigue:v,muscleSoreness:T},q):(await f(P,L),await he(P,L,{perceivedFatigue:v,muscleSoreness:T},q)),j&&k()},Z=async(P,L,v)=>{console.log("ðŸ’¾ handleSaveRecoveryOnly called:"),console.log("  date:",P),console.log("  perceivedFatigue:",L),console.log("  muscleSoreness:",v);try{await he([],P,{perceivedFatigue:L,muscleSoreness:v},null)}catch(T){console.error("Failed to save recovery data:",T)}},F=()=>{const P=I();return P||(alert("No program day to load"),null)};return o?e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:e.jsx("div",{className:"text-white text-2xl",children:"Loading..."})}):m?e.jsxs("div",{className:`min-h-screen p-4 transition-colors duration-300 ${x.themeColor==="blue"?"bg-gradient-to-br from-slate-900 to-blue-900":x.themeColor==="green"?"bg-gradient-to-br from-slate-900 to-green-900":x.themeColor==="purple"?"bg-gradient-to-br from-slate-900 to-purple-900":x.themeColor==="orange"?"bg-gradient-to-br from-slate-900 to-orange-900":x.themeColor==="red"?"bg-gradient-to-br from-slate-900 to-red-900":x.themeColor==="indigo"?"bg-gradient-to-br from-slate-900 to-indigo-900":x.themeColor==="pink"?"bg-gradient-to-br from-slate-900 to-pink-900":x.themeColor==="teal"?"bg-gradient-to-br from-slate-900 to-teal-900":"bg-gradient-to-br from-slate-900 to-slate-800"}`,children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:()=>a(!r),className:"text-white p-2 hover:bg-slate-700 rounded-lg transition-colors","aria-label":"Menu",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"text-white",children:[e.jsx("span",{className:"text-sm opacity-75",children:"Logged in as:"}),e.jsx("span",{className:"ml-2 font-semibold",children:l})]}),e.jsx("button",{onClick:N,className:"text-white text-sm opacity-75 hover:opacity-100 underline transition-opacity",children:"Logout"})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 animate-fadeIn",onClick:()=>a(!1)}),e.jsxs("div",{className:"fixed top-0 left-0 h-full w-64 bg-white shadow-2xl z-50 flex flex-col animate-slideInLeft",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"font-bold text-xl",children:"Menu"}),e.jsx("button",{onClick:()=>a(!1),className:"text-gray-500 hover:text-gray-700 text-2xl transition-transform hover:rotate-90",children:"Ã—"})]}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 stagger-children",children:[e.jsxs("button",{onClick:()=>{s("session"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="session"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ’ª"}),e.jsx("span",{children:"Session"})]}),e.jsxs("button",{onClick:()=>{s("history"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="history"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ“Š"}),e.jsx("span",{children:"History"})]}),e.jsxs("button",{onClick:()=>{s("recovery"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="recovery"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"â¤ï¸"}),e.jsx("span",{children:"Recovery"})]}),e.jsxs("button",{onClick:()=>{s("exercises"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="exercises"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ‹ï¸"}),e.jsx("span",{children:"Exercises"})]}),e.jsxs("button",{onClick:()=>{s("programs"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="programs"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ“…"}),e.jsx("span",{children:"Programs"})]}),e.jsx("div",{className:"my-2 border-t"}),e.jsxs("button",{onClick:()=>{s("settings"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="settings"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"âš™ï¸"}),e.jsx("span",{children:"Settings"})]})]}),e.jsx("div",{className:"p-4 border-t bg-slate-50",children:e.jsx("div",{className:"text-xs text-slate-600 text-center",children:"Workout Tracker v1.0"})})]})]}),t==="session"&&e.jsx(Rs,{exercises:p,workouts:g,muscleReadiness:Q,systemicReadiness:ne,weeklyStimulus:z,activeProgram:j,currentDayIndex:O,getCurrentDay:I,onSessionComplete:ve,onAutoSave:ue,onSaveRecoveryOnly:Z,onLoadProgramDay:F,useRestTimer:()=>Ne,settings:x,theme:d}),t==="history"&&e.jsx(Ds,{workouts:g,readinessHistory:ye,onUpdateWorkout:Se,onDeleteWorkout:be,theme:d}),t==="recovery"&&e.jsx(Ls,{muscleReadiness:Q,systemicReadiness:ne,weeklyStimulus:z,localFatigue:G,lastWorkoutDate:se,workouts:g,theme:d}),t==="exercises"&&e.jsx(Ps,{exercises:p,onAddExercise:C,onUpdateExercise:$,onDeleteExercise:U,onResetToPresets:_,theme:d}),t==="programs"&&e.jsx(Ms,{programs:W,exercises:p,activeProgram:j,currentDayIndex:O,onAddProgram:u,onUpdateProgram:y,onDeleteProgram:A,onStartProgram:B,onStopProgram:Y,theme:d}),t==="settings"&&e.jsx(_s,{settings:x,onUpdateSetting:S,onResetSettings:b,themeColors:h})]}),j&&e.jsxs("div",{className:`fixed bottom-4 right-4 text-white px-4 py-3 rounded-lg shadow-lg ${d.primary.split(" ")[0]}`,children:[e.jsx("div",{className:"text-xs font-semibold opacity-90",children:"Active Program"}),e.jsx("div",{className:"font-bold",children:j.name}),e.jsxs("div",{className:"text-xs opacity-75",children:["Day ",O+1,"/",j.days.length]})]})]}):e.jsx(vs,{onLogin:i})}ze.createRoot(document.getElementById("root")).render(e.jsx(ht.StrictMode,{children:e.jsx(Is,{})}));
