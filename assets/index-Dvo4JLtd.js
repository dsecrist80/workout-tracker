import{r as c,a as bt,R as ft}from"./react-vendor-wGySg1uH.js";import{i as yt,g as vt,d as he,a as nt,s as _e,b as $e,c as jt,e as wt}from"./firebase-vendor-DArFBOnq.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const g of l.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&a(g)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var lt={exports:{}},He={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var St=c,Nt=Symbol.for("react.element"),Et=Symbol.for("react.fragment"),Rt=Object.prototype.hasOwnProperty,Dt=St.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ct={key:!0,ref:!0,__self:!0,__source:!0};function ot(t,s,r){var a,n={},l=null,g=null;r!==void 0&&(l=""+r),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(g=s.ref);for(a in s)Rt.call(s,a)&&!Ct.hasOwnProperty(a)&&(n[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:Nt,type:t,key:l,ref:g,props:n,_owner:Dt.current}}He.Fragment=Et;He.jsx=ot;He.jsxs=ot;lt.exports=He;var e=lt.exports,qe={},Qe=bt;qe.createRoot=Qe.createRoot,qe.hydrateRoot=Qe.hydrateRoot;const Ie="workout_tracker_";class Te extends Error{constructor(s,r,a){super(s),this.name="StorageError",this.operation=r,this.key=a}}function kt(){try{const t="__storage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch{return!1}}function Be(t){return`${Ie}${t}`}function it(t,s=null){try{const r=Be(t),a=localStorage.getItem(r);if(a===null)return s;try{return JSON.parse(a)}catch{return a}}catch(r){throw console.error(`Storage get error for key "${t}":`,r),new Te(`Failed to get item: ${r.message}`,"get",t)}}function ct(t,s){try{const r=Be(t),a=JSON.stringify(s);return localStorage.setItem(r,a),!0}catch(r){throw console.error(`Storage set error for key "${t}":`,r),r.name==="QuotaExceededError"?new Te("Storage quota exceeded. Please clear some data.","set",t):new Te(`Failed to set item: ${r.message}`,"set",t)}}function Ft(t){try{const s=Be(t);return localStorage.removeItem(s),!0}catch(s){throw console.error(`Storage remove error for key "${t}":`,s),new Te(`Failed to remove item: ${s.message}`,"remove",t)}}function Tt(){try{return Object.keys(localStorage).forEach(s=>{s.startsWith(Ie)&&localStorage.removeItem(s)}),!0}catch(t){throw console.error("Storage clear error:",t),new Te(`Failed to clear storage: ${t.message}`,"clear",null)}}function At(){try{return Object.keys(localStorage).filter(s=>s.startsWith(Ie)).map(s=>s.replace(Ie,""))}catch(t){throw console.error("Storage getAllKeys error:",t),new Te(`Failed to get keys: ${t.message}`,"getAllKeys",null)}}function dt(){try{let t=0;return Object.keys(localStorage).forEach(r=>{if(r.startsWith(Ie)){const a=localStorage.getItem(r);a&&(t+=r.length+a.length)}}),t*2}catch(t){return console.error("Storage size calculation error:",t),0}}function Lt(){const t=dt();return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(2)} KB`:`${(t/(1024*1024)).toFixed(2)} MB`}function Pt(t){try{const s=Be(t);return localStorage.getItem(s)!==null}catch(s){return console.error(`Storage hasKey error for "${t}":`,s),!1}}function Mt(t){const s={};return t.forEach(r=>{try{s[r]=it(r)}catch(a){console.error(`Error getting key "${r}":`,a),s[r]=null}}),s}function It(t){try{return Object.entries(t).forEach(([s,r])=>{ct(s,r)}),!0}catch(s){return console.error("Error setting multiple items:",s),!1}}function _t(t,s=null){try{return t()}catch(r){return console.error("Storage operation failed:",r),s}}const de={isAvailable:kt,get:it,set:ct,remove:Ft,clear:Tt,getAllKeys:At,getSize:dt,getSizeFormatted:Lt,hasKey:Pt,getMultiple:Mt,setMultiple:It,safe:_t},Z={LOCAL_RECOVERY_RATE:.2,SYSTEMIC_RECOVERY_RATE:.25,RIR_DECAY_CONSTANT:.3,PRIMARY_MUSCLE_MULTIPLIER:1,SECONDARY_MUSCLE_MULTIPLIER:.5,TERTIARY_MUSCLE_MULTIPLIER:.25,AXIAL_LOAD_MULTIPLIER:1.15,COMPOUND_SYSTEMIC_MULTIPLIER:1.2,RIR_MISS_FATIGUE_PENALTY:.15,SORENESS_FATIGUE_WEIGHT:.4,PERCEIVED_FATIGUE_WEIGHT:.3,STIMULUS_DECAY_RATE:.14,PROGRESSION_THRESHOLD:.85,DELOAD_THRESHOLD:.5,DELOAD_TRACKING_DAYS:7,DELOAD_MIN_CONDITIONS:2,PERFORMANCE_ERROR_THRESHOLD:-1,PERFORMANCE_ERROR_SESSIONS:2,USE_EPLEY_FORMULA:!0,BASE_FATIGUE_PER_SET:.033,MAX_FATIGUE_THRESHOLD:.6},Xe={RIR_PROGRESSION_THRESHOLD:1,OPTIMAL_SETS_PER_WEEK:15,MAX_WEEKLY_STIMULUS:25},ue={USER_ID:"userId",USERNAME:"username",ACTIVE_PROGRAM:t=>`ap_${t}`,CURRENT_DAY_INDEX:t=>`cdi_${t}`,THEME_PREFERENCE:"theme",LAST_SYNC:"lastSync"},te={EXERCISES:"exercises",WORKOUTS:"workouts",PROGRAMS:"programs",FATIGUE:"fatigue",USER_PREFERENCES:"preferences"},$t={apiKey:"AIzaSyC_nkyWikwTCHDIBOvpXkEvk7Cfl8w5GLE",authDomain:"workout-tracker-e57d4.firebaseapp.com",projectId:"workout-tracker-e57d4",storageBucket:"workout-tracker-e57d4.firebasestorage.app",messagingSenderId:"20708564104",appId:"1:20708564104:web:e7457b6f3fc63cd271933d"},Ot=yt($t),ge=vt(Ot);class se extends Error{constructor(s,r,a){super(s),this.name="DatabaseError",this.operation=r,this.collection=a}}async function Ut(t,s){try{const r=he(ge,t,"data");return await _e(r,{items:s,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved to ${t}:`,s.length,"items"),!0}catch(r){throw console.error(`âŒ Save error for ${t}:`,r),new se(`Failed to save collection: ${r.message}`,"save",t)}}async function Wt(t){try{const s=await jt(wt(ge,t));let r=[];return s.forEach(a=>{a.id==="data"&&a.data().items&&(r=a.data().items)}),console.log(`âœ… Loaded from ${t}:`,r.length,"items"),r}catch(s){throw console.error(`âŒ Load error for ${t}:`,s),new se(`Failed to load collection: ${s.message}`,"load",t)}}async function Ht(t,s,r){if(!r)throw new se("User ID is required","saveUserData",t);try{const a=he(ge,t,r);if(s===null)return await nt(a),console.log(`âœ… Deleted user data from ${t} for user ${r}`),!0;const n=Array.isArray(s)?{items:s,userId:r,updatedAt:new Date().toISOString()}:{...s,userId:r,updatedAt:new Date().toISOString()};await _e(a,n);const l=Array.isArray(s)?s.length:"object";return console.log(`âœ… Saved user data to ${t} for user ${r}:`,l,Array.isArray(s)?"items":""),!0}catch(a){throw console.error(`âŒ Save user data error for ${t}:`,a),new se(`Failed to save user data: ${a.message}`,"saveUserData",t)}}async function Bt(t,s){if(!s)throw new se("User ID is required","loadUserData",t);try{const r=he(ge,t,s),a=await $e(r);if(a.exists()){const n=a.data();if(n.items&&Array.isArray(n.items))return console.log(`âœ… Loaded user data from ${t} for user ${s}:`,n.items.length,"items"),n.items;const{userId:l,updatedAt:g,...o}=n;return console.log(`âœ… Loaded user data from ${t} for user ${s}:`,"object"),o}else return console.log(`â„¹ï¸ No data found in ${t} for user ${s}`),null}catch(r){throw console.error(`âŒ Load user data error for ${t}:`,r),new se(`Failed to load user data: ${r.message}`,"loadUserData",t)}}async function Gt(t,s){if(!s)throw new se("User ID is required","getUserData",t);try{const r=he(ge,t,s),a=await $e(r);if(a.exists()){const n=a.data(),{userId:l,updatedAt:g,...o}=n;return console.log(`âœ… Loaded user data from ${t} for user ${s}`),o}else return console.log(`â„¹ï¸ No data found in ${t} for user ${s}`),null}catch(r){throw console.error(`âŒ Get user data error for ${t}:`,r),new se(`Failed to get user data: ${r.message}`,"getUserData",t)}}async function Vt(t,s){if(!t)throw new se("User ID is required","saveFatigueState",te.FATIGUE);try{const r=he(ge,te.FATIGUE,t);return await _e(r,{...s,userId:t,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved fatigue state for user ${t}`),!0}catch(r){throw console.error("âŒ Save fatigue state error:",r),new se(`Failed to save fatigue state: ${r.message}`,"saveFatigueState",te.FATIGUE)}}async function Yt(t){if(!t)throw new se("User ID is required","loadFatigueState",te.FATIGUE);try{const s=he(ge,te.FATIGUE,t),r=await $e(s);if(r.exists()){const a=r.data();return console.log(`âœ… Loaded fatigue state for user ${t}`),a}else return console.log(`â„¹ï¸ No fatigue state found for user ${t}`),{}}catch(s){throw console.error("âŒ Load fatigue state error:",s),new se(`Failed to load fatigue state: ${s.message}`,"loadFatigueState",te.FATIGUE)}}async function zt(t,s){if(!t)throw new se("User ID is required","saveActiveProgram","activeProgram");try{const r=he(ge,"activeProgram",t);return s===null?(await nt(r),console.log(`âœ… Cleared active program for user ${t}`),!0):(await _e(r,{...s,userId:t,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved active program for user ${t}:`,s.programId),!0)}catch(r){throw console.error("âŒ Save active program error:",r),new se(`Failed to save active program: ${r.message}`,"saveActiveProgram","activeProgram")}}async function qt(t){if(!t)throw new se("User ID is required","loadActiveProgram","activeProgram");try{const s=he(ge,"activeProgram",t),r=await $e(s);if(r.exists()){const a=r.data();return console.log(`âœ… Loaded active program for user ${t}`),a}else return console.log(`â„¹ï¸ No active program found for user ${t}`),null}catch(s){throw console.error("âŒ Load active program error:",s),new se(`Failed to load active program: ${s.message}`,"loadActiveProgram","activeProgram")}}async function Kt(t,s){if(!t)throw new se("User ID is required","saveSettings",te.USER_PREFERENCES);try{const r=he(ge,te.USER_PREFERENCES,t);return await _e(r,{...s,userId:t,updatedAt:new Date().toISOString()}),console.log(`âœ… Saved settings for user ${t}`),!0}catch(r){throw console.error("âŒ Save settings error:",r),new se(`Failed to save settings: ${r.message}`,"saveSettings",te.USER_PREFERENCES)}}async function Xt(t){if(!t)throw new se("User ID is required","loadSettings",te.USER_PREFERENCES);try{const s=he(ge,te.USER_PREFERENCES,t),r=await $e(s);if(r.exists()){const a=r.data();return console.log(`âœ… Loaded settings for user ${t}`),a}else return console.log(`â„¹ï¸ No settings found for user ${t}`),null}catch(s){throw console.error("âŒ Load settings error:",s),new se(`Failed to load settings: ${s.message}`,"loadSettings",te.USER_PREFERENCES)}}const Q={saveCollection:Ut,loadCollection:Wt,saveUserData:Ht,loadUserData:Bt,getUserData:Gt,saveFatigueState:Vt,loadFatigueState:Yt,saveActiveProgram:zt,loadActiveProgram:qt,saveSettings:Kt,loadSettings:Xt};async function Ue(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(a)).map(g=>g.toString(16).padStart(2,"0")).join("")}function ut(){const[t,s]=c.useState(null),[r,a]=c.useState(""),[n,l]=c.useState(!1),[g,o]=c.useState(!0);c.useEffect(()=>{(()=>{try{const u=de.get(ue.USER_ID),y=de.get(ue.USERNAME);u&&y&&(s(u),a(y),l(!0))}catch(u){console.error("Auth initialization error:",u)}finally{o(!1)}})()},[]);const i=async(d,u,y=!1)=>{if(!d||!d.trim())return{success:!1,error:"Username is required"};if(!u)return{success:!1,error:"Password is required"};const C=d.trim();try{if(y)return await S(C,u);{const w=C.toLowerCase().replace(/[^a-z0-9]/g,"_"),h=await Q.getUserData("users",w);if(!h)return{success:!1,error:"Username not found. Please register first."};const F=await Ue(u);return h.passwordHash!==F?{success:!1,error:"Incorrect password"}:(de.set(ue.USER_ID,w),de.set(ue.USERNAME,C),s(w),a(C),l(!0),{success:!0})}}catch(w){return console.error("Login error:",w),{success:!1,error:"Failed to login. Please try again."}}},S=async(d,u)=>{if(!d||d.trim().length<3)return{success:!1,error:"Username must be at least 3 characters"};if(!u||u.length<6)return{success:!1,error:"Password must be at least 6 characters"};const y=d.trim(),C=y.toLowerCase().replace(/[^a-z0-9]/g,"_");try{if(await Q.getUserData("users",C))return{success:!1,error:"Username already exists"};const h=await Ue(u),F={username:y,passwordHash:h,createdAt:new Date().toISOString()};return await Q.saveUserData("users",F,C),de.set(ue.USER_ID,C),de.set(ue.USERNAME,y),s(C),a(y),l(!0),{success:!0}}catch(w){return console.error("Registration error:",w),{success:!1,error:"Failed to register. Please try again."}}};return{userId:t,username:r,isAuthenticated:n,isLoading:g,login:i,register:S,logout:()=>{try{return de.remove(ue.USER_ID),de.remove(ue.USERNAME),t&&(de.remove(ue.ACTIVE_PROGRAM(t)),de.remove(ue.CURRENT_DAY_INDEX(t))),s(null),a(""),l(!1),!0}catch(d){throw console.error("Logout error:",d),new Error("Failed to logout. Please try again.")}},changePassword:async(d,u)=>{if(!t)return{success:!1,error:"Not authenticated"};if(!d)return{success:!1,error:"Current password is required"};if(!u||u.length<6)return{success:!1,error:"New password must be at least 6 characters"};try{const y=await Q.getUserData("users",t);if(!y)return{success:!1,error:"User not found"};const C=await Ue(d);if(y.passwordHash!==C)return{success:!1,error:"Current password is incorrect"};const w=await Ue(u),h={...y,passwordHash:w,passwordUpdatedAt:new Date().toISOString()};return await Q.saveUserData("users",h,t),{success:!0}}catch(y){return console.error("Change password error:",y),{success:!1,error:"Failed to change password"}}},updateUsername:d=>{if(!d||!d.trim())throw new Error("Username is required");try{const u=d.trim();return de.set(ue.USERNAME,u),a(u),!0}catch(u){throw console.error("Update username error:",u),new Error("Failed to update username.")}},checkAuth:()=>n&&t!==null}}function Ke(t){const s=typeof t=="string"?new Date(t):t,r=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0");return`${r}-${a}-${n}`}function Jt(t,s={}){const r=typeof t=="string"?new Date(t+"T12:00:00"):t,a={year:"numeric",month:"long",day:"numeric"};return r.toLocaleDateString("en-US",{...a,...s})}function Qt(t=new Date){const s=t.getFullYear(),r=t.getMonth(),a=new Date(s,r,1),n=new Date(s,r+1,0),l=[],g=a.getDay();for(let o=0;o<g;o++)l.push(null);for(let o=1;o<=n.getDate();o++)l.push(new Date(s,r,o));return l}function Zt(t=new Date){const s=new Date(t);s.setDate(t.getDate()-t.getDay()),s.setHours(0,0,0,0);const r=new Date(s);return r.setDate(s.getDate()+7),{start:s,end:r}}function es(t){const s={};return t.forEach(r=>{const a=r.date;s[a]||(s[a]=[]),s[a].push(r)}),s}function gt(t,s,r){const a=typeof s=="string"?new Date(s):s,n=typeof r=="string"?new Date(r):r;return t.filter(l=>{const g=new Date(l.date);return g>=a&&g<=n})}function Ge(){return Ke(new Date)}const ae=["Chest","Back","Shoulders","Biceps","Triceps","Quads","Hamstrings","Glutes","Calves","Abs","Forearms","Traps"];function ts(t){return(t.w||0)*(t.r||0)}function mt(t){return!t.sets||!Array.isArray(t.sets)?0:t.sets.reduce((s,r)=>s+ts(r),0)}function ss(t,s=new Date){const{start:r,end:a}=Zt(s),n=gt(t,r,a);let l=0,g=0;const o=new Set,i={},S={};return n.forEach(p=>{if(p.sets&&Array.isArray(p.sets)){const N=mt(p);l+=N,g+=p.sets.length,p.prim&&p.prim.forEach(f=>{o.add(f),i[f]=(i[f]||0)+N});const v=p.name||"Unknown";S[v]=(S[v]||0)+1}}),{workouts:n.length,totalVolume:l,totalSets:g,musclesWorked:Array.from(o),volumePerMuscle:i,exerciseCount:S,avgVolumePerWorkout:n.length>0?l/n.length:0}}function rs(t){const[s,r]=c.useState([]),[a,n]=c.useState(!1),[l,g]=c.useState(null),o=c.useCallback(async()=>{if(!t){r([]);return}n(!0),g(null);try{const m=await Q.loadUserData(te.WORKOUTS,t);r(m||[])}catch(m){console.error("Failed to load workouts:",m),g(m.message),r([])}finally{n(!1)}},[t]),i=c.useCallback(async m=>{if(!t)throw new Error("User ID required to save workouts");try{return await Q.saveUserData(te.WORKOUTS,m,t),r(m),!0}catch(x){return console.error("Failed to save workouts:",x),g(x.message),!1}},[t]),S=c.useCallback(async m=>{try{const T=[{...m,timestamp:Date.now(),createdAt:new Date().toISOString()},...s];return await i(T)}catch(x){return console.error("Failed to add workout:",x),g(x.message),!1}},[s,i]),p=c.useCallback(async(m,x)=>{try{const B=[...m.map(Y=>({...Y,date:x,timestamp:Date.now(),createdAt:new Date().toISOString()})),...s];return await i(B)}catch(T){return console.error("Failed to add session:",T),g(T.message),!1}},[s,i]),N=c.useCallback(async(m,x)=>{console.log("ðŸ”µ UPDATE SESSION CALLED"),console.log("  Input session:",m),console.log("  Input date:",x),console.log("  Session length:",m.length),console.log("  Current workouts in state:",s.length);try{const T=s.filter($=>$.date!==x);console.log("  Other workouts (different dates):",T.length);const B=m.map($=>{var oe;console.log("  Processing exercise:",$);const V=`${$.id}_${x}`,z=(oe=s.find(re=>re.date===x&&re.id===$.id))==null?void 0:oe.timestamp,K={id:$.id,name:$.name,sets:$.sets||[],date:x,timestamp:z||$.timestamp||Date.now(),createdAt:$.createdAt||new Date().toISOString()};return $.muscles&&(K.muscles=$.muscles),$.type&&(K.type=$.type),$.prim&&(K.prim=$.prim),$.sec&&(K.sec=$.sec),$.ter&&(K.ter=$.ter),$.axial!==void 0&&(K.axial=$.axial),$.prescribedSets!==void 0&&(K.prescribedSets=$.prescribedSets),$.prescribedReps!==void 0&&(K.prescribedReps=$.prescribedReps),$.prescribedRir!==void 0&&(K.prescribedRir=$.prescribedRir),$.prescribedWeight!==void 0&&(K.prescribedWeight=$.prescribedWeight),console.log("  Cleaned exercise:",K),K});console.log("  Session workouts prepared:",B),console.log("  Session workouts count:",B.length);const Y=[...B,...T];console.log("  Total workouts to save:",Y.length);const k=await i(Y);return console.log("  âœ… SAVE RESULT:",k),k}catch(T){return console.error("  âŒ Failed to update session:",T),g(T.message),!1}},[s,i]),v=c.useCallback(async m=>{try{const x=s.filter(T=>T.timestamp!==m);return await i(x)}catch(x){return console.error("Failed to delete workout:",x),g(x.message),!1}},[s,i]),f=c.useCallback(async m=>{try{const x=s.filter(k=>k.date===m),T=s.filter(k=>k.date!==m),B={};x.forEach(k=>{const $=B[k.id];(!$||k.timestamp>$.timestamp)&&(B[k.id]=k)});const Y=[...Object.values(B),...T];return console.log(`Removed ${x.length-Object.keys(B).length} duplicates from ${m}`),await i(Y)}catch(x){return console.error("Failed to remove duplicates:",x),g(x.message),!1}},[s,i]),d=c.useCallback(async m=>{try{const x=s.filter(T=>T.date!==m);return await i(x)}catch(x){return console.error("Failed to delete workouts for date:",x),g(x.message),!1}},[s,i]),u=c.useCallback(m=>s.filter(x=>x.id===m).sort((x,T)=>new Date(T.date)-new Date(x.date)),[s]),y=c.useCallback(m=>s.filter(x=>x.date===m),[s]),C=c.useCallback(()=>es(s),[s]),w=c.useCallback((m,x)=>gt(s,m,x),[s]),h=c.useCallback(m=>{const x=u(m);return x.length>0?x[0]:null},[u]),F=c.useCallback(()=>s.length,[s]),_=c.useCallback(()=>[...new Set(s.map(m=>m.date))].sort().reverse(),[s]),U=c.useCallback(()=>s.reduce((m,x)=>m+mt(x),0),[s]),L=c.useCallback(()=>{const m=_(),x=U();return{totalWorkouts:s.length,totalSessions:m.length,totalVolume:x,avgVolumePerWorkout:s.length>0?x/s.length:0,avgExercisesPerSession:m.length>0?s.length/m.length:0}},[s,_,U]),O=c.useCallback(async()=>{try{return await i([])}catch(m){return console.error("Failed to clear workouts:",m),g(m.message),!1}},[i]),j=c.useCallback(()=>JSON.stringify(s,null,2),[s]),H=c.useCallback(async(m,x=!1)=>{try{const T=JSON.parse(m);if(!Array.isArray(T))throw new Error("Invalid workout data format");const B=x?[...s,...T]:T;return await i(B)}catch(T){return console.error("Failed to import workouts:",T),g(T.message),!1}},[s,i]);return c.useEffect(()=>{o()},[o]),{workouts:s,isLoading:a,error:l,addWorkout:S,addSession:p,updateSession:N,deleteWorkout:v,deleteWorkoutsForDate:d,clearAllWorkouts:O,removeDuplicates:f,getWorkoutsForExercise:u,getWorkoutsForDate:y,getWorkoutsByDate:C,getWorkoutsInDateRange:w,getLastWorkoutForExercise:h,getUniqueDates:_,getWorkoutCount:F,getTotalVolume:U,getWorkoutStats:L,loadWorkouts:o,exportWorkouts:j,importWorkouts:H}}const as=[{id:1,name:"Barbell Bench Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:2,name:"Incline Barbell Bench Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:3,name:"Dumbbell Bench Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:4,name:"Incline Dumbbell Press",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:[]},{id:5,name:"Cable Fly",type:"isolation_upper",axial:!1,prim:["Chest"],sec:[],ter:["Shoulders"]},{id:6,name:"Push-ups",type:"compound_upper",axial:!1,prim:["Chest"],sec:["Triceps","Shoulders"],ter:["Abs"]},{id:7,name:"Barbell Row",type:"compound_upper",axial:!0,prim:["Back"],sec:["Biceps","Traps"],ter:["Forearms"]},{id:8,name:"Pull-ups",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps"],ter:["Forearms","Traps"]},{id:9,name:"Lat Pulldown",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps"],ter:["Forearms"]},{id:10,name:"Seated Cable Row",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps","Traps"],ter:["Forearms"]},{id:11,name:"Dumbbell Row",type:"compound_upper",axial:!1,prim:["Back"],sec:["Biceps","Traps"],ter:["Forearms"]},{id:12,name:"Deadlift",type:"compound_lower",axial:!0,prim:["Back","Hamstrings"],sec:["Glutes","Traps","Forearms"],ter:["Quads","Abs"]},{id:13,name:"Overhead Press",type:"compound_upper",axial:!0,prim:["Shoulders"],sec:["Triceps","Traps"],ter:["Abs"]},{id:14,name:"Dumbbell Shoulder Press",type:"compound_upper",axial:!1,prim:["Shoulders"],sec:["Triceps"],ter:["Traps"]},{id:15,name:"Lateral Raises",type:"isolation_upper",axial:!1,prim:["Shoulders"],sec:[],ter:["Traps"]},{id:16,name:"Front Raises",type:"isolation_upper",axial:!1,prim:["Shoulders"],sec:[],ter:[]},{id:17,name:"Face Pulls",type:"isolation_upper",axial:!1,prim:["Shoulders","Traps"],sec:["Back"],ter:[]},{id:18,name:"Barbell Curl",type:"isolation_upper",axial:!1,prim:["Biceps"],sec:["Forearms"],ter:[]},{id:19,name:"Dumbbell Curl",type:"isolation_upper",axial:!1,prim:["Biceps"],sec:["Forearms"],ter:[]},{id:20,name:"Hammer Curl",type:"isolation_upper",axial:!1,prim:["Biceps","Forearms"],sec:[],ter:[]},{id:21,name:"Tricep Pushdown",type:"isolation_upper",axial:!1,prim:["Triceps"],sec:[],ter:[]},{id:22,name:"Overhead Tricep Extension",type:"isolation_upper",axial:!1,prim:["Triceps"],sec:[],ter:[]},{id:23,name:"Dips",type:"compound_upper",axial:!1,prim:["Triceps","Chest"],sec:["Shoulders"],ter:[]},{id:24,name:"Barbell Squat",type:"compound_lower",axial:!0,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:["Abs","Calves"]},{id:25,name:"Front Squat",type:"compound_lower",axial:!0,prim:["Quads"],sec:["Glutes"],ter:["Abs","Hamstrings"]},{id:26,name:"Leg Press",type:"compound_lower",axial:!1,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:[]},{id:27,name:"Romanian Deadlift",type:"compound_lower",axial:!0,prim:["Hamstrings"],sec:["Glutes","Back"],ter:["Forearms"]},{id:28,name:"Leg Curl",type:"isolation_lower",axial:!1,prim:["Hamstrings"],sec:[],ter:[]},{id:29,name:"Leg Extension",type:"isolation_lower",axial:!1,prim:["Quads"],sec:[],ter:[]},{id:30,name:"Bulgarian Split Squat",type:"compound_lower",axial:!1,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:["Abs"]},{id:31,name:"Lunges",type:"compound_lower",axial:!1,prim:["Quads"],sec:["Glutes","Hamstrings"],ter:[]},{id:32,name:"Hip Thrust",type:"compound_lower",axial:!1,prim:["Glutes"],sec:["Hamstrings"],ter:[]},{id:33,name:"Calf Raises",type:"isolation_lower",axial:!1,prim:["Calves"],sec:[],ter:[]},{id:34,name:"Plank",type:"isolation_upper",axial:!1,prim:["Abs"],sec:["Shoulders"],ter:[]},{id:35,name:"Cable Crunch",type:"isolation_upper",axial:!1,prim:["Abs"],sec:[],ter:[]},{id:36,name:"Hanging Leg Raise",type:"isolation_upper",axial:!1,prim:["Abs"],sec:[],ter:["Forearms"]},{id:37,name:"Russian Twist",type:"isolation_upper",axial:!1,prim:["Abs"],sec:[],ter:[]},{id:38,name:"Barbell Shrug",type:"isolation_upper",axial:!1,prim:["Traps"],sec:["Forearms"],ter:[]},{id:39,name:"Dumbbell Shrug",type:"isolation_upper",axial:!1,prim:["Traps"],sec:["Forearms"],ter:[]},{id:40,name:"Wrist Curl",type:"isolation_upper",axial:!1,prim:["Forearms"],sec:[],ter:[]},{id:41,name:"Farmer Carry",type:"compound_upper",axial:!0,prim:["Forearms","Traps"],sec:["Abs"],ter:["Calves"]}];function Ve(){return[...as]}function ns(){const[t,s]=c.useState([]),[r,a]=c.useState(!1),[n,l]=c.useState(null),g=c.useCallback(async()=>{a(!0),l(null);try{const w=await Q.loadCollection(te.EXERCISES);if(w&&w.length>0)s(w);else{const h=Ve();s(h),await Q.saveCollection(te.EXERCISES,h)}}catch(w){console.error("Failed to load exercises:",w),l(w.message);const h=Ve();s(h)}finally{a(!1)}},[]),o=c.useCallback(async w=>{try{return await Q.saveCollection(te.EXERCISES,w),s(w),!0}catch(h){return console.error("Failed to save exercises:",h),l(h.message),!1}},[]),i=c.useCallback(async w=>{try{const h=t.length>0?Math.max(...t.map(L=>L.id))+1:1,F={...w,id:h,createdAt:new Date().toISOString()},_=[...t,F];return await o(_)?F:null}catch(h){return console.error("Failed to add exercise:",h),l(h.message),null}},[t,o]),S=c.useCallback(async(w,h)=>{try{const F=t.map(_=>_.id===w?{..._,...h,updatedAt:new Date().toISOString()}:_);return await o(F)}catch(F){return console.error("Failed to update exercise:",F),l(F.message),!1}},[t,o]),p=c.useCallback(async w=>{try{const h=t.filter(F=>F.id!==w);return await o(h)}catch(h){return console.error("Failed to delete exercise:",h),l(h.message),!1}},[t,o]),N=c.useCallback(w=>t.find(h=>h.id===w)||null,[t]),v=c.useCallback(w=>t.filter(h=>{var F,_,U;return((F=h.prim)==null?void 0:F.includes(w))||((_=h.sec)==null?void 0:_.includes(w))||((U=h.ter)==null?void 0:U.includes(w))}),[t]),f=c.useCallback(w=>t.filter(h=>h.type===w),[t]),d=c.useCallback(w=>{const h=w.toLowerCase();return t.filter(F=>F.name.toLowerCase().includes(h))},[t]),u=c.useCallback(async()=>{try{const w=Ve();return await o(w)}catch(w){return console.error("Failed to reset exercises:",w),l(w.message),!1}},[o]),y=c.useCallback(async w=>{try{const h=new Set(t.map(L=>L.name.toLowerCase()));let F=t.length>0?Math.max(...t.map(L=>L.id)):0;const _=w.filter(L=>!h.has(L.name.toLowerCase())).map(L=>({...L,id:++F,createdAt:new Date().toISOString()})),U=[...t,..._];return await o(U)}catch(h){return console.error("Failed to import exercises:",h),l(h.message),!1}},[t,o]),C=c.useCallback(()=>t.length,[t]);return c.useEffect(()=>{g()},[g]),{exercises:t,isLoading:r,error:n,addExercise:i,updateExercise:S,deleteExercise:p,getExerciseById:N,getExercisesByMuscle:v,getExercisesByType:f,searchExercises:d,loadExercises:g,resetToPresets:u,importExercises:y,getExerciseCount:C}}function ls(t){const[s,r]=c.useState([]),[a,n]=c.useState(null),[l,g]=c.useState(0),[o,i]=c.useState(!1),[S,p]=c.useState(null),N=c.useCallback(async()=>{i(!0),p(null);try{const m=await Q.loadCollection(te.PROGRAMS);r(m||[])}catch(m){console.error("Failed to load programs:",m),p(m.message),r([])}finally{i(!1)}},[]),v=c.useCallback(async()=>{if(t)try{const m=await Q.loadActiveProgram(t);if(m&&m.programId){const T=(await Q.loadCollection(te.PROGRAMS)).find(B=>B.id===m.programId);T?(n(T),g(m.currentDayIndex||0)):await Q.saveActiveProgram(t,null)}}catch(m){console.error("Failed to load active program:",m)}},[t]),f=c.useCallback(async(m,x)=>{if(t)try{await Q.saveActiveProgram(t,{programId:m,currentDayIndex:x})}catch(T){console.error("Failed to save active program state:",T)}},[t]),d=c.useCallback(async m=>{try{return await Q.saveCollection(te.PROGRAMS,m),r(m),!0}catch(x){return console.error("Failed to save programs:",x),p(x.message),!1}},[]),u=c.useCallback(async m=>{try{const x=s.length>0?Math.max(...s.map(k=>k.id))+1:1,T={...m,id:x,createdAt:new Date().toISOString()},B=[...s,T];return await d(B)?T:null}catch(x){return console.error("Failed to add program:",x),p(x.message),null}},[s,d]),y=c.useCallback(async(m,x)=>{try{const T=s.map(Y=>Y.id===m?{...Y,...x,updatedAt:new Date().toISOString()}:Y),B=await d(T);if(B&&(a==null?void 0:a.id)===m){const Y=T.find(k=>k.id===m);n(Y),await f(m,l)}return B}catch(T){return console.error("Failed to update program:",T),p(T.message),!1}},[s,a,l,d,f]),C=c.useCallback(async m=>{try{const x=s.filter(B=>B.id!==m),T=await d(x);return T&&(a==null?void 0:a.id)===m&&await F(),T}catch(x){return console.error("Failed to delete program:",x),p(x.message),!1}},[s,a,d]),w=c.useCallback(m=>s.find(x=>x.id===m)||null,[s]),h=c.useCallback(async m=>{if(!t)return p("User ID required to start program"),!1;try{const x=w(m);return x?(n(x),g(0),await f(m,0),!0):(p("Program not found"),!1)}catch(x){return console.error("Failed to start program:",x),p(x.message),!1}},[t,w,f]),F=c.useCallback(async()=>{if(!t)return!1;try{return n(null),g(0),await Q.saveActiveProgram(t,null),!0}catch(m){return console.error("Failed to stop program:",m),p(m.message),!1}},[t]),_=c.useCallback(async()=>{if(!a||!a.days)return null;try{const m=(l+1)%a.days.length;return g(m),t&&await f(a.id,m),a.days[m]}catch(m){return console.error("Failed to advance day:",m),p(m.message),null}},[a,l,t,f]),U=c.useCallback(async m=>{if(!a||!a.days)return!1;if(m<0||m>=a.days.length)return p("Invalid day index"),!1;try{return g(m),t&&await f(a.id,m),!0}catch(x){return console.error("Failed to go to day:",x),p(x.message),!1}},[a,t,f]),L=c.useCallback(()=>!a||!a.days||a.days.length===0?null:a.days[l]||null,[a,l]),O=c.useCallback(()=>!a||!a.days?{currentDay:0,totalDays:0,percentage:0,daysCompleted:0}:{currentDay:l+1,totalDays:a.days.length,percentage:(l+1)/a.days.length*100,daysCompleted:l},[a,l]),j=c.useCallback(async m=>{const x=w(m);if(!x)return p("Program not found"),null;const T={...x,name:`${x.name} (Copy)`,id:void 0};return await u(T)},[w,u]),H=c.useCallback(()=>s.length,[s]);return c.useEffect(()=>{N()},[N]),c.useEffect(()=>{v()},[v]),{programs:s,activeProgram:a,currentDayIndex:l,isLoading:o,error:S,addProgram:u,updateProgram:y,deleteProgram:C,duplicateProgram:j,getProgramById:w,getProgramCount:H,startProgram:h,stopProgram:F,advanceToNextDay:_,goToDay:U,getCurrentDay:L,getProgramProgress:O,loadPrograms:N}}const xt={compound_upper:{name:"Compound Upper",description:"Multi-joint upper body movements",fatigueMultiplier:1.2,systemicFatigueImpact:.15,recommendedRepRange:{min:5,max:12},recommendedSets:{min:3,max:6},progressionIncrement:2.5,examples:["Bench Press","Pull-ups","Overhead Press","Rows"]},compound_lower:{name:"Compound Lower",description:"Multi-joint lower body movements",fatigueMultiplier:1.5,systemicFatigueImpact:.25,recommendedRepRange:{min:5,max:15},recommendedSets:{min:3,max:6},progressionIncrement:5,examples:["Squat","Deadlift","Lunges","Leg Press"]},isolation_upper:{name:"Isolation Upper",description:"Single-joint upper body movements",fatigueMultiplier:.8,systemicFatigueImpact:.05,recommendedRepRange:{min:8,max:20},recommendedSets:{min:2,max:5},progressionIncrement:2.5,examples:["Bicep Curls","Tricep Extensions","Lateral Raises","Flyes"]},isolation_lower:{name:"Isolation Lower",description:"Single-joint lower body movements",fatigueMultiplier:.9,systemicFatigueImpact:.08,recommendedRepRange:{min:10,max:20},recommendedSets:{min:2,max:5},progressionIncrement:5,examples:["Leg Curls","Leg Extensions","Calf Raises","Hip Abduction"]}};function os(t){return t==="compound_upper"||t==="compound_lower"}function Ze(t){const s=xt[t];return s?s.progressionIncrement:2.5}function is(t,s,r=0){const a=s+r;return t*(1+a/30)}function Ye(t,s,r,a){const{w:n,r:l,rir:g}=t,o=Math.exp(-.3*g),i=a>0?n/a:.5,S=r==="primary"?Z.PRIMARY_MUSCLE_MULTIPLIER:r==="secondary"?Z.SECONDARY_MUSCLE_MULTIPLIER:Z.TERTIARY_MUSCLE_MULTIPLIER;return o*i*S}function ze(t,s,r,a=!1){const{w:n,r:l}=t,g=n*l,o=r==="primary"?Z.PRIMARY_MUSCLE_MULTIPLIER:r==="secondary"?Z.SECONDARY_MUSCLE_MULTIPLIER:Z.TERTIARY_MUSCLE_MULTIPLIER,i=a?Z.AXIAL_LOAD_MULTIPLIER:1;return g*o*i}function cs(t,s,r=!1){const{w:a,r:n}=t;if(!os(s))return 0;const l=a*n,g=r?Z.AXIAL_LOAD_MULTIPLIER:1,o=Z.COMPOUND_SYSTEMIC_MULTIPLIER;return l*g*o}function ds(t){const{sets:s,type:r,axial:a,prim:n=[],sec:l=[],ter:g=[]}=t;if(!s||s.length===0)return{stimulus:{},localFatigue:{},systemicFatigue:0,setCount:0};const o=s.reduce((v,f)=>f.w*f.r>v.w*v.r?f:v,s[0]),i=is(o.w,o.r,o.rir),S={},p={};let N=0;return s.forEach(v=>{n.forEach(f=>{S[f]=(S[f]||0)+Ye(v,f,"primary",i),p[f]=(p[f]||0)+ze(v,f,"primary",a)}),l.forEach(f=>{S[f]=(S[f]||0)+Ye(v,f,"secondary",i),p[f]=(p[f]||0)+ze(v,f,"secondary",a)}),g.forEach(f=>{S[f]=(S[f]||0)+Ye(v,f,"tertiary",i),p[f]=(p[f]||0)+ze(v,f,"tertiary",a)}),N+=cs(v,r,a)}),{stimulus:S,localFatigue:p,systemicFatigue:N,setCount:s.length,estimated1RM:i}}function us(t,s){const{localFatigue:r={},systemicFatigue:a=0}=t,{rirError:n=0,soreness:l={},perceivedFatigue:g=5}=s,o={...r};let i=a;if(n<0){const p=Math.abs(n)*Z.RIR_MISS_FATIGUE_PENALTY;i+=p,Object.keys(r).forEach(N=>{o[N]=(o[N]||0)+p})}Object.entries(l).forEach(([p,N])=>{if(N>0){const v=N/10*Z.SORENESS_FATIGUE_WEIGHT;o[p]=(o[p]||0)*(1+v)}});const S=g-5;if(S!==0){const p=S/5*Z.PERCEIVED_FATIGUE_WEIGHT;i*=1+p}return{localFatigue:o,systemicFatigue:i}}function gs(t,s,r,a=null){const{localFatigue:n={},systemicFatigue:l=0,weeklyStimulus:g={},perceivedFatigue:o=5,muscleSoreness:i={},lastWorkoutDate:S=null}=r;if(a!=null&&a.isRestDay||t.length===0&&a){const _=We({localFatigue:n,systemicFatigue:l},S||s,s,{plannedRestDays:1});return{localFatigue:_.localFatigue,systemicFatigue:_.systemicFatigue,weeklyStimulus:g,sessionStimulus:{},muscleReadiness:Fe(_.localFatigue),systemicReadiness:Me(_.systemicFatigue),lastWorkoutDate:S,isRestDay:!0}}let p=0;a!=null&&a.activeProgram&&S&&(p=ms(a.activeProgram,a.lastDayIndex||0,a.currentDayIndex||0));const N=We({localFatigue:n,systemicFatigue:l},S,s,{plannedRestDays:p}),v={...N.localFatigue};let f=N.systemicFatigue;const d={...g},u={};t.forEach(_=>{const U=ds(_);Object.entries(U.stimulus).forEach(([L,O])=>{u[L]=(u[L]||0)+O,d[L]=(d[L]||0)+O}),Object.entries(U.localFatigue).forEach(([L,O])=>{v[L]=(v[L]||0)+O}),f+=U.systemicFatigue});const y=us({localFatigue:v,systemicFatigue:f},{rirError:0,soreness:i,perceivedFatigue:o}),C={};Object.entries(y.localFatigue).forEach(([_,U])=>{C[_]=Math.log1p(U/1e3)});const w=Math.log1p(y.systemicFatigue/1e3),h=Fe(C),F=Me(w);return{localFatigue:C,systemicFatigue:w,weeklyStimulus:d,sessionStimulus:u,muscleReadiness:h,systemicReadiness:F,lastWorkoutDate:s,restBonus:N.restBonus,isRestDay:!1}}function ms(t,s,r){var l;if(!t||!t.days)return 0;let a=0,n=s;for(;n!==r&&(n=(n+1)%t.days.length,n!==r);)(l=t.days[n])!=null&&l.isRestDay&&a++;return a}function We(t,s,r,a=null){if(!s)return t;const n=ps(s,r);if(n<=0)return t;const{localFatigue:l={},systemicFatigue:g=0}=t;let o=1;a&&a.plannedRestDays>0&&(o=1+Math.min(.5,a.plannedRestDays*.1));const i=Z.LOCAL_RECOVERY_RATE*o,S=Z.SYSTEMIC_RECOVERY_RATE*o,p={};Object.entries(l).forEach(([v,f])=>{p[v]=Math.max(0,f*Math.exp(-i*n))});const N=Math.max(0,g*Math.exp(-S*n));return{localFatigue:p,systemicFatigue:N,restBonus:o}}function Fe(t){const s={};return ae.forEach(r=>{const a=t[r]||0;s[r]=Math.exp(-a)}),s}function Me(t){return Math.exp(-t)}function et(t,s){const r={};return Object.entries(t).forEach(([a,n])=>{r[a]=Math.max(0,n*Math.exp(-.14*s))}),r}function xs(t,s,r={}){const a=Z.DELOAD_THRESHOLD;if(s<.35)return{needed:!0,type:"systemic",severity:"high",message:"Systemic fatigue is critically high - immediate deload needed",recommendation:"Reduce volume 40-60%, increase RIR by 2-3, remove axial loads"};if(s<a)return{needed:!0,type:"systemic",severity:"moderate",message:"Systemic deload needed - reduce overall training volume",recommendation:"Reduce sets by 40%, increase RIR by 2, lighter axial loads"};const n=Object.entries(t).filter(([l,g])=>g<a).map(([l,g])=>({muscle:l,readiness:g}));return n.length>0?{needed:!0,type:"local",severity:n.length>3?"high":"moderate",muscles:n,message:`Local deload needed for: ${n.map(l=>l.muscle).join(", ")}`,recommendation:"Reduce volume 30-40% for affected muscles, add 1-2 RIR"}:{needed:!1,type:null,severity:"none",message:"Recovery is adequate"}}function ps(t,s){const r=new Date(t),a=new Date(s),n=Math.abs(a-r);return Math.floor(n/(1e3*60*60*24))}function hs(t,s){const r={};return Object.keys(t).forEach(a=>{const n=t[a]||0,l=s[a]||.001;r[a]=n/l}),r}function bs(t,s=[]){const[r,a]=c.useState({}),[n,l]=c.useState(0),[g,o]=c.useState({}),[i,S]=c.useState([]),[p,N]=c.useState({}),[v,f]=c.useState(1),[d,u]=c.useState(5),[y,C]=c.useState({}),w=c.useRef(!0),[h,F]=c.useState([]),[_,U]=c.useState([]),[L,O]=c.useState(null),[j,H]=c.useState(null),[m,x]=c.useState(!1),[T,B]=c.useState(null),Y=E=>{if(E==null)return null;if(typeof E!="object")return E;if(Array.isArray(E))return E.filter(b=>b!==void 0).map(b=>Y(b));const I={};return Object.keys(E).forEach(b=>{const R=E[b];R!==void 0&&(Array.isArray(R)?I[b]=R.filter(A=>A!==void 0).map(A=>Y(A)):R&&typeof R=="object"?I[b]=Y(R):I[b]=R)}),I},k=c.useCallback(async()=>{if(!t){ce();return}x(!0),B(null);try{const E=await Q.loadFatigueState(t);if(E&&Object.keys(E).length>0){a(E.localFatigue||{}),l(E.systemicFatigue||0),o(E.weeklyStimulus||{}),S(E.stimulusHistory||[]),O(E.lastWorkoutDate||null),H(E.lastUpdateDate||null),F(E.performanceErrors||[]),U(E.readinessHistory||[]);const I=Fe(E.localFatigue||{}),b=Me(E.systemicFatigue||0);if(N(I),f(b),E.lastUpdateDate){const R=new Date,A=new Date(E.lastUpdateDate),M=tt(A,R);if(M>.01){console.log("ðŸ“… Time since last update:",M.toFixed(2),"days"),console.log("  Applying recovery...");const G=We({localFatigue:E.localFatigue||{},systemicFatigue:E.systemicFatigue||0},E.lastUpdateDate,R.toISOString(),null);a(G.localFatigue),l(G.systemicFatigue),H(R.toISOString());const J=Fe(G.localFatigue),ne=Me(G.systemicFatigue);N(J),f(ne);const fe=et(E.weeklyStimulus||{},M);o(fe),w.current=!1}else w.current=!1}else w.current=!1}else ce(),w.current=!1}catch(E){console.error("Failed to load fatigue state:",E),B(E.message),ce()}finally{x(!1)}},[t]),$=c.useCallback(async()=>{if(!t)throw new Error("User ID required to save fatigue state");try{console.log("ðŸ’¾ Saving fatigue state...");const E={localFatigue:r,systemicFatigue:n,weeklyStimulus:g,stimulusHistory:i,lastWorkoutDate:L,lastUpdateDate:new Date().toISOString().split("T")[0],performanceErrors:h,readinessHistory:_};console.log("  Raw data:",E);try{JSON.stringify(E)}catch(b){console.error("  âŒ Data contains non-serializable values:",b)}const I=Y(E);console.log("  Cleaned data:",I);try{const b=JSON.stringify(I);console.log("  Stringified successfully, length:",b.length)}catch(b){console.error("  âŒ Cleaned data still has issues:",b)}return await Q.saveFatigueState(t,I),console.log("  âœ… Fatigue saved successfully"),!0}catch(E){return console.error("Failed to save fatigue state:",E),B(E.message),!1}},[t,r,n,g,i,L,h,_]),V=c.useCallback(async(E,I,b={},R=null)=>{console.log("ðŸ‹ï¸ processWorkoutSession:"),console.log("  observationalData received:",b);try{const A=R?{...R,workoutHistory:s}:{workoutHistory:s},M=gs(E,I,{localFatigue:r,systemicFatigue:n,weeklyStimulus:g,perceivedFatigue:b.perceivedFatigue||d,muscleSoreness:b.muscleSoreness||y,lastWorkoutDate:L},A);if(console.log("ðŸ“Š Updating fatigue state after session:"),console.log("  weeklyStimulus:",M.weeklyStimulus),console.log("  sessionStimulus:",M.sessionStimulus),console.log("  totalStimulus:",Object.values(M.weeklyStimulus||{}).reduce((ie,xe)=>ie+xe,0)),a(M.localFatigue),l(M.systemicFatigue),o(M.weeklyStimulus),N(M.muscleReadiness),f(M.systemicReadiness),M.isRestDay||O(M.lastWorkoutDate),H(new Date().toISOString()),!M.isRestDay&&M.sessionStimulus){const ie=[...i.slice(-6),{date:I,stimulus:M.sessionStimulus,totalStimulus:Object.values(M.sessionStimulus).reduce((xe,Re)=>xe+Re,0)}];S(ie)}const G=[..._.slice(-6),{date:I,systemicReadiness:M.systemicReadiness,avgMuscleReadiness:Object.values(M.muscleReadiness).reduce((ie,xe)=>ie+xe,0)/ae.length,isRestDay:M.isRestDay||!1,actualRestDays:M.actualRestDays,plannedRestDays:M.plannedRestDays,perceivedFatigue:b.perceivedFatigue||d,muscleSoreness:b.muscleSoreness||y}],J=G[G.length-1];if(console.log("ðŸ“ New readiness entry:"),console.log("  Full object:",JSON.stringify(J,null,2)),console.log("  perceivedFatigue:",J.perceivedFatigue),console.log("  muscleSoreness:",J.muscleSoreness),U(G),!M.isRestDay&&b.rirErrors&&b.rirErrors.length>0){const ie=[...h.slice(-9),{date:I,errors:b.rirErrors}];F(ie)}console.log("ðŸ’¾ Saving fatigue from processWorkoutSession...");const ne={localFatigue:M.localFatigue,systemicFatigue:M.systemicFatigue,weeklyStimulus:M.weeklyStimulus,stimulusHistory:(M.isRestDay,i),lastWorkoutDate:M.isRestDay?L:M.lastWorkoutDate,lastUpdateDate:I,performanceErrors:h,readinessHistory:G};console.log("  Raw fatigue data:",ne);const fe=Y(ne);console.log("  Cleaned fatigue data:",fe);const Ae=(ie,xe="")=>{Object.keys(ie).forEach(Re=>{const ye=ie[Re],De=xe?`${xe}.${Re}`:Re;ye===void 0?console.error(`  âŒ FOUND UNDEFINED at: ${De}`):ye&&typeof ye=="object"&&!Array.isArray(ye)?Ae(ye,De):Array.isArray(ye)&&ye.forEach((Ce,Le)=>{Ce===void 0?console.error(`  âŒ FOUND UNDEFINED at: ${De}[${Le}]`):Ce&&typeof Ce=="object"&&Ae(Ce,`${De}[${Le}]`)})})};return Ae(fe),await Q.saveFatigueState(t,fe),console.log("  âœ… Fatigue from processWorkoutSession saved"),!0}catch(A){return console.error("Failed to process workout session:",A),B(A.message),!1}},[t,r,n,g,i,d,y,L,h,_,s]),z=c.useCallback((E,I=null)=>{if(console.log("ðŸ”„ APPLY RECOVERY CALLED"),console.log("  currentDate:",E),console.log("  lastUpdateDate:",j),console.log("  lastWorkoutDate:",L),console.log("  BEFORE recovery:"),console.log("    localFatigue:",r),console.log("    systemicFatigue:",n),!j&&!L)return{localFatigue:r,systemicFatigue:n};const R=We({localFatigue:r,systemicFatigue:n},j||L,E,I);console.log("  AFTER recovery:"),console.log("    recovered.localFatigue:",R.localFatigue),console.log("    recovered.systemicFatigue:",R.systemicFatigue),a(R.localFatigue),l(R.systemicFatigue),H(typeof E=="string"?E:E.toISOString());const A=Fe(R.localFatigue),M=Me(R.systemicFatigue);console.log("  Calculated readiness:"),console.log("    muscleReadiness:",A),console.log("    systemicReadiness:",M),N(A),f(M);const G=j?tt(j,E):0;if(console.log("ðŸ“‰ Weekly Stimulus Decay Check:"),console.log("  Last update date:",j),console.log("  Current date:",E),console.log("  Days since:",G),console.log("  Current weeklyStimulus:",g),G>0){const J=et(g,G);console.log("  Decayed weeklyStimulus:",J),o(J)}return R},[r,n,g,L,j]),K=c.useCallback(()=>{let E=0;const I=[];v<Z.DELOAD_THRESHOLD&&(E++,I.push("Low systemic readiness")),Object.values(y).filter(G=>G>6).length>2&&(E++,I.push("Persistent muscle soreness"));const R=i.slice(-3).map(G=>G.totalStimulus);if(R.length>=3){const G=R.reduce((ne,fe)=>ne+fe,0)/R.length;R.every(ne=>Math.abs(ne-G)<G*.1)&&v>.65&&(E++,I.push("Stimulus plateau despite recovery"))}const A=h.slice(-2);A.length>=Z.PERFORMANCE_ERROR_SESSIONS&&A.every(J=>J.errors.some(ne=>ne<Z.PERFORMANCE_ERROR_THRESHOLD))&&(E++,I.push("Consistent performance decline"));const M=xs(p,v);return M.needed||E>=Z.DELOAD_MIN_CONDITIONS?{...M,needed:!0,conditionsMet:E,conditions:I,message:M.needed?M.message:`Deload recommended: ${E} conditions met`}:M},[p,v,y,i,h]),oe=c.useCallback(()=>{var A;if(i.length===0)return{efficiency:{},trend:"insufficient_data"};const E=((A=i[i.length-1])==null?void 0:A.stimulus)||{},I=hs(E,r),b=i.slice(-4).map(M=>M.totalStimulus),R=b.length>=4&&b.every((M,G,J)=>G===0||M>=J[G-1])?"increasing":b.length>=4&&b.every((M,G,J)=>G===0||M<=J[G-1])?"decreasing":"stable";return{efficiency:I,trend:R,recentStimulus:b}},[r,i]),re=c.useCallback(()=>{const E={};Object.entries(r).forEach(([b,R])=>{if(R>0){const M=Z.LOCAL_RECOVERY_RATE;try{const G=-Math.log(.85);if(R<=G)E[b]=0;else{const J=Math.log(R/G)/M;E[b]=Math.max(0,Math.ceil(J))}}catch{E[b]=0}}else E[b]=0});let I=0;if(n>0)try{const b=-Math.log(.85),R=Z.SYSTEMIC_RECOVERY_RATE;n>b&&(I=Math.ceil(Math.log(n/b)/R))}catch{I=0}return{muscleRecoveryDays:E,systemicRecoveryDays:I,maxRecoveryDays:Math.max(I,...Object.values(E))}},[r,n]),me=c.useCallback(E=>{u(Math.max(0,Math.min(10,E)))},[]),we=c.useCallback((E,I)=>{C(b=>({...b,[E]:Math.max(0,Math.min(10,I))}))},[]),Se=c.useCallback(()=>{C({})},[]),Ne=c.useCallback(E=>p[E]||1,[p]),be=c.useCallback(E=>r[E]||0,[r]),Ee=c.useCallback(E=>g[E]||0,[g]),ce=c.useCallback(()=>{a({}),l(0),o({}),S([]),O(null),H(null),u(5),C({}),F([]),U([]);const E={};ae.forEach(I=>{E[I]=1}),N(E),f(1)},[]),ee=c.useCallback(()=>{const E=ae.reduce((R,A)=>R+(p[A]||1),0)/ae.length,I=K();let b="optimal";return v<.6||E<.6?b="poor":v<.75||E<.75?b="moderate":(v<.85||E<.85)&&(b="good"),{status:b,systemicReadiness:v,avgMuscleReadiness:E,deloadNeeded:I.needed,deloadMessage:I.message,deloadConditions:I.conditions||[]}},[p,v,K]),X=c.useCallback((E,I)=>{const b={...r};b[E]=Math.max(0,I),a(b);const R=Fe(b);N(R)},[r]);return c.useEffect(()=>{k()},[k]),c.useEffect(()=>{if(t&&!m){const E=setTimeout(()=>{$()},1e3);return()=>clearTimeout(E)}},[t,r,n,g,i,m,$]),c.useEffect(()=>{if(!w.current&&j&&!m){const E=new Date,I=new Date(j),b=(E-I)/(1e3*60*60);b>=1&&(console.log(`ðŸ• Auto-recovery triggered - ${b.toFixed(1)} hours since last update`),z(E.toISOString()))}},[j]),c.useEffect(()=>{if(!t||m)return;const E=setInterval(()=>{if(j){const I=new Date,b=new Date(j),R=(I-b)/(1e3*60*60);R>=1&&(console.log(`ðŸ• Periodic recovery check - ${R.toFixed(1)} hours since last update`),z(I.toISOString()))}},30*60*1e3);return()=>clearInterval(E)},[t,m,j]),{localFatigue:r,systemicFatigue:n,weeklyStimulus:g,stimulusHistory:i,muscleReadiness:p,systemicReadiness:v,lastWorkoutDate:L,perceivedFatigue:d,muscleSoreness:y,performanceErrors:h,readinessHistory:_,isLoading:m,error:T,processWorkoutSession:V,applyRecovery:z,getMuscleReadiness:Ne,getMuscleFatigue:be,getMuscleStimulus:Ee,getDeloadRecommendation:K,getRecoveryTimeline:re,getRecoveryStatus:ee,getStimulusEfficiency:oe,updatePerceivedFatigue:me,updateMuscleSoreness:we,clearMuscleSoreness:Se,setManualFatigue:X,loadFatigueState:k,saveFatigueState:$,resetFatigueState:ce}}function tt(t,s){const r=typeof t=="string"?new Date(t):new Date(t),a=typeof s=="string"?new Date(s):new Date(s),l=Math.abs(a-r)/(1e3*60*60),g=l/24;return console.log(`â±ï¸ Time difference: ${l.toFixed(1)} hours = ${g.toFixed(2)} days`),g}function fs(t=120){const[s,r]=c.useState(0),[a,n]=c.useState(!1),l=c.useRef(null),g=(v=t)=>{r(v),n(!0)},o=()=>{n(!1),r(0),l.current&&clearInterval(l.current)},i=()=>{n(!1)},S=()=>{s>0&&n(!0)},p=v=>{r(f=>f+v)};return c.useEffect(()=>(a&&s>0?l.current=setInterval(()=>{r(v=>v<=1?(n(!1),0):v-1)},1e3):l.current&&clearInterval(l.current),()=>{l.current&&clearInterval(l.current)}),[a,s]),{timeRemaining:s,isActive:a,start:g,stop:o,pause:i,resume:S,addTime:p,formattedTime:(()=>{const v=Math.floor(s/60),f=s%60;return`${v}:${f.toString().padStart(2,"0")}`})()}}const je={themeColor:"blue",restTimerEnabled:!0,defaultRestTime:120},st={blue:{name:"Blue",primary:"bg-blue-600 hover:bg-blue-700",light:"bg-blue-50 border-blue-200",text:"text-blue-900",accent:"text-blue-700"},green:{name:"Green",primary:"bg-green-600 hover:bg-green-700",light:"bg-green-50 border-green-200",text:"text-green-900",accent:"text-green-700"},purple:{name:"Purple",primary:"bg-purple-600 hover:bg-purple-700",light:"bg-purple-50 border-purple-200",text:"text-purple-900",accent:"text-purple-700"},orange:{name:"Orange",primary:"bg-orange-600 hover:bg-orange-700",light:"bg-orange-50 border-orange-200",text:"text-orange-900",accent:"text-orange-700"},red:{name:"Red",primary:"bg-red-600 hover:bg-red-700",light:"bg-red-50 border-red-200",text:"text-red-900",accent:"text-red-700"},indigo:{name:"Indigo",primary:"bg-indigo-600 hover:bg-indigo-700",light:"bg-indigo-50 border-indigo-200",text:"text-indigo-900",accent:"text-indigo-700"},pink:{name:"Pink",primary:"bg-pink-600 hover:bg-pink-700",light:"bg-pink-50 border-pink-200",text:"text-pink-900",accent:"text-pink-700"},teal:{name:"Teal",primary:"bg-teal-600 hover:bg-teal-700",light:"bg-teal-50 border-teal-200",text:"text-teal-900",accent:"text-teal-700"}};function ys(t){const[s,r]=c.useState(je),[a,n]=c.useState(!1),[l,g]=c.useState(null);return c.useEffect(()=>{if(!t){r(je),n(!0),g(null);return}(async()=>{try{const p=await Q.loadSettings(t);if(p){const{userId:N,updatedAt:v,...f}=p,d={...je,...f};r(d),g(JSON.stringify(d)),console.log("âœ… Loaded settings from database")}else r(je),g(JSON.stringify(je)),console.log("â„¹ï¸ No settings found, using defaults")}catch(p){console.error("Failed to load settings:",p),r(je),g(JSON.stringify(je))}finally{n(!0)}})()},[t]),c.useEffect(()=>{if(!t||!a)return;const S=JSON.stringify(s);if(S===l)return;const N=setTimeout(async()=>{try{await Q.saveSettings(t,s),g(S),console.log("âœ… Saved settings to database")}catch(v){console.error("Failed to save settings:",v)}},500);return()=>clearTimeout(N)},[s,t,a,l]),{settings:s,updateSetting:(S,p)=>{r(N=>({...N,[S]:p}))},resetSettings:()=>{r(je)},themeColors:st,currentTheme:st[s.themeColor],isLoaded:a}}function vs({onLogin:t}){const[s,r]=c.useState("login"),[a,n]=c.useState(""),[l,g]=c.useState(""),[o,i]=c.useState(""),[S,p]=c.useState(""),[N,v]=c.useState(!1),[f,d]=c.useState(!1),u=async w=>{if(w.preventDefault(),p(""),!a.trim()){p("Please enter a username");return}if(!l){p("Please enter a password");return}if(s==="register"){if(a.trim().length<3){p("Username must be at least 3 characters");return}if(l.length<6){p("Password must be at least 6 characters");return}if(!o){p("Please confirm your password");return}if(l!==o){p("Passwords do not match");return}}v(!0);try{const h=s==="register",F=await t(a.trim(),l,h);F.success||p(F.error||"Authentication failed")}catch(h){p(h.message||"An error occurred. Please try again.")}finally{v(!1)}},y=()=>{r(s==="login"?"register":"login"),p(""),g(""),i("")},C=w=>{w.key==="Enter"&&u(w)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-600 rounded-full mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsx("h1",{className:"text-3xl font-bold mb-2 text-slate-900",children:"Workout Tracker"}),e.jsx("p",{className:"text-slate-600",children:s==="login"?"Welcome back!":"Create your account"})]}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Username"}),e.jsx("input",{id:"username",type:"text",value:a,onChange:w=>n(w.target.value),onKeyPress:C,placeholder:"Enter your username",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg text-lg focus:outline-none focus:border-blue-500 transition-colors",autoFocus:!0,disabled:N,autoComplete:"username"}),s==="register"&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"At least 3 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:f?"text":"password",value:l,onChange:w=>g(w.target.value),onKeyPress:C,placeholder:"Enter your password",className:"w-full px-4 py-3 pr-12 border-2 border-slate-300 rounded-lg text-lg focus:outline-none focus:border-blue-500 transition-colors",disabled:N,autoComplete:s==="login"?"current-password":"new-password"}),e.jsx("button",{type:"button",onClick:()=>d(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors",tabIndex:-1,children:f?e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),s==="register"&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"At least 6 characters"})]}),s==="register"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Confirm Password"}),e.jsx("input",{id:"confirmPassword",type:f?"text":"password",value:o,onChange:w=>i(w.target.value),onKeyPress:C,placeholder:"Confirm your password",className:"w-full px-4 py-3 border-2 border-slate-300 rounded-lg text-lg focus:outline-none focus:border-blue-500 transition-colors",disabled:N,autoComplete:"new-password"})]}),S&&e.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-red-700 text-sm font-medium",children:S})}),e.jsx("button",{type:"submit",disabled:N,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold text-lg hover:bg-blue-700 active:bg-blue-800 disabled:bg-blue-300 disabled:cursor-not-allowed transition-colors",children:N?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),s==="login"?"Logging in...":"Creating account..."]}):s==="login"?"Login":"Create Account"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:y,className:"text-sm text-blue-600 hover:text-blue-700 font-medium hover:underline",disabled:N,children:s==="login"?"Don't have an account? Register":"Already have an account? Login"})}),s==="register"&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-xs text-blue-700",children:"ðŸ”’ Your password is securely hashed and stored. Make sure to remember it!"})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"space-y-2 text-xs text-slate-500",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),"Your workouts and progress are private"]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),"Exercises and programs are shared globally"]})]})}),e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Features"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-blue-600 font-semibold text-sm mb-1",children:"ðŸ“Š Progress Tracking"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Log sets, reps, and weight"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-green-600 font-semibold text-sm mb-1",children:"ðŸ’ª Recovery Metrics"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Smart fatigue tracking"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-purple-600 font-semibold text-sm mb-1",children:"ðŸ“… Program Builder"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Create custom routines"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-orange-600 font-semibold text-sm mb-1",children:"ðŸ“ˆ Progression"}),e.jsx("p",{className:"text-xs text-slate-600",children:"AI-powered advice"})]})]})]})]})})}function rt({weight:t,reps:s,rir:r,onWeightChange:a,onRepsChange:n,onRirChange:l,onSubmit:g,onCancel:o,weightLabel:i="Weight (lbs)",repsLabel:S="Reps",rirLabel:p="RIR",submitLabel:N="Add Set",showCancel:v=!1,autoFocusReps:f=!1,disabled:d=!1}){const u=c.useRef(null),y=c.useRef(null);c.useEffect(()=>{f&&u.current&&u.current.focus()},[f]);const C=(h,F)=>{h.key==="Enter"&&(h.preventDefault(),F&&F.current?F.current.focus():t&&s&&r!==""&&g())},w=t&&s&&r!=="";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:i}),e.jsx("input",{type:"number",step:"0.5",value:t,onChange:h=>a(h.target.value),onKeyPress:h=>C(h,u),placeholder:"lbs",disabled:d,className:"w-full px-4 py-4 border-2 border-slate-300 rounded-lg text-lg text-center font-semibold focus:outline-none focus:border-blue-500 disabled:bg-slate-100 disabled:cursor-not-allowed transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:S}),e.jsx("input",{ref:u,type:"number",value:s,onChange:h=>n(h.target.value),onKeyPress:h=>C(h,y),placeholder:"reps",disabled:d,className:"w-full px-4 py-4 border-2 border-slate-300 rounded-lg text-lg text-center font-semibold focus:outline-none focus:border-blue-500 disabled:bg-slate-100 disabled:cursor-not-allowed transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:p}),e.jsx("input",{ref:y,type:"number",min:"0",max:"10",value:r,onChange:h=>l(h.target.value),onKeyPress:h=>{h.key==="Enter"&&w&&(h.preventDefault(),g())},placeholder:"RIR",disabled:d,className:"w-full px-4 py-4 border-2 border-slate-300 rounded-lg text-lg text-center font-semibold focus:outline-none focus:border-blue-500 disabled:bg-slate-100 disabled:cursor-not-allowed transition-colors"})]})]}),e.jsxs("div",{className:"text-xs text-slate-500 text-center",children:[e.jsx("span",{className:"font-semibold",children:"RIR"})," = Reps In Reserve (0 = failure, 3 = could do 3 more)"]}),e.jsxs("div",{className:`flex gap-2 ${v?"grid grid-cols-2":""}`,children:[e.jsx("button",{onClick:g,disabled:!w||d,className:`${v?"":"w-full"} bg-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-blue-700 active:bg-blue-800 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors`,children:N}),v&&e.jsx("button",{onClick:o,disabled:d,className:"bg-slate-400 text-white py-4 rounded-lg font-bold text-lg hover:bg-slate-500 active:bg-slate-600 disabled:bg-slate-200 disabled:cursor-not-allowed transition-colors",children:"Cancel"})]})]})}function js({progression:t,className:s=""}){if(!t)return null;const{advice:r,readiness:a,suggestion:n,reason:l,muscleReadiness:g,systemicReadiness:o}=t;if(r==="first_time")return e.jsxs("div",{className:`border-2 border-blue-200 bg-blue-50 rounded-lg p-4 ${s}`,children:[e.jsx("div",{className:"text-sm font-semibold text-blue-900 mb-1",children:"ðŸ’¡ First Time"}),e.jsx("p",{className:"text-sm text-blue-800",children:n})]});const S=(()=>{switch(a){case"deload":return{bg:"bg-orange-100",border:"border-orange-300",icon:"ðŸ”„",title:"DELOAD NEEDED",titleColor:"text-orange-900"};case"high":return{bg:"bg-green-50",border:"border-green-200",icon:r==="progress"?"ðŸ“ˆ":"ðŸ’ª",title:r==="progress"?"Progress":"Ready to Push",titleColor:"text-green-900"};case"low":return{bg:"bg-red-50",border:"border-red-200",icon:"âš ï¸",title:"Reduce Load",titleColor:"text-red-900"};case"moderate":default:return{bg:"bg-yellow-50",border:"border-yellow-200",icon:"âž¡ï¸",title:"Maintain",titleColor:"text-yellow-900"}}})();return e.jsxs("div",{className:`border-2 rounded-lg p-4 ${S.bg} ${S.border} ${s}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:`text-base font-bold ${S.titleColor}`,children:[S.icon," ",S.title]}),(g!==void 0||o!==void 0)&&e.jsxs("div",{className:"flex gap-2 text-xs",children:[g!==void 0&&e.jsxs("span",{className:"bg-white bg-opacity-50 px-2 py-1 rounded font-semibold",children:["M: ",(g*100).toFixed(0),"%"]}),o!==void 0&&e.jsxs("span",{className:"bg-white bg-opacity-50 px-2 py-1 rounded font-semibold",children:["S: ",(o*100).toFixed(0),"%"]})]})]}),e.jsx("p",{className:"text-sm leading-relaxed mb-2",children:n}),l&&e.jsx("div",{className:`text-sm font-semibold ${a==="deload"?"text-orange-700":"text-slate-700"}`,children:l}),(g!==void 0||o!==void 0)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-opacity-30",style:{borderColor:"currentColor"},children:[e.jsx("div",{className:"text-xs font-semibold mb-2 opacity-75",children:"Readiness"}),e.jsxs("div",{className:"space-y-2",children:[g!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs w-16",children:"Muscle:"}),e.jsx("div",{className:"flex-1 bg-white bg-opacity-30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${g>.85?"bg-green-600":g>.65?"bg-yellow-600":g>.5?"bg-orange-600":"bg-red-600"}`,style:{width:`${g*100}%`}})}),e.jsxs("span",{className:"text-xs w-10 text-right font-semibold",children:[(g*100).toFixed(0),"%"]})]}),o!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs w-16",children:"System:"}),e.jsx("div",{className:"flex-1 bg-white bg-opacity-30 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${o>.85?"bg-green-600":o>.65?"bg-yellow-600":o>.5?"bg-orange-600":"bg-red-600"}`,style:{width:`${o*100}%`}})}),e.jsxs("span",{className:"text-xs w-10 text-right font-semibold",children:[(o*100).toFixed(0),"%"]})]})]})]})]})}function pt({exercises:t,onSelect:s,placeholder:r="Select an exercise...",className:a="",exercisesByMuscle:n=null}){const[l,g]=c.useState(""),[o,i]=c.useState(""),[S,p]=c.useState(""),N=c.useMemo(()=>{if(n)return n;const y={};return t.forEach(C=>{y[C.muscle]||(y[C.muscle]=[]),y[C.muscle].push(C)}),y},[t,n]),v=c.useMemo(()=>{if(l&&N[l]){let y=N[l];return o&&(y=y.filter(C=>C.name.toLowerCase().includes(o.toLowerCase()))),y}return o?t.filter(y=>y.name.toLowerCase().includes(o.toLowerCase())):[]},[t,N,l,o]),f=y=>{g(y),p(""),i("")},d=y=>{i(y),g(""),p("")},u=y=>{p(y),y&&s&&(s(y),g(""),i(""),p(""))};return e.jsxs("div",{className:`space-y-3 ${a}`,children:[e.jsx("div",{children:e.jsx("input",{type:"text",value:o,onChange:y=>d(y.target.value),placeholder:"ðŸ” Search exercises...",className:"w-full px-4 py-3 border-2 rounded-lg text-base focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-1 border-t-2 border-gray-300"}),e.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"OR"}),e.jsx("div",{className:"flex-1 border-t-2 border-gray-300"})]}),e.jsx("div",{children:e.jsxs("select",{value:l,onChange:y=>f(y.target.value),className:"w-full px-4 py-3 border-2 rounded-lg text-base font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"1ï¸âƒ£ Select muscle group..."}),Object.entries(N).map(([y,C])=>e.jsxs("option",{value:y,children:[y," (",C.length,")"]},y))]})}),e.jsx("div",{children:e.jsxs("select",{value:S,onChange:y=>u(y.target.value),disabled:!l&&!o,className:"w-full px-4 py-3 border-2 rounded-lg text-base font-medium disabled:bg-gray-100 disabled:cursor-not-allowed focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:l||o?`2ï¸âƒ£ Choose exercise... (${v.length})`:r}),v.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})}),(l||o)&&e.jsxs("div",{className:"flex gap-2 items-center text-sm flex-wrap",children:[e.jsx("span",{className:"text-gray-600",children:"Active filters:"}),l&&e.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full font-medium",children:[l,e.jsx("button",{onClick:()=>g(""),className:"ml-2 text-blue-500 hover:text-blue-700",children:"Ã—"})]}),o&&e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full font-medium",children:['"',o,'"',e.jsx("button",{onClick:()=>i(""),className:"ml-2 text-green-500 hover:text-green-700",children:"Ã—"})]})]})]})}function ht(t){const s={};return t.forEach(r=>{r.prim&&Array.isArray(r.prim)&&r.prim.forEach(a=>{s[a]||(s[a]=[]),s[a].push(r)})}),Object.keys(s).sort().reduce((r,a)=>(r[a]=s[a],r),{})}function at(t,s,r,a,n,l,g=null){const o=s.find(y=>y.id==t);if(!o)return{advice:"error",suggestion:"Exercise not found",readiness:"unknown"};const i=r.filter(y=>y.id==t).sort((y,C)=>new Date(C.date)-new Date(y.date));if(i.length===0)return{advice:"first_time",suggestion:"Start conservative - focus on technique and find your working weight",readiness:"high",muscleReadiness:1,systemicReadiness:1};const S=i[0],p=i[1],N=o.prim||[],v=N.length>0?Math.min(...N.map(y=>a[y]||1)):1,f=ws(v,n,o,l,i);if(f.needed)return{advice:"deload",readiness:"deload",suggestion:f.suggestion,reason:f.reason,deloadProtocol:f.protocol,muscleReadiness:v,systemicReadiness:n};const d=Ss(S,p,o,i),u=Ns(i,v,l,o);return Es(d,u,v,n,o,S)}function ws(t,s,r,a,n){const l=Z.DELOAD_THRESHOLD;if(s<.5)return{needed:!0,reason:"Critical systemic fatigue",suggestion:"Take 3-5 days off or do very light activity only",protocol:{action:"rest",duration:"3-5 days"}};if(s<l)return{needed:!0,reason:"Systemic fatigue is high",suggestion:"Reduce all training volume by 40-50%, increase RIR by 2-3, remove or lighten axial loads",protocol:{setReduction:.5,rirIncrease:2,weightReduction:r.axial?.3:.2,duration:"4-7 days"}};if(t<l)return{needed:!0,reason:"Target muscles need recovery",suggestion:"Reduce volume by 30-40% for this exercise, add 1-2 RIR, or take an extra rest day",protocol:{setReduction:.35,rirIncrease:1,weightMaintain:!0,duration:"1-2 sessions"}};if(n.length>=3&&t>.75&&n.slice(0,3).map(N=>!N.sets||N.sets.length===0?0:N.sets.reduce((v,f)=>v+f.w*f.r,0)).every((N,v,f)=>v===0||N<=f[v-1]))return{needed:!0,reason:"Performance declining despite adequate recovery - possible overtraining",suggestion:"Take a deload week to resensitize to training stimulus",protocol:{setReduction:.4,rirIncrease:2,weightReduction:.2,duration:"1 week"}};const g=r.prim||[];return(g.length>0?g.reduce((i,S)=>i+(a[S]||0),0)/g.length:0)>Xe.MAX_WEEKLY_STIMULUS?{needed:!0,reason:"Weekly volume is excessive for target muscles",suggestion:"Reduce total sets this week to allow adaptation",protocol:{setReduction:.3,rirIncrease:1,duration:"1 week"}}:{needed:!1}}function Ss(t,s,r,a){if(!t||!t.sets||t.sets.length===0)return{trend:"insufficient_data"};const n=t.sets,l=n.reduce((p,N)=>N.w*N.r>p.w*p.r?N:p,n[0]),g=n.reduce((p,N)=>p+N.rir,0)/n.length;let o="stable",i="stable";if(s&&s.sets&&s.sets.length>0){const p=s.sets.reduce((f,d)=>d.w*d.r>f.w*f.r?d:f,s.sets[0]),N=l.w*l.r,v=p.w*p.r;N>v*1.05?o="improved":N<v*.95&&(o="declined"),l.w>p.w*1.02?i="increasing":l.w<p.w*.98&&(i="decreasing")}let S="stable";if(a.length>=4){const N=a.slice(0,4).map(d=>{if(!d.sets||d.sets.length===0)return 0;const u=d.sets.reduce((y,C)=>C.w*C.r>y.w*y.r?C:y,d.sets[0]);return u.w*u.r}).reverse(),v=N.every((d,u,y)=>u===0||d>=y[u-1]*.95),f=N.every((d,u,y)=>u===0||d<=y[u-1]*1.05);v?S="increasing":f&&(S="decreasing")}return{trend:o,volumeTrend:i,longTermTrend:S,avgRir:g,topSet:l,setCount:n.length}}function Ns(t,s,r,a){if(t.length<3)return{stagnant:!1,message:"Insufficient history to detect stagnation"};const n=t.slice(0,4).map(o=>!o.sets||o.sets.length===0?0:o.sets.reduce((i,S)=>i+S.w*S.r,0)),l=n.reduce((o,i)=>o+i,0)/n.length;if(n.every(o=>Math.abs(o-l)<l*.15)&&s>.8){const o=a.prim||[];return(o.length>0?o.reduce((S,p)=>S+(r[p]||0),0)/o.length:0)<Xe.OPTIMAL_SETS_PER_WEEK?{stagnant:!0,message:"Volume has plateaued but you can handle more",recommendation:"add_volume"}:{stagnant:!0,message:"Performance has plateaued at current volume",recommendation:"increase_intensity"}}return{stagnant:!1,message:"Progressing normally"}}function Es(t,s,r,a,n,l,g){var v;const{trend:o,avgRir:i,topSet:S,longTermTrend:p}=t,N=Z.PROGRESSION_THRESHOLD;if(r>=N&&a>=N){if(s.stagnant){if(s.recommendation==="add_volume")return{advice:"add_volume",readiness:"high",suggestion:"Add 1-2 sets to increase stimulus. Your recovery can handle more volume.",recommendedSets:(((v=l.sets)==null?void 0:v.length)||3)+1,muscleReadiness:r,systemicReadiness:a};if(i<=1){const f=Ze(n.type);return{advice:"progress",readiness:"high",suggestion:`Great work! Increase weight by ${f}lb. You're consistently close to failure.`,recommendedWeight:S.w+f,muscleReadiness:r,systemicReadiness:a}}else return{advice:"reduce_rir",readiness:"high",suggestion:"Push closer to failure (reduce RIR by 1-2) before adding weight",recommendedRirReduction:i>3?2:1,muscleReadiness:r,systemicReadiness:a}}if(i<=Xe.RIR_PROGRESSION_THRESHOLD){const f=Ze(n.type);return p==="increasing"?{advice:"progress",readiness:"high",suggestion:`Excellent progress! Increase weight by ${f}lb.`,recommendedWeight:S.w+f,reason:"Consistent performance improvement with low RIR",muscleReadiness:r,systemicReadiness:a}:{advice:"progress",readiness:"high",suggestion:`Time to progress. Increase weight by ${f}lb.`,recommendedWeight:S.w+f,muscleReadiness:r,systemicReadiness:a}}return i>=3?{advice:"push_harder",readiness:"high",suggestion:"You have room to push harder. Reduce RIR by 1-2 to maximize stimulus.",recommendedRirReduction:2,muscleReadiness:r,systemicReadiness:a}:{advice:"maintain",readiness:"high",suggestion:"Maintain current approach - you're in the optimal stimulus zone.",reason:"Good RIR range (2-3) with high readiness",muscleReadiness:r,systemicReadiness:a}}return r>=.65&&a>=.65?o==="declined"||p==="decreasing"?{advice:"reduce",readiness:"moderate",suggestion:"Performance is declining. Add 1 RIR and maintain weight to prioritize recovery.",reason:"Recent performance decline suggests accumulated fatigue",recommendedRirIncrease:1,muscleReadiness:r,systemicReadiness:a}:{advice:"maintain",readiness:"moderate",suggestion:"Maintain current load and focus on movement quality and technique.",reason:"Moderate readiness - prioritize quality over progression",muscleReadiness:r,systemicReadiness:a}:{advice:"reduce",readiness:"low",suggestion:"Add 1-2 RIR to reduce fatigue accumulation. Maintain technique focus.",reason:"Readiness is below optimal - reducing intensity prevents further fatigue accumulation",recommendedRirIncrease:r<.5?2:1,muscleReadiness:r,systemicReadiness:a}}function Rs({exercises:t,workouts:s,muscleReadiness:r,systemicReadiness:a,weeklyStimulus:n,activeProgram:l,currentDayIndex:g,getCurrentDay:o,onSessionComplete:i,onAutoSave:S,onSaveRecoveryOnly:p,onLoadProgramDay:N,useRestTimer:v,settings:f,theme:d}){var Le,Je;const[u,y]=c.useState(Ge()),[C,w]=c.useState(null),[h,F]=c.useState(""),[_,U]=c.useState([]),[L,O]=c.useState({w:"",r:"",rir:""}),[j,H]=c.useState([]),[m,x]=c.useState(null),[T,B]=c.useState(!1),[Y,k]=c.useState(!1),[$,V]=c.useState(5),[z,K]=c.useState({}),oe=c.useRef(null),re=v?v():null,me=(f==null?void 0:f.restTimerEnabled)??!0;c.useEffect(()=>{const D=s.filter(P=>P.date===u);D.length>0?H(D):H([]),F(""),U([]),O({w:"",r:"",rir:""}),w(null)},[u,s]);const we=()=>{const D=new Date(u);D.setDate(D.getDate()-1),y(D.toISOString().split("T")[0])},Se=()=>{const D=new Date(u);D.setDate(D.getDate()+1),y(D.toISOString().split("T")[0])},Ne=()=>{y(Ge())},be=D=>{const P=new Date(D+"T00:00:00"),W=new Date(Ge()+"T00:00:00"),q=new Date(W);q.setDate(q.getDate()-1);const le=new Date(W);return le.setDate(le.getDate()+1),P.toDateString()===W.toDateString()?"Today":P.toDateString()===q.toDateString()?"Yesterday":P.toDateString()===le.toDateString()?"Tomorrow":P.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},Ee=ht(t),ce=t.find(D=>D.id==h),ee=j.find(D=>D.id==h&&D.sets.length===0),X=ee&&ee.prescribedSets,E=h?at(h,t,s,r,a,n):null,I=h?s.filter(D=>D.id==h).sort((D,P)=>new Date(P.date)-new Date(D.date))[0]:null,b=D=>{F(D),U([]),O({w:"",r:"",rir:""}),x(null),B(!1),re&&re.stop(),window.scrollTo({top:0,behavior:"smooth"});const P=s.filter(q=>q.id==D).sort((q,le)=>new Date(le.date)-new Date(q.date))[0],W=j.find(q=>q.id==D&&q.prescribedWeight);W&&W.prescribedWeight?O({w:W.prescribedWeight.toString(),r:"",rir:""}):P&&P.sets&&P.sets.length>0&&O({w:P.sets[0].w.toString(),r:"",rir:""})},R=()=>{F(""),U([]),O({w:"",r:"",rir:""}),B(!0)},A=()=>{if(!L.w||!L.r||L.rir===""){alert("Fill all fields");return}const D={w:parseFloat(L.w),r:parseInt(L.r),rir:parseInt(L.rir)};U([..._,D]),O({w:L.w,r:"",rir:""}),re&&me&&re.start(f.defaultRestTime||120)},M=D=>{U(_.filter((P,W)=>W!==D))},G=D=>{const P=_[D];x(D),O({w:P.w.toString(),r:P.r.toString(),rir:P.rir.toString()}),setTimeout(()=>{var W;(W=oe.current)==null||W.scrollIntoView({behavior:"smooth",block:"center"})},100)},J=()=>{if(!L.w||!L.r||L.rir===""){alert("Fill all fields");return}const D=[..._];D[m]={w:parseFloat(L.w),r:parseInt(L.r),rir:parseInt(L.rir)},U(D),x(null),O({w:"",r:"",rir:""})},ne=()=>{x(null),O({w:"",r:"",rir:""})},fe=async D=>{if(console.log("ðŸŸ¢ AUTO-SAVE SESSION CALLED"),console.log("  Updated session:",D),console.log("  Updated session length:",D.length),console.log("  Date:",u),D.length===0){console.log("  âš ï¸ Session is empty - skipping save");return}try{console.log("  â³ Calling onAutoSave..."),await S(D,u),console.log("  âœ… AUTO-SAVE COMPLETE")}catch(P){console.error("  âŒ Auto-save failed:",P)}},Ae=async()=>{if(!h||_.length===0){alert("Select exercise and add sets");return}const D=t.find(q=>q.id==h);if(!D)return;j.length===0&&!C&&w(u);const P=j.findIndex(q=>q.id==h);let W;P!==-1?(W=[...j],W[P]={...W[P],sets:[...W[P].sets,..._]},H(W)):(W=[...j,{...D,sets:[..._],timestamp:Date.now()}],H(W)),await fe(W),U([]),O({w:"",r:"",rir:""}),F(""),re&&re.stop()},ie=(D,P)=>{const W=at(D.id,t,s,r,a,n),q=s.filter(ke=>ke.id==D.id);if(q.length===0)return{sets:P.sets,reps:P.reps,rir:P.rir,isAdapted:!1,progression:W};q.sort((ke,Oe)=>new Date(Oe.date)-new Date(ke.date))[0];let le=P.sets,pe=P.reps,ve=P.rir,Pe=null;switch(W.advice){case"progress":Pe=W.recommendedWeight;break;case"push_harder":ve=Math.max(0,P.rir-1);break;case"deload":le=Math.max(1,Math.ceil(P.sets*.5)),ve=Math.min(5,P.rir+2);break;case"reduce":W.readiness==="low"?(ve=Math.min(5,P.rir+1),le=Math.max(1,P.sets-1)):ve=Math.min(5,P.rir+1);break}return{sets:le,reps:pe,rir:ve,weight:Pe,isAdapted:!0,progression:W,basePrescription:P}},xe=()=>{const D=N();if(!D)return;const P=D.exercises.map(q=>{var ve,Pe,ke;const le=t.find(Oe=>Oe.id===q.exId||Oe.id===q.id);if(!le)return console.warn("Exercise not found:",q),null;const pe=ie(le,{sets:q.sets,reps:q.reps,rir:q.rir});return{...le,prescribedSets:pe.sets,prescribedReps:pe.reps,prescribedRir:pe.rir,prescribedWeight:pe.weight,basePrescribedSets:(ve=pe.basePrescription)==null?void 0:ve.sets,basePrescribedReps:(Pe=pe.basePrescription)==null?void 0:Pe.reps,basePrescribedRir:(ke=pe.basePrescription)==null?void 0:ke.rir,isAdapted:pe.isAdapted,sets:[],timestamp:Date.now()+Math.random()}}).filter(Boolean);if(P.length===0){alert("No valid exercises found in program day");return}H([...j,...P]),!h&&P.length>0&&b(P[0].id);const W=P.filter(q=>q.isAdapted).length;W>0?alert(`Loaded ${P.length} exercises from ${D.name}
${W} prescriptions adapted based on your progress and recovery`):alert(`Loaded ${P.length} exercises from ${D.name}`)},Re=D=>{H(j.filter(P=>P.timestamp!==D))},ye=async()=>{await i([],u,$,z),alert("Rest day complete. Enhanced recovery applied! ðŸ’ª")},De=async()=>{await p(u,$,z),V(5),K({}),k(!1),alert("Recovery data saved! ðŸ“Š")},Ce=async()=>{if(j.length===0){alert("Add exercises to session");return}if(!Y&&window.confirm(`Would you like to log your fatigue and muscle soreness before finishing?

(Recommended for accurate recovery tracking)`)){k(!0),alert("Please log your fatigue and soreness below, then click Finish Session again.");return}await i(j,C||u,$,z),w(null),V(5),K({}),k(!1),alert("Workout complete! Program advanced to next day. ðŸ’ª")};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Log Session"}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border-2 border-blue-200 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-blue-700",children:"Recording for:"}),e.jsxs("span",{className:"ml-2 font-bold text-blue-900",children:[be(C||u),C&&C!==u&&e.jsxs("span",{className:"ml-2 text-xs text-blue-600",children:["(Session started ",be(C),")"]})]})]}),C&&e.jsx("button",{onClick:()=>w(null),className:"text-xs text-blue-700 hover:text-blue-900 underline",children:"Unlock Date"})]}),l&&o&&((Le=o())==null?void 0:Le.isRestDay)&&e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"text-6xl mb-3",children:"ðŸ˜´"}),e.jsx("h2",{className:"text-2xl font-bold text-blue-900 mb-2",children:"Rest Day"}),e.jsxs("p",{className:"text-blue-700 mb-4",children:["Today is a scheduled rest day in your ",l.name," program."]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 mb-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Recovery Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Systemic Readiness:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${a>.85?"bg-green-500":a>.65?"bg-yellow-500":"bg-red-500"}`,style:{width:`${a*100}%`}})}),e.jsxs("span",{className:"text-sm font-bold",children:[(a*100).toFixed(0),"%"]})]})]}),Object.entries(r).sort(([,D],[,P])=>D-P).slice(0,3).map(([D,P])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm",children:[D,":"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${P>.85?"bg-green-500":P>.65?"bg-yellow-500":"bg-red-500"}`,style:{width:`${P*100}%`}})}),e.jsxs("span",{className:"text-sm font-bold",children:[(P*100).toFixed(0),"%"]})]})]},D))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>{confirm("Mark this rest day as complete and advance to next day?")&&ye()},className:"w-full bg-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-blue-700",children:"âœ“ Complete Rest Day"}),e.jsx("button",{onClick:()=>{confirm("Are you sure you want to train on a scheduled rest day? This may impact recovery.")},className:"w-full bg-yellow-500 text-white py-3 rounded-lg font-semibold text-base hover:bg-yellow-600",children:"âš ï¸ Train Anyway (Not Recommended)"})]}),e.jsx("p",{className:"text-xs text-blue-600 text-center mt-4",children:"ðŸ’¡ Rest days help maximize muscle growth and prevent overtraining"})]})}),e.jsxs("div",{className:"mb-4 flex items-center justify-between bg-slate-100 rounded-lg p-2",children:[e.jsx("button",{onClick:we,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors","aria-label":"Previous day",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:Ne,className:"px-4 py-2 font-semibold text-base hover:bg-slate-200 rounded-lg transition-colors",children:be(u)}),e.jsx("button",{onClick:Se,className:"p-2 hover:bg-slate-200 rounded-lg transition-colors","aria-label":"Next day",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),e.jsxs("button",{onClick:()=>k(!Y),className:"w-full mb-4 py-3 px-4 bg-slate-100 rounded-lg text-base font-semibold hover:bg-slate-200 transition-colors",children:[Y?"Hide":"+ Log"," Fatigue & Soreness"]}),Y&&e.jsxs("div",{className:"mb-6 p-4 bg-slate-50 rounded-lg border-2",children:[e.jsx("h3",{className:"font-semibold mb-4 text-lg",children:"How do you feel today?"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-base font-medium mb-3",children:["Overall Fatigue: ",$,"/10"]}),e.jsx("input",{type:"range",min:"0",max:"10",value:$,onChange:D=>V(parseInt(D.target.value)),className:"w-full h-3"}),e.jsxs("div",{className:"flex justify-between text-sm text-slate-600 mt-2",children:[e.jsx("span",{children:"Energized"}),e.jsx("span",{children:"Neutral"}),e.jsx("span",{children:"Exhausted"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-base font-medium mb-3",children:"Muscle Soreness (0-10)"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ae.map(D=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-base w-20 font-medium",children:D}),e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:z[D]||"",onChange:P=>{const W=P.target.value;(W===""||/^\d+$/.test(W)&&parseInt(W)>=0&&parseInt(W)<=10)&&K({...z,[D]:W===""?0:parseInt(W)})},placeholder:"0",className:"flex-1 px-3 py-2 border rounded-lg text-base text-center"})]},D))})]}),e.jsx("button",{onClick:De,className:"w-full bg-blue-600 text-white py-3 rounded-lg text-base font-bold hover:bg-blue-700 transition-colors",children:"ðŸ’¾ Save Recovery Data (No Exercises)"}),e.jsx("p",{className:"text-xs text-slate-600 text-center mt-2",children:"Save how you feel without logging exercises"})]}),l&&e.jsx("div",{className:"mb-6 p-4 bg-purple-50 border-2 border-purple-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-purple-900 text-lg",children:l.name}),e.jsxs("div",{className:"text-base text-purple-700",children:["Day ",g+1," of ",l.days.length,":"," ",(Je=l.days[g])==null?void 0:Je.name]})]}),e.jsx("button",{onClick:xe,className:"bg-purple-600 text-white px-5 py-3 rounded-lg text-base font-semibold whitespace-nowrap hover:bg-purple-700",children:"Load Day"})]})}),t.length===0?e.jsxs("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg p-6 text-center",children:[e.jsx("p",{className:"mb-4 text-lg",children:"No exercises in library"}),e.jsx("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg text-lg font-semibold",children:"Go to Exercises"})]}):e.jsxs(e.Fragment,{children:[!h&&!T&&e.jsx("button",{onClick:()=>B(!0),className:`w-full py-4 rounded-lg font-bold text-lg mb-4 text-white ${(d==null?void 0:d.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"+ Add Exercise"}),T&&!h&&e.jsxs("div",{className:"mb-4 p-4 border-2 rounded-lg bg-slate-50 animate-slideDown",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Select Exercise"}),e.jsx("button",{onClick:()=>B(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"Ã—"})]}),e.jsx(pt,{exercises:t,exercisesByMuscle:Ee,onSelect:b,placeholder:"2ï¸âƒ£ Choose exercise..."})]}),ce&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`mb-4 p-4 rounded-lg border-2 ${(d==null?void 0:d.primary)||"bg-blue-600"} bg-opacity-10`,children:[e.jsx("div",{className:"text-sm font-semibold opacity-75 mb-1",children:"Currently Logging:"}),e.jsx("div",{className:"text-xl font-bold",children:ce.name})]}),E&&e.jsx(js,{progression:E,className:"mb-4"}),X&&ee&&e.jsxs("div",{className:"bg-purple-50 border-2 border-purple-200 rounded-lg p-4 mb-4",children:[e.jsx("div",{className:"text-base font-semibold text-purple-900 mb-1",children:ee.isAdapted?"Adapted Prescription":"Program Prescription"}),e.jsxs("div",{className:"text-sm text-purple-800 mb-2",children:[ee.prescribedSets," sets Ã—"," ",ee.prescribedReps," reps @ ",ee.prescribedRir," RIR",ee.prescribedWeight&&e.jsxs("span",{className:"font-semibold",children:[" Â· ",ee.prescribedWeight,"lb"]})]}),ee.isAdapted&&ee.basePrescribedSets&&e.jsxs("div",{className:"text-xs text-purple-600 pt-2 border-t border-purple-200",children:["Base program: ",ee.basePrescribedSets,"Ã—",ee.basePrescribedReps," @ ",ee.basePrescribedRir,"RIR",e.jsx("span",{className:"ml-2 italic",children:"(adjusted for recovery & progress)"})]})]}),I&&I.sets&&I.sets.length>0&&e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4 mb-4",children:[e.jsxs("div",{className:"text-base font-semibold text-blue-900 mb-1",children:["Last Performance (",new Date(I.date).toLocaleDateString(),")"]}),e.jsx("div",{className:"text-sm text-blue-800",children:I.sets.map((D,P)=>e.jsxs("span",{children:[P>0&&", ",D.w,"lb Ã— ",D.r," @ ",D.rir,"RIR"]},P))})]}),me&&re&&re.isActive&&re.timeRemaining>0&&e.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-6 text-center mb-4",children:[e.jsx("div",{className:"text-base font-semibold text-green-900 mb-2",children:"Rest Timer"}),e.jsx("div",{className:"text-5xl font-bold text-green-700",children:re.formattedTime})]}),_.length>0&&e.jsx("div",{className:"bg-slate-50 p-4 rounded-lg mb-4 border-2 stagger-children",children:_.map((D,P)=>m===P?e.jsx("div",{className:"border-2 border-blue-300 rounded p-2 mb-2",children:e.jsx(rt,{weight:L.w,reps:L.r,rir:L.rir,onWeightChange:W=>O({...L,w:W}),onRepsChange:W=>O({...L,r:W}),onRirChange:W=>O({...L,rir:W}),onSubmit:J,onCancel:ne,submitLabel:"Save",showCancel:!0})},P):e.jsxs("div",{className:"flex justify-between items-center text-base mb-2 py-2 border-b last:border-b-0",children:[e.jsxs("span",{className:"font-semibold",children:["Set ",P+1,": ",D.w,"lb Ã— ",D.r," @ ",D.rir,"RIR"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>G(P),className:"text-blue-500 text-lg",children:"âœï¸"}),e.jsx("button",{onClick:()=>M(P),className:"text-red-500 text-2xl px-2",children:"Ã—"})]})]},P))}),m===null&&e.jsx("div",{ref:oe,children:e.jsx(rt,{weight:L.w,reps:L.r,rir:L.rir,onWeightChange:D=>O({...L,w:D}),onRepsChange:D=>O({...L,r:D}),onRirChange:D=>O({...L,rir:D}),onSubmit:A,autoFocusReps:_.length>0})}),_.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Ae,className:"w-full bg-green-600 text-white py-4 rounded-lg font-bold text-lg mt-3 hover:bg-green-700 btn-press",children:"âœ“ Finish Exercise"}),e.jsx("button",{onClick:R,className:"w-full bg-gray-400 text-white py-3 rounded-lg font-semibold text-base mt-2 hover:bg-gray-500 btn-press",children:"Change Exercise"})]})]})]}),j.length>0&&e.jsxs("div",{className:"mt-8 border-t-2 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-2xl font-bold",children:["Session (",j.length,")"]}),e.jsx("button",{onClick:Ce,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-bold text-lg hover:bg-blue-700 btn-press",children:"Finish"})]}),e.jsx("div",{className:"stagger-children space-y-3",children:j.map((D,P)=>e.jsxs("div",{className:`border-2 p-4 rounded-lg transition-all ${D.id===h&&D.sets.length===0?"bg-blue-50 border-blue-400 shadow-md":D.sets.length===0?"bg-yellow-50 border-yellow-300":"bg-slate-50 border-slate-200"} card-hover`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-lg flex items-center gap-2",children:[D.name,D.id===h&&D.sets.length===0&&e.jsx("span",{className:"text-xs bg-blue-500 text-white px-2 py-1 rounded",children:"â† Logging"}),D.sets.length===0&&e.jsx("span",{className:"text-xs bg-yellow-500 text-white px-2 py-1 rounded",children:"Incomplete"})]}),D.prescribedSets&&e.jsxs("div",{className:"text-xs text-purple-600 mt-1",children:["Target: ",D.prescribedSets,"Ã—",D.prescribedReps," @ ",D.prescribedRir,"RIR",D.prescribedWeight&&` Â· ${D.prescribedWeight}lb`,D.isAdapted&&e.jsx("span",{className:"ml-1 bg-purple-100 px-1 rounded text-purple-700",children:"adapted"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[D.sets.length===0&&D.id!==h&&e.jsx("button",{onClick:()=>b(D.id),className:"bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600",children:"Log Sets"}),D.sets.length>0&&e.jsx("button",{onClick:()=>{b(D.id)},className:"bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600",children:"+ More Sets"}),e.jsx("button",{onClick:()=>{confirm(`Remove ${D.name} from session?`)&&Re(D.timestamp)},className:"text-red-500 text-xl",children:"Ã—"})]})]}),D.sets.length>0?D.sets.map((W,q)=>e.jsxs("div",{className:"text-sm py-1",children:["Set ",q+1,": ",W.w,"lb Ã— ",W.r," @ ",W.rir,"RIR"]},q)):e.jsx("div",{className:"text-sm text-slate-500 italic",children:"No sets logged yet"})]},P))})]})]})}function Ds({workouts:t,readinessHistory:s=[],onUpdateWorkout:r,onDeleteWorkout:a,theme:n}){const[l,g]=c.useState(null),[o,i]=c.useState(new Date),[S,p]=c.useState(null),[N,v]=c.useState([]);console.log("ðŸ“Š HistoryView readinessHistory:",s);const f=Qt(o),d={};t.forEach(j=>{d[j.date]||(d[j.date]=[]),d[j.date].push(j)});const u=Ke(new Date),y=()=>{const j=new Date(o);j.setMonth(o.getMonth()-1),i(j)},C=()=>{const j=new Date(o);j.setMonth(o.getMonth()+1),i(j)},w=()=>{i(new Date)},h=j=>{p(j.timestamp),v([...j.sets])},F=()=>{p(null),v([])},_=j=>{const H={...j,sets:N};r(H),p(null),v([])},U=(j,H,m)=>{const x=[...N];x[j]={...x[j],[H]:H==="rir"?parseInt(m):parseFloat(m)},v(x)},L=j=>{v(N.filter((H,m)=>m!==j))},O=()=>{const j=N[N.length-1];v([...N,{w:(j==null?void 0:j.w)||0,r:(j==null?void 0:j.r)||0,rir:(j==null?void 0:j.rir)||0}])};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6",children:"History"}),t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“Š"}),e.jsx("p",{className:"text-slate-500 text-lg mb-4",children:"No workout history yet"}),e.jsx("p",{className:"text-slate-400",children:"Complete your first workout to see it here"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-semibold text-xl",children:o.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:y,className:"px-3 py-2 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:"â†"}),e.jsx("button",{onClick:w,className:`px-4 py-2 rounded-lg font-semibold text-sm ${(n==null?void 0:n.light)||"bg-blue-100"} ${(n==null?void 0:n.accent)||"text-blue-700"} hover:opacity-80 transition-opacity`,children:"Today"}),e.jsx("button",{onClick:C,className:"px-3 py-2 bg-slate-100 rounded-lg hover:bg-slate-200 transition-colors",children:"â†’"})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 sm:gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(j=>e.jsx("div",{className:"text-center font-semibold text-xs sm:text-sm py-2 text-slate-600",children:j},j)),f.map((j,H)=>{if(!j)return e.jsx("div",{},H);const m=Ke(j),x=d[m]||[],T=s.find(V=>V.date===m),B=T&&(T.perceivedFatigue!==void 0||T.muscleSoreness&&Object.keys(T.muscleSoreness).length>0),Y=x.length>0||B,k=m===u,$=m===l;return e.jsxs("button",{onClick:()=>Y&&g(m),className:`aspect-square rounded-lg flex flex-col items-center justify-center text-sm sm:text-base transition-all ${Y?x.length>0?"bg-green-100 hover:bg-green-200 cursor-pointer font-semibold border-2 border-green-300":"bg-blue-100 hover:bg-blue-200 cursor-pointer font-semibold border-2 border-blue-300":"bg-slate-50 border-2 border-slate-200"} ${k?`ring-2 ${(n==null?void 0:n.primary.split(" ")[0].replace("bg-","ring-"))||"ring-blue-500"}`:""} ${$?"ring-2 ring-purple-500":""}`,children:[e.jsx("span",{children:j.getDate()}),x.length>0?e.jsx("span",{className:"text-xs text-green-700 font-bold",children:x.length}):B?e.jsx("span",{className:"text-xs text-blue-700 font-bold",children:"ðŸ“Š"}):null]},H)})]})]}),l&&(d[l]||s.find(j=>j.date===l))&&e.jsxs("div",{className:"border-t-2 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold",children:Jt(l)}),e.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 bg-slate-200 rounded-lg text-sm font-semibold hover:bg-slate-300 transition-colors",children:"Close"})]}),d[l]&&d[l].length>0&&e.jsx("div",{className:"space-y-4 stagger-children",children:d[l].map((j,H)=>e.jsxs("div",{className:"border-2 p-5 rounded-lg bg-slate-50 card-hover",children:[e.jsxs("div",{className:"font-bold text-lg mb-3 flex justify-between items-start",children:[e.jsx("span",{children:j.name}),e.jsx("div",{className:"flex flex-wrap gap-1",children:j.prim&&j.prim.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:j.prim.map(m=>e.jsx("span",{className:`text-xs px-2 py-1 rounded font-semibold ${(n==null?void 0:n.light)||"bg-blue-100"} ${(n==null?void 0:n.accent)||"text-blue-700"}`,children:m},m))})})]}),j.sets&&j.sets.length>0?S===j.timestamp?e.jsxs("div",{children:[e.jsx("div",{className:"space-y-2 mb-4",children:N.map((m,x)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("span",{className:"text-sm font-semibold w-12",children:["Set ",x+1,":"]}),e.jsx("input",{type:"number",step:"0.5",value:m.w,onChange:T=>U(x,"w",T.target.value),className:"w-20 px-2 py-1 border-2 rounded text-center",placeholder:"lbs"}),e.jsx("span",{className:"text-sm",children:"Ã—"}),e.jsx("input",{type:"number",value:m.r,onChange:T=>U(x,"r",T.target.value),className:"w-16 px-2 py-1 border-2 rounded text-center",placeholder:"reps"}),e.jsx("span",{className:"text-sm",children:"@"}),e.jsx("input",{type:"number",value:m.rir,onChange:T=>U(x,"rir",T.target.value),className:"w-16 px-2 py-1 border-2 rounded text-center",placeholder:"RIR"}),e.jsx("button",{onClick:()=>L(x),className:"text-red-500 hover:text-red-700 px-2",children:"Ã—"})]},x))}),e.jsx("div",{className:"flex gap-2 mb-3",children:e.jsx("button",{onClick:O,className:`flex-1 text-white py-2 rounded text-sm ${(n==null?void 0:n.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"+ Add Set"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>_(j),className:"flex-1 bg-green-600 text-white py-2 rounded font-semibold hover:bg-green-700",children:"âœ“ Save Changes"}),e.jsx("button",{onClick:F,className:"flex-1 bg-gray-400 text-white py-2 rounded font-semibold hover:bg-gray-500",children:"Cancel"})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:"space-y-1 mb-3",children:j.sets.map((m,x)=>e.jsxs("div",{className:"text-base text-slate-700 py-1",children:["Set ",x+1,":"," ",e.jsxs("span",{className:"font-semibold",children:[m.w,"lb Ã— ",m.r]})," ","@ ",m.rir,"RIR"]},x))}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-slate-300",children:[e.jsx("button",{onClick:()=>h(j),className:`flex-1 text-white py-2 rounded font-semibold ${(n==null?void 0:n.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"âœï¸ Edit"}),e.jsx("button",{onClick:()=>{confirm(`Delete ${j.name}?`)&&a(j.timestamp)},className:"flex-1 bg-red-600 text-white py-2 rounded font-semibold hover:bg-red-700",children:"ðŸ—‘ï¸ Delete"})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-300",children:[e.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[e.jsx("span",{children:"Total Volume:"}),e.jsxs("span",{className:"font-semibold",children:[j.sets.reduce((m,x)=>m+x.w*x.r,0).toLocaleString()," ","lbs"]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-slate-600",children:[e.jsx("span",{children:"Total Sets:"}),e.jsx("span",{className:"font-semibold",children:j.sets.length})]})]})]}):e.jsx("p",{className:"text-slate-500 italic",children:"No set data"})]},H))}),d[l]&&d[l].length>0&&e.jsxs("div",{className:`border-2 rounded-lg p-4 mt-4 ${(n==null?void 0:n.light)||"bg-blue-50 border-blue-200"}`,children:[e.jsx("div",{className:`font-semibold mb-2 ${(n==null?void 0:n.text)||"text-blue-900"}`,children:"Day Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Total Exercises"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:d[l].length})]}),e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Total Sets"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:d[l].reduce((j,H)=>{var m;return j+(((m=H.sets)==null?void 0:m.length)||0)},0)})]}),e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Total Volume"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:d[l].reduce((j,H)=>{var m;return j+(((m=H.sets)==null?void 0:m.reduce((x,T)=>x+T.w*T.r,0))||0)},0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("div",{className:(n==null?void 0:n.accent)||"text-blue-700",children:"Muscles Trained"}),e.jsx("div",{className:`text-2xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:new Set(d[l].flatMap(j=>j.prim||[])).size})]})]})]}),(()=>{console.log("ðŸ” Looking for recovery data for date:",l),console.log("  Available readinessHistory:",s);const j=s.find(m=>m.date===l);if(console.log("  Found recovery data:",j),!j||!j.perceivedFatigue&&!j.muscleSoreness)return console.log("  âŒ No recovery data to display"),null;const H=j.muscleSoreness&&Object.values(j.muscleSoreness).some(m=>m>0);return console.log("  âœ… Displaying recovery data"),e.jsxs("div",{className:"mt-4 p-5 bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:[e.jsxs("h4",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ“Š"}),"Recovery Data"]}),j.perceivedFatigue!==void 0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Overall Fatigue:"}),e.jsxs("span",{className:"text-lg font-bold",children:[j.perceivedFatigue,"/10"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${j.perceivedFatigue<=3?"bg-green-500":j.perceivedFatigue<=6?"bg-yellow-500":j.perceivedFatigue<=8?"bg-orange-500":"bg-red-500"}`,style:{width:`${j.perceivedFatigue*10}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mt-1",children:[e.jsx("span",{children:"Energized"}),e.jsx("span",{children:"Exhausted"})]})]}),H&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold mb-3",children:"Muscle Soreness:"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(j.muscleSoreness).filter(([m,x])=>x>0).sort((m,x)=>x[1]-m[1]).map(([m,x])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium w-20",children:[m,":"]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:`h-2 rounded-full ${x<=3?"bg-green-500":x<=6?"bg-yellow-500":x<=8?"bg-orange-500":"bg-red-500"}`,style:{width:`${x*10}%`}})}),e.jsx("span",{className:"text-sm font-bold w-8 text-right",children:x})]},m))})]})]})})()]}),!l&&e.jsxs("div",{className:"mt-8 pt-8 border-t-2",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"All-Time Stats"}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 stagger-children",children:[e.jsxs("div",{className:`rounded-lg p-4 border-2 bg-gradient-to-br card-hover ${(n==null?void 0:n.light)||"from-blue-50 to-blue-100 border-blue-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 ${(n==null?void 0:n.accent)||"text-blue-700"}`,children:"Total Workouts"}),e.jsx("div",{className:`text-3xl font-bold ${(n==null?void 0:n.text)||"text-blue-900"}`,children:new Set(t.map(j=>j.date)).size})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border-2 border-green-200 card-hover",children:[e.jsx("div",{className:"text-sm text-green-700 mb-1",children:"Total Sets"}),e.jsx("div",{className:"text-3xl font-bold text-green-900",children:t.reduce((j,H)=>{var m;return j+(((m=H.sets)==null?void 0:m.length)||0)},0)})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 border-2 border-purple-200 card-hover",children:[e.jsx("div",{className:"text-sm text-purple-700 mb-1",children:"Total Volume"}),e.jsxs("div",{className:"text-2xl font-bold text-purple-900",children:[(t.reduce((j,H)=>{var m;return j+(((m=H.sets)==null?void 0:m.reduce((x,T)=>x+T.w*T.r,0))||0)},0)/1e3).toFixed(1),"k"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 border-2 border-orange-200 card-hover",children:[e.jsx("div",{className:"text-sm text-orange-700 mb-1",children:"Exercises"}),e.jsx("div",{className:"text-3xl font-bold text-orange-900",children:new Set(t.map(j=>j.id)).size})]})]})]})]})]})}function Cs({systemicReadiness:t,muscleReadiness:s,weeklyStimulus:r,weeklySummary:a,theme:n}){const l=i=>i>=.85?"bg-green-500":i>=.65?"bg-yellow-500":i>=.5?"bg-orange-500":"bg-red-500",g=Object.values(s).reduce((i,S)=>i+S,0)/ae.length,o=Object.values(r).reduce((i,S)=>i+S,0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"p-5 bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-semibold text-blue-900 mb-2",children:"Systemic Readiness"}),e.jsxs("div",{className:"text-4xl font-bold mb-3 text-blue-700",children:[(t*100).toFixed(0),"%"]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${l(t)}`,style:{width:`${t*100}%`}})})]}),e.jsxs("div",{className:"p-5 bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-semibold text-green-900 mb-2",children:"Avg Muscle Readiness"}),e.jsxs("div",{className:"text-4xl font-bold text-green-700 mb-3",children:[(g*100).toFixed(0),"%"]}),e.jsx("div",{className:"flex gap-1",children:ae.slice(0,10).map(i=>e.jsx("div",{className:"flex-1 h-3 rounded",style:{backgroundColor:s[i]>=.85?"#22c55e":s[i]>=.65?"#eab308":s[i]>=.5?"#f97316":"#ef4444"},title:`${i}: ${(s[i]*100).toFixed(0)}%`},i))})]}),e.jsxs("div",{className:"p-5 bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-200 rounded-lg",children:[e.jsx("div",{className:"text-sm font-semibold text-purple-900 mb-2",children:"Total Weekly Stimulus"}),e.jsx("div",{className:"text-4xl font-bold text-purple-700 mb-3",children:o.toFixed(1)}),e.jsx("div",{className:"text-sm text-purple-700",children:"sets equivalent across all muscles"})]})]}),e.jsxs("div",{className:"mb-8 p-5 bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-200 rounded-lg",children:[e.jsx("h2",{className:"font-bold text-xl mb-4",children:"This Week's Progress"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-700",children:a.workouts}),e.jsx("div",{className:"text-sm text-slate-600",children:"Workouts"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-3xl font-bold ${(n==null?void 0:n.accent)||"text-blue-700"}`,children:a.totalSets}),e.jsx("div",{className:"text-sm text-slate-600",children:"Total Sets"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-700",children:a.musclesWorked.length}),e.jsx("div",{className:"text-sm text-slate-600",children:"Muscles Hit"})]})]})]})]})}function ks({chartData:t,chartType:s,metricView:r,metricInfo:a,trend:n,timeframe:l,selectedMuscle:g,theme:o,onMetricChange:i,onTimeframeChange:S,onMuscleChange:p,onChartTypeChange:N}){const v=Math.max(...t.map(u=>u.value),1),f=Math.min(...t.map(u=>u.value),0),d=v-f||1;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6 p-5 bg-slate-50 rounded-lg border-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Metric"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["volume","fatigue","stimulus","efficiency"].map(u=>e.jsx("button",{onClick:()=>i(u),className:`px-3 py-2 rounded-lg text-xs font-semibold transition-all ${r===u?`${(o==null?void 0:o.primary)||"bg-blue-600"} text-white shadow-md`:"bg-white hover:bg-slate-100 border-2"}`,children:u.charAt(0).toUpperCase()+u.slice(1)},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Timeframe"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[4,8,12,16].map(u=>e.jsxs("button",{onClick:()=>S(u),className:`px-3 py-2 rounded-lg text-sm font-semibold transition-all ${l===u?`${(o==null?void 0:o.primary)||"bg-blue-600"} text-white shadow-md`:"bg-white hover:bg-slate-100 border-2"}`,children:[u,"w"]},u))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Muscle Group"}),e.jsxs("select",{value:g,onChange:u=>p(u.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-sm font-medium bg-white",children:[e.jsx("option",{value:"all",children:"All Muscles"}),ae.map(u=>e.jsx("option",{value:u,children:u},u))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2 text-slate-700",children:"Chart Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["line","bar"].map(u=>e.jsx("button",{onClick:()=>N(u),className:`px-3 py-2 rounded-lg text-sm font-semibold transition-all ${s===u?`${(o==null?void 0:o.primary)||"bg-blue-600"} text-white shadow-md`:"bg-white hover:bg-slate-100 border-2"}`,children:u.charAt(0).toUpperCase()+u.slice(1)},u))})]})]})}),e.jsx("div",{className:`mb-6 p-4 bg-gradient-to-r ${(o==null?void 0:o.light)||"from-slate-50 to-blue-50"} border-2 ${(o==null?void 0:o.primary.split(" ")[0].replace("bg-","border-"))||"border-blue-200"} rounded-lg`,children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-lg",style:{color:a.color},children:a.label}),e.jsx("div",{className:"text-sm text-slate-600",children:a.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Trend"}),e.jsxs("div",{className:`text-lg font-bold ${n.direction==="increasing"?"text-green-600":n.direction==="decreasing"?"text-red-600":"text-slate-600"}`,children:[n.direction==="increasing"?"â†—":n.direction==="decreasing"?"â†˜":"â†’"," ",Math.abs(parseFloat(n.change)),"%"]})]})]})}),e.jsx("div",{className:"mb-8 p-5 bg-white border-2 rounded-lg shadow-sm",children:t.length>0&&t.some(u=>u.value>0)?e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"absolute left-0 top-0 bottom-8 w-16 flex flex-col justify-between text-xs text-slate-600 text-right pr-2",children:[e.jsx("span",{children:v.toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:(v*.75).toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:(v*.5).toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:(v*.25).toLocaleString(void 0,{maximumFractionDigits:1})}),e.jsx("span",{children:f.toLocaleString(void 0,{maximumFractionDigits:1})})]}),e.jsxs("div",{className:"ml-20 mr-4",children:[e.jsxs("svg",{viewBox:"0 0 500 250",className:"w-full",style:{height:"250px"},children:[[0,.25,.5,.75,1].map((u,y)=>e.jsx("line",{x1:"0",y1:250-u*250,x2:"500",y2:250-u*250,stroke:"#e2e8f0",strokeWidth:"1"},y)),s==="line"?e.jsxs(e.Fragment,{children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"areaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:a.color,stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:a.color,stopOpacity:"0.05"})]})}),e.jsx("polygon",{points:["0,250",...t.map((u,y)=>{const C=t.length>1?y/(t.length-1)*500:250,w=250-(u.value-f)/d*250;return`${C},${w}`}),`${t.length>1?500:250},250`].join(" "),fill:"url(#areaGradient)"}),t.length>1&&e.jsx("polyline",{points:t.map((u,y)=>{const C=y/(t.length-1)*500,w=250-(u.value-f)/d*250;return`${C},${w}`}).join(" "),fill:"none",stroke:a.color,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),t.map((u,y)=>{const C=t.length>1?y/(t.length-1)*500:250,w=250-(u.value-f)/d*250;return e.jsxs("g",{children:[e.jsx("circle",{cx:C,cy:w,r:"6",fill:"white",stroke:a.color,strokeWidth:"3"}),e.jsxs("title",{children:[u.week,": ",u.value.toLocaleString(void 0,{maximumFractionDigits:1})," ",a.unit]})]},y)})]}):t.map((u,y)=>{const C=500/t.length*.8,w=y/t.length*500+500/t.length*.1,h=(u.value-f)/d*250,F=250-h;return e.jsxs("g",{children:[e.jsx("rect",{x:w,y:F,width:C,height:h,fill:a.color,opacity:"0.8",rx:"3"}),e.jsxs("title",{children:[u.week,": ",u.value.toLocaleString(void 0,{maximumFractionDigits:1})," ",a.unit]})]},y)})]}),e.jsx("div",{className:"flex justify-between mt-2 text-xs text-slate-600",children:t.map((u,y)=>{const C=y===0||y===t.length-1||t.length>8&&y%Math.floor(t.length/4)===0;return e.jsx("span",{className:C?"":"invisible",children:u.week},y)})})]})]}):e.jsx("p",{className:"text-slate-500 text-center py-8",children:g==="all"?"Complete more workouts to see trends":`No ${g} data in this timeframe`})})]})}function Fs({muscleReadiness:t,weeklyStimulus:s,selectedMuscle:r,onMuscleSelect:a,theme:n}){const l=g=>g>=.85?"bg-green-500":g>=.65?"bg-yellow-500":g>=.5?"bg-orange-500":"bg-red-500";return e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"font-bold text-xl mb-4",children:"Muscle Readiness Breakdown"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3",children:ae.map(g=>{const o=t[g]||1,i=s[g]||0;return e.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all cursor-pointer hover:shadow-md ${r===g?`${(n==null?void 0:n.primary.split(" ")[0].replace("bg-","border-"))||"border-blue-500"} ${(n==null?void 0:n.light)||"bg-blue-50"} shadow-md`:"border-slate-200 hover:border-slate-300"}`,onClick:()=>a(g===r?"all":g),children:[e.jsx("div",{className:"text-sm font-semibold mb-2 text-slate-700",children:g}),e.jsxs("div",{className:"text-2xl font-bold mb-2",children:[(o*100).toFixed(0),"%"]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2 overflow-hidden mb-2",children:e.jsx("div",{className:`h-full transition-all ${l(o)}`,style:{width:`${o*100}%`}})}),e.jsxs("div",{className:"text-xs text-slate-600",children:[i.toFixed(1)," sets/wk"]})]},g)})})]})}function Ts({muscleReadiness:t,systemicReadiness:s,trend:r,lastWorkoutDate:a,theme:n}){var l,g;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"p-5 bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-green-900",children:"ðŸ’ª Recovery Recommendations"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[Object.entries(t).filter(([o,i])=>i<.65).sort((o,i)=>o[1]-i[1]).slice(0,3).map(([o,i])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-orange-600",children:"âš ï¸"}),e.jsxs("span",{className:"font-medium text-slate-800",children:[o,":"]}),e.jsx("span",{className:"text-slate-700",children:i<.5?"Needs deload":"Reduce volume 20-30%"})]},o)),Object.entries(t).every(([o,i])=>i>=.65)&&e.jsx("div",{className:"text-green-700 font-medium",children:"âœ“ All muscle groups adequately recovered"})]})]}),e.jsxs("div",{className:"p-5 bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-blue-900",children:"ðŸ“Š Training Insights"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-700",children:"Volume trend:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:r.direction})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-700",children:"Most recovered:"}),e.jsx("span",{className:"font-semibold text-slate-900",children:((l=Object.entries(t).sort((o,i)=>i[1]-o[1])[0])==null?void 0:l[0])||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-700",children:"Needs attention:"}),e.jsx("span",{className:"font-semibold text-orange-600",children:((g=Object.entries(t).sort((o,i)=>o[1]-i[1])[0])==null?void 0:g[0])||"N/A"})]})]})]})]}),a&&e.jsxs("div",{className:"p-4 bg-slate-50 border-2 border-slate-200 rounded-lg mb-6",children:[e.jsxs("p",{className:"text-base text-slate-900",children:[e.jsx("strong",{children:"Last workout:"})," ",new Date(a).toLocaleDateString()]}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:"Recovery is calculated automatically based on time since last session"})]}),e.jsxs("div",{className:"p-5 border-2 border-slate-300 bg-white rounded-lg shadow-sm",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-slate-900",children:"Readiness Guide"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-green-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:">85%:"})," Ready to progress"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:"65-85%:"})," Maintain current load"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:"50-65%:"})," Reduce intensity"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 bg-red-500 rounded"}),e.jsxs("span",{className:"text-base text-slate-800",children:[e.jsx("strong",{children:"<50%:"})," Deload needed"]})]})]})]})]})}function As({workouts:t,readinessHistory:s,stimulusHistory:r,weeklyStimulus:a,localFatigue:n,timeframe:l,selectedMuscle:g,metricView:o,theme:i}){const S=c.useMemo(()=>{const f=[],d=new Date;for(let u=l-1;u>=0;u--){const y=new Date(d);y.setDate(d.getDate()-u*7);const C=new Date(y);C.setDate(y.getDate()+7);const w={week:u===0?"This week":`${u}w ago`,weekLabel:y.toLocaleDateString("en-US",{month:"short",day:"numeric"}),date:y.toISOString().split("T")[0],volume:{},fatigue:{},stimulus:{},efficiency:{}},h=t.filter(F=>{const _=new Date(F.date);return _>=y&&_<C});ae.forEach(F=>{let _=0;h.forEach(x=>{const T=(x.sets||[]).reduce((B,Y)=>B+Y.w*Y.r,0);x.prim&&x.prim.includes(F)&&(_+=T*1),x.sec&&x.sec.includes(F)&&(_+=T*.6),x.ter&&x.ter.includes(F)&&(_+=T*.3)}),w.volume[F]=_;const U=s.filter(x=>{const T=new Date(x.date);return T>=y&&T<C}),L=U.length>0?U.sort((x,T)=>new Date(T.date)-new Date(x.date))[0]:null;L&&L.muscleSoreness&&L.muscleSoreness[F]?w.fatigue[F]=L.muscleSoreness[F]/10:u===0?w.fatigue[F]=n[F]||0:w.fatigue[F]=0;const O=r.filter(x=>{const T=new Date(x.date);return T>=y&&T<C});console.log(`Week ${u} (${y.toLocaleDateString()} - ${C.toLocaleDateString()}):`,{weekStimulusEntries:O.length,dates:O.map(x=>x.date)});const j=O.length>0?O.sort((x,T)=>new Date(T.date)-new Date(x.date))[0]:null;j&&j.stimulus?w.stimulus[F]=j.stimulus[F]||0:u===0?w.stimulus[F]=a[F]||0:w.stimulus[F]=0;const H=w.fatigue[F]||.001,m=w.stimulus[F]||0;w.efficiency[F]=H>0?m/H:0}),f.push(w)}return f},[t,s,r,a,n,l]),p=c.useMemo(()=>S.map(f=>{let d=0;return g==="all"?(d=ae.map(y=>f[o][y]||0).reduce((y,C)=>y+C,0),o==="efficiency"&&(d=d/ae.length)):d=f[o][g]||0,{week:f.week,weekLabel:f.weekLabel,value:d}}),[S,g,o]),N=c.useMemo(()=>{if(p.length<2)return{direction:"stable",change:0};const f=p.slice(0,Math.floor(p.length/2)),d=p.slice(Math.floor(p.length/2)),u=f.reduce((h,F)=>h+F.value,0)/f.length,y=d.reduce((h,F)=>h+F.value,0)/d.length,C=u>0?(y-u)/u*100:0;return{direction:C>5?"increasing":C<-5?"decreasing":"stable",change:C.toFixed(1)}},[p]),v=c.useMemo(()=>({volume:{label:"Volume (lbs)",color:i!=null&&i.primary.includes("blue")?"#2563eb":i!=null&&i.primary.includes("green")?"#16a34a":i!=null&&i.primary.includes("purple")?"#9333ea":i!=null&&i.primary.includes("orange")?"#ea580c":i!=null&&i.primary.includes("red")?"#dc2626":i!=null&&i.primary.includes("indigo")?"#4f46e5":i!=null&&i.primary.includes("pink")?"#db2777":i!=null&&i.primary.includes("teal")?"#0d9488":"#2563eb",unit:"lbs",description:"Total weight Ã— reps lifted"},fatigue:{label:"Fatigue Index",color:"#dc2626",unit:"",description:"Accumulated fatigue (logarithmic scale)"},stimulus:{label:"Stimulus (sets)",color:"#16a34a",unit:"sets",description:"Effective training volume"},efficiency:{label:"Stimulus:Fatigue Ratio",color:"#9333ea",unit:"",description:"Training efficiency (higher is better)"}})[o],[o,i]);return{historicalData:S,chartData:p,trend:N,metricInfo:v}}function Ls({muscleReadiness:t,systemicReadiness:s,weeklyStimulus:r,localFatigue:a,lastWorkoutDate:n,workouts:l,stimulusHistory:g=[],readinessHistory:o=[],theme:i}){const[S,p]=c.useState(8),[N,v]=c.useState("all"),[f,d]=c.useState("volume"),[u,y]=c.useState("line"),C=ss(l),{chartData:w,trend:h,metricInfo:F}=As({workouts:l,readinessHistory:o,stimulusHistory:g,weeklyStimulus:r,localFatigue:a,timeframe:S,selectedMuscle:N,metricView:f,theme:i});return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Recovery & Training Analytics"}),e.jsx(Cs,{systemicReadiness:s,muscleReadiness:t,weeklyStimulus:r,weeklySummary:C,theme:i}),e.jsx(ks,{chartData:w,chartType:u,metricView:f,metricInfo:F,trend:h,timeframe:S,selectedMuscle:N,theme:i,onMetricChange:d,onTimeframeChange:p,onMuscleChange:v,onChartTypeChange:y}),e.jsx(Fs,{muscleReadiness:t,weeklyStimulus:r,selectedMuscle:N,onMuscleSelect:v,theme:i}),e.jsx(Ts,{muscleReadiness:t,systemicReadiness:s,trend:h,lastWorkoutDate:n,theme:i})]})}function Ps({exercises:t,onAddExercise:s,onUpdateExercise:r,onDeleteExercise:a,onResetToPresets:n,theme:l}){const[g,o]=c.useState(""),[i,S]=c.useState("compound_upper"),[p,N]=c.useState(!1),[v,f]=c.useState([]),[d,u]=c.useState([]),[y,C]=c.useState([]),[w,h]=c.useState(!1),[F,_]=c.useState(null),[U,L]=c.useState(""),O=c.useRef(null),j=(k,$)=>{$==="primary"?(f(V=>V.includes(k)?V.filter(z=>z!==k):[...V,k]),u(V=>V.filter(z=>z!==k)),C(V=>V.filter(z=>z!==k))):$==="secondary"?(u(V=>V.includes(k)?V.filter(z=>z!==k):[...V,k]),f(V=>V.filter(z=>z!==k)),C(V=>V.filter(z=>z!==k))):$==="tertiary"&&(C(V=>V.includes(k)?V.filter(z=>z!==k):[...V,k]),f(V=>V.filter(z=>z!==k)),u(V=>V.filter(z=>z!==k)))},H=async()=>{if(!g||v.length===0){alert("Enter name and select primary muscles");return}await s({name:g,type:i,axial:p,prim:v,sec:d,ter:y}),B()},m=k=>{var $,V;_(k.id),o(k.name),S(k.type),N(k.axial),f(k.prim||[]),u(k.sec||[]),C(k.ter||[]),h((($=k.sec)==null?void 0:$.length)>0||((V=k.ter)==null?void 0:V.length)>0),setTimeout(()=>{var z;(z=O.current)==null||z.scrollIntoView({behavior:"smooth",block:"start"})},100)},x=async()=>{if(!g||v.length===0){alert("Enter name and select primary muscles");return}await r(F,{name:g,type:i,axial:p,prim:v,sec:d,ter:y}),B()},T=()=>{B()},B=()=>{_(null),o(""),S("compound_upper"),N(!1),f([]),u([]),C([]),h(!1)},Y=t.filter(k=>k.name.toLowerCase().includes(U.toLowerCase()));return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Exercise Library"}),e.jsxs("div",{ref:O,className:"space-y-3 mb-6 pb-6 border-b",children:[e.jsx("input",{type:"text",value:g,onChange:k=>o(k.target.value),placeholder:"Exercise name",className:"w-full px-3 py-2 border rounded"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("select",{value:i,onChange:k=>S(k.target.value),className:"px-3 py-2 border rounded",children:Object.entries(xt).map(([k,$])=>e.jsx("option",{value:k,children:$.name},k))}),e.jsxs("label",{className:"flex items-center gap-2 border rounded px-3 py-2",children:[e.jsx("input",{type:"checkbox",checked:p,onChange:k=>N(k.target.checked)}),e.jsx("span",{className:"text-sm",children:"Axially Loaded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-2",children:"Primary Muscles *"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ae.map(k=>e.jsx("button",{onClick:()=>j(k,"primary"),className:`px-2 py-1 text-sm rounded border ${v.includes(k)?`${(l==null?void 0:l.primary)||"bg-blue-600 hover:bg-blue-700"} text-white`:"bg-white hover:bg-slate-50"}`,children:k},k))})]}),e.jsxs("button",{onClick:()=>h(!w),className:`text-sm ${(l==null?void 0:l.accent)||"text-blue-600"} hover:opacity-80`,children:[w?"Hide":"+ Add"," Secondary/Tertiary"]}),w&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold block mb-1",children:"Secondary Muscles"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ae.map(k=>e.jsx("button",{onClick:()=>j(k,"secondary"),className:`px-2 py-1 text-xs rounded border ${d.includes(k)?"bg-green-600 text-white":"bg-white hover:bg-slate-50"}`,children:k},k))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold block mb-1",children:"Tertiary Muscles"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:ae.map(k=>e.jsx("button",{onClick:()=>j(k,"tertiary"),className:`px-2 py-1 text-xs rounded border ${y.includes(k)?"bg-purple-600 text-white":"bg-white hover:bg-slate-50"}`,children:k},k))})]})]}),F?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:x,className:"flex-1 bg-green-600 text-white py-2 rounded hover:bg-green-700",children:"Update Exercise"}),e.jsx("button",{onClick:T,className:"flex-1 bg-gray-400 text-white py-2 rounded hover:bg-gray-500",children:"Cancel"})]}):e.jsx("button",{onClick:H,className:`w-full text-white py-2 rounded ${(l==null?void 0:l.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"Save Exercise"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h2",{className:"font-bold",children:["All Exercises (",Y.length,")"]}),e.jsx("button",{onClick:n,className:`underline text-sm ${(l==null?void 0:l.accent)||"text-blue-600"} hover:opacity-80`,children:"Load Presets"})]}),e.jsx("input",{type:"text",value:U,onChange:k=>L(k.target.value),placeholder:"Search exercises...",className:"w-full px-3 py-2 border rounded mb-3"}),Y.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-slate-500",children:U?"No exercises match your search":"No exercises yet"})}):e.jsx("div",{className:"space-y-2 stagger-children",children:Y.map(k=>{var $;return e.jsxs("div",{className:"border p-3 rounded flex justify-between items-center hover:bg-slate-50 card-hover",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:k.name}),e.jsxs("div",{className:"text-xs text-slate-600",children:[($=k.prim)==null?void 0:$.join(", "),k.axial&&e.jsx("span",{className:"ml-2 text-orange-600 font-semibold",children:"â€¢ Axial"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>m(k),className:`text-lg ${(l==null?void 0:l.accent)||"text-blue-500"} hover:opacity-80`,children:"âœï¸"}),e.jsx("button",{onClick:()=>{confirm(`Delete ${k.name}?`)&&a(k.id)},className:"text-red-500 hover:text-red-700",children:"ðŸ—‘ï¸"})]})]},k.id)})})]})]})}function Ms({programs:t,exercises:s,activeProgram:r,currentDayIndex:a,onAddProgram:n,onUpdateProgram:l,onDeleteProgram:g,onStartProgram:o,onStopProgram:i,theme:S}){var I;const[p,N]=c.useState(""),[v,f]=c.useState([]),[d,u]=c.useState({name:"",exercises:[],isRestDay:!1}),[y,C]=c.useState(null),[w,h]=c.useState(null),[F,_]=c.useState(null),[U,L]=c.useState(null),O=c.useRef(null),j=ht(s),H=b=>{const R=s.find(A=>A.id==b);R&&u({...d,exercises:[...d.exercises,{...R,sets:3,reps:10,rir:2,exId:R.id}]})},m=(b,R,A)=>{const M=[...d.exercises];M[b][R]=parseInt(A),u({...d,exercises:M})},x=b=>{u({...d,exercises:d.exercises.filter((R,A)=>A!==b)})},T=b=>{const R=d.exercises[b];u({...d,exercises:[...d.exercises.slice(0,b+1),{...R},...d.exercises.slice(b+1)]})},B=(b,R)=>{L(R),b.dataTransfer.effectAllowed="move"},Y=(b,R)=>{if(b.preventDefault(),U===null||U===R)return;const A=[...d.exercises],M=A[U];A.splice(U,1),A.splice(R,0,M),u({...d,exercises:A}),L(R)},k=()=>{L(null)},$=b=>{h(b),u({...v[b]}),setTimeout(()=>{var R;(R=O.current)==null||R.scrollIntoView({behavior:"smooth",block:"start"})},100)},V=b=>{const R=v[b],A={...R,name:`${R.name} (Copy)`,id:Date.now()},M=[...v.slice(0,b+1),A,...v.slice(b+1)];f(M)},z=()=>{if(!d.name){alert("Add day name");return}const b=[...v];b[w]={...d},f(b),h(null),u({name:"",exercises:[],isRestDay:!1})},K=()=>{h(null),u({name:"",exercises:[],isRestDay:!1})},oe=()=>{if(!d.name){alert("Add day name");return}w!==null?z():(f([...v,{...d,id:Date.now()}]),u({name:"",exercises:[],isRestDay:!1}))},re=b=>{f(v.filter((R,A)=>A!==b))},me=(b,R)=>{_(R),b.dataTransfer.effectAllowed="move"},we=(b,R)=>{if(b.preventDefault(),F===null||F===R)return;const A=[...v],M=A[F];A.splice(F,1),A.splice(R,0,M),f(A),_(R)},Se=()=>{_(null)},Ne=async()=>{if(!p||v.length===0){alert("Add program name and days");return}await n({name:p,days:v}),X(),alert("Program saved!")},be=b=>{C(b.id),N(b.name),f(b.days)},Ee=b=>{const R={...b,name:`${b.name} (Copy)`};C(null),N(R.name),f(R.days),window.scrollTo({top:0,behavior:"smooth"})},ce=async()=>{if(!p||v.length===0){alert("Add program name and days");return}await l(y,{name:p,days:v}),X(),alert("Program updated!")},ee=()=>{X()},X=()=>{C(null),N(""),f([]),u({name:"",exercises:[],isRestDay:!1})},E=b=>{const R=b.filter(G=>!G.isRestDay).length,A=b.filter(G=>G.isRestDay).length,M=b.reduce((G,J)=>{var ne;return G+(((ne=J.exercises)==null?void 0:ne.length)||0)},0);return{trainingDays:R,restDays:A,totalExercises:M}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Programs"}),r&&e.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-green-900",children:["Active: ",r.name]}),e.jsxs("div",{className:"text-sm text-green-700",children:["Day ",a+1," of ",r.days.length,((I=r.days[a])==null?void 0:I.isRestDay)&&" (Rest Day)"]})]}),e.jsx("button",{onClick:i,className:"text-sm text-red-600 hover:text-red-700",children:"Stop"})]})}),e.jsxs("div",{className:"space-y-4 mb-6 pb-6 border-b",children:[e.jsx("h3",{className:"font-semibold text-lg sm:text-xl",children:"Create Program"}),e.jsx("input",{type:"text",value:p,onChange:b=>N(b.target.value),placeholder:"Program name (e.g., Push Pull Legs)",className:"w-full px-4 py-3 border-2 rounded-lg text-base"}),e.jsxs("div",{ref:O,className:"border-2 rounded-lg p-4 bg-slate-50",children:[e.jsx("h3",{className:"font-semibold mb-4 text-base sm:text-lg",children:"Build Training Day"}),e.jsx("input",{type:"text",value:d.name,onChange:b=>u({...d,name:b.target.value}),placeholder:"Day name (e.g., Upper A, Push, Legs)",className:"w-full px-4 py-3 border-2 rounded-lg mb-4 text-base"}),!d.isRestDay&&e.jsx(e.Fragment,{children:s.length===0?e.jsxs("div",{className:"text-center py-6 text-slate-500",children:[e.jsx("p",{className:"mb-3",children:"No exercises available"}),e.jsx("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold",children:"Go to Exercises"})]}):e.jsxs(e.Fragment,{children:[e.jsx(pt,{exercises:s,exercisesByMuscle:j,onSelect:H,placeholder:"2ï¸âƒ£ Choose exercise to add...",className:"mb-4"}),d.exercises.length>0&&e.jsx("div",{className:"space-y-3 mb-4",children:d.exercises.map((b,R)=>e.jsxs("div",{draggable:!0,onDragStart:A=>B(A,R),onDragOver:A=>Y(A,R),onDragEnd:k,className:`bg-white p-4 rounded-lg border-2 cursor-move transition-all ${U===R?"opacity-50 scale-95":"hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 cursor-grab",children:"â‹®â‹®"}),e.jsx("span",{className:"font-semibold text-base",children:b.name})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>T(R),className:"text-blue-500 text-lg hover:text-blue-700",title:"Duplicate exercise",children:"ðŸ“‹"}),e.jsx("button",{onClick:()=>x(R),className:"text-red-500 text-xl px-2",children:"Ã—"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-1",children:"Sets"}),e.jsx("input",{type:"number",value:b.sets,onChange:A=>m(R,"sets",A.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-base text-center font-semibold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-1",children:"Reps"}),e.jsx("input",{type:"number",value:b.reps,onChange:A=>m(R,"reps",A.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-base text-center font-semibold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold block mb-1",children:"RIR"}),e.jsx("input",{type:"number",value:b.rir,onChange:A=>m(R,"rir",A.target.value),className:"w-full px-3 py-2 border-2 rounded-lg text-base text-center font-semibold"})]})]})]},R))})]})}),e.jsx("div",{className:"flex gap-2",children:d.isRestDay?e.jsx("button",{onClick:oe,disabled:!d.name,className:"flex-1 bg-blue-500 text-white py-3 rounded-lg font-bold text-base hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"âœ“ Add Rest Day"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:oe,disabled:!d.name||d.exercises.length===0,className:"flex-1 bg-green-600 text-white py-3 rounded-lg font-bold text-base hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:w!==null?"âœ“ Update Day":"âœ“ Add Training Day"}),e.jsx("button",{onClick:()=>{const b=d.name||`Rest Day ${v.filter(R=>R.isRestDay).length+1}`;f([...v,{name:b,exercises:[],isRestDay:!0,id:Date.now()}]),u({name:"",exercises:[],isRestDay:!1})},className:"bg-blue-500 text-white px-6 py-3 rounded-lg font-bold text-base hover:bg-blue-600 whitespace-nowrap",title:"Add rest day",children:"ðŸ˜´ Add Rest"})]})}),w!==null&&e.jsx("button",{onClick:K,className:"w-full bg-gray-400 text-white py-3 rounded-lg font-bold text-base hover:bg-gray-500 mt-2",children:"Cancel Editing Day"})]}),v.length>0&&e.jsxs("div",{className:"border-2 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-semibold text-base sm:text-lg",children:["Program Days (",v.length,")"]}),e.jsx("div",{className:"text-sm text-slate-600",children:(()=>{const b=E(v);return`${b.trainingDays} training, ${b.restDays} rest`})()})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"ðŸ’¡ Drag to reorder days"}),v.map((b,R)=>e.jsxs("div",{draggable:!0,onDragStart:A=>me(A,R),onDragOver:A=>we(A,R),onDragEnd:Se,className:`mb-4 p-4 rounded-lg border cursor-move transition-all ${F===R?"opacity-50 scale-95":"hover:shadow-md"} ${b.isRestDay?"bg-blue-50 border-blue-200":"bg-slate-50 border-slate-200"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 cursor-grab",children:"â‹®â‹®"}),b.isRestDay&&e.jsx("span",{className:"text-2xl",children:"ðŸ˜´"}),e.jsxs("div",{children:[e.jsx("div",{className:`font-bold text-base ${b.isRestDay?"text-blue-900":""}`,children:b.name}),b.isRestDay&&e.jsx("div",{className:"text-xs text-blue-600",children:"Scheduled recovery"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V(R),className:"text-blue-500 text-lg hover:text-blue-700",title:"Duplicate day",children:"ðŸ“‹"}),e.jsx("button",{onClick:()=>$(R),className:`text-lg ${(S==null?void 0:S.accent)||"text-blue-500"} hover:opacity-80`,children:"âœï¸"}),e.jsx("button",{onClick:()=>re(R),className:"text-red-500 text-xl hover:text-red-700",children:"ðŸ—‘ï¸"})]})]}),!b.isRestDay&&b.exercises.map((A,M)=>e.jsxs("div",{className:"text-sm text-slate-600 py-1",children:["â€¢ ",A.name," - ",A.sets,"Ã—",A.reps," @ ",A.rir,"RIR"]},M))]},R))]}),y?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ce,disabled:v.length===0,className:"flex-1 bg-green-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-green-700 disabled:bg-slate-300",children:"Update Program"}),e.jsx("button",{onClick:ee,className:"flex-1 bg-gray-400 text-white py-4 rounded-lg font-bold text-lg hover:bg-gray-500",children:"Cancel"})]}):e.jsx("button",{onClick:Ne,disabled:v.length===0,className:`w-full text-white py-4 rounded-lg font-bold text-lg disabled:bg-slate-300 ${(S==null?void 0:S.primary)||"bg-blue-600 hover:bg-blue-700"}`,children:"Save Program"})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold mb-4",children:["Saved Programs (",t.length,")"]}),t.length===0?e.jsx("p",{className:"text-slate-500 text-center py-8",children:"No programs yet"}):e.jsx("div",{className:"space-y-4 stagger-children",children:t.map(b=>{const R=E(b.days);return e.jsxs("div",{className:"border-2 p-5 rounded-lg hover:shadow-md transition-shadow card-hover",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-xl",children:b.name}),e.jsxs("div",{className:"text-sm text-slate-600 mt-1",children:[R.trainingDays," training days Â· ",R.restDays," rest days Â· ",R.totalExercises," exercises"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Ee(b),className:"text-blue-500 text-xl hover:text-blue-700",title:"Duplicate program",children:"ðŸ“‹"}),e.jsx("button",{onClick:()=>be(b),className:`text-xl ${(S==null?void 0:S.accent)||"text-blue-500"} hover:opacity-80`,children:"âœï¸"}),e.jsx("button",{onClick:()=>{confirm(`Delete ${b.name}?`)&&g(b.id)},className:"text-red-500 text-xl hover:text-red-700",children:"ðŸ—‘ï¸"}),e.jsx("button",{onClick:()=>o(b.id),disabled:r&&r.id===b.id,className:"bg-green-600 text-white px-5 py-2 rounded-lg text-base font-semibold hover:bg-green-700 disabled:bg-green-300",children:r&&r.id===b.id?"âœ“ Active":"Start"})]})]}),e.jsx("div",{className:"space-y-3",children:b.days.map((A,M)=>e.jsxs("div",{className:`pl-4 border-l-4 ${A.isRestDay?"border-blue-400 bg-blue-50 p-2 rounded":(S==null?void 0:S.primary.split(" ")[0].replace("bg-","border-"))||"border-blue-500"}`,children:[e.jsxs("div",{className:"font-semibold text-base mb-1 flex items-center gap-2",children:[A.isRestDay&&e.jsx("span",{className:"text-xl",children:"ðŸ˜´"}),"Day ",M+1,": ",A.name,A.isRestDay&&e.jsx("span",{className:"text-xs text-blue-600",children:"(Rest)"})]}),!A.isRestDay&&A.exercises.map((G,J)=>e.jsxs("div",{className:"text-sm text-slate-600",children:["â€¢ ",G.name," - ",G.sets,"Ã—",G.reps," @ ",G.rir,"RIR"]},J))]},M))})]},b.id)})})]})]})}function Is({settings:t,onUpdateSetting:s,onResetSettings:r,themeColors:a}){const{changePassword:n}=ut(),[l,g]=c.useState(""),[o,i]=c.useState(""),[S,p]=c.useState(""),[N,v]=c.useState(""),[f,d]=c.useState(""),u=h=>{s("themeColor",h)},y=h=>{s("restTimerEnabled",h)},C=h=>{s("defaultRestTime",parseInt(h))},w=async h=>{if(h.preventDefault(),v(""),o!==S){v("New passwords do not match"),d("error");return}const F=await n(l,o);F.success?(v("Password changed successfully!"),d("success"),g(""),i(""),p("")):(v(F.error),d("error"))};return e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-4 sm:p-6 max-w-3xl mx-auto animate-fadeIn",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6",children:"Settings"}),e.jsxs("div",{className:"mb-8 pb-8 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Theme Color"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Choose your preferred accent color for buttons and highlights"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:Object.entries(a).map(([h,F])=>e.jsx("button",{onClick:()=>u(h),className:`
                relative p-4 rounded-lg border-2 transition-all card-hover
                ${t.themeColor===h?"border-gray-900 shadow-md scale-105":"border-gray-200 hover:border-gray-400"}
              `,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`w-12 h-12 rounded-full ${F.primary.split(" ")[0]}`}),e.jsx("span",{className:"text-sm font-medium",children:F.name}),t.themeColor===h&&e.jsx("span",{className:"text-xs text-green-600 font-semibold",children:"âœ“ Active"})]})},h))})]}),e.jsxs("div",{className:"mb-8 pb-8 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Rest Timer"}),e.jsx("div",{className:"mb-6",children:e.jsxs("label",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Enable Rest Timer"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Automatically start a countdown timer after each set"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:t.restTimerEnabled,onChange:h=>y(h.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-14 h-8 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-blue-600"})]})]})}),e.jsxs("div",{className:`transition-opacity ${t.restTimerEnabled?"opacity-100":"opacity-50"}`,children:[e.jsxs("label",{className:"block mb-3",children:[e.jsx("span",{className:"font-semibold block mb-2",children:"Default Rest Time"}),e.jsx("span",{className:"text-sm text-gray-600 block mb-3",children:"How long should the rest timer count down by default?"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-4",children:[60,90,120,150,180,240,300].map(h=>e.jsx("button",{onClick:()=>C(h),disabled:!t.restTimerEnabled,className:`
                  px-4 py-3 rounded-lg border-2 font-semibold transition-all btn-press
                  ${t.defaultRestTime===h?"border-blue-600 bg-blue-50 text-blue-900":"border-gray-200 bg-white hover:border-gray-400"}
                  ${!t.restTimerEnabled&&"cursor-not-allowed"}
                `,children:h<60?`${h}s`:`${Math.floor(h/60)}:${(h%60).toString().padStart(2,"0")}`},h))}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2 text-sm font-medium",children:"Or enter custom time (seconds):"}),e.jsx("input",{type:"number",value:t.defaultRestTime,onChange:h=>C(h.target.value),disabled:!t.restTimerEnabled,min:"10",max:"600",className:"w-full sm:w-48 px-4 py-2 border-2 rounded-lg text-lg font-semibold text-center disabled:bg-gray-100 disabled:cursor-not-allowed"})]})]})]}),e.jsxs("div",{className:"mb-8 pb-8 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Change Password"}),e.jsxs("form",{onSubmit:w,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Current Password"}),e.jsx("input",{type:"password",value:l,onChange:h=>g(h.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none",placeholder:"Enter current password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"New Password"}),e.jsx("input",{type:"password",value:o,onChange:h=>i(h.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none",placeholder:"Enter new password (min 6 chars)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:S,onChange:h=>p(h.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none",placeholder:"Confirm new password"})]}),N&&e.jsx("div",{className:`p-3 rounded-lg ${f==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:N}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 font-semibold transition-colors",children:"Change Password"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Reset"}),e.jsx("button",{onClick:()=>{confirm("Reset all settings to default values?")&&r()},className:"px-6 py-3 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-colors",children:"Reset to Defaults"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"This will restore all settings to their original values"})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Current Settings"}),e.jsxs("div",{className:"text-sm space-y-1 text-gray-700",children:[e.jsxs("div",{children:["Theme: ",e.jsx("span",{className:"font-medium",children:a[t.themeColor].name})]}),e.jsxs("div",{children:["Rest Timer: ",e.jsx("span",{className:"font-medium",children:t.restTimerEnabled?"Enabled":"Disabled"})]}),e.jsxs("div",{children:["Default Rest Time: ",e.jsxs("span",{className:"font-medium",children:[t.defaultRestTime,"s (",Math.floor(t.defaultRestTime/60),":",(t.defaultRestTime%60).toString().padStart(2,"0"),")"]})]})]})]})]})}function _s(){const[t,s]=c.useState("session"),[r,a]=c.useState(!1),{userId:n,username:l,isAuthenticated:g,isLoading:o,login:i,logout:S}=ut(),{settings:p,updateSetting:N,resetSettings:v,themeColors:f,currentTheme:d}=ys(n),{workouts:u,updateSession:y,deleteWorkout:C}=rs(n),{exercises:w,addExercise:h,updateExercise:F,deleteExercise:_,resetToPresets:U}=ns(),{programs:L,activeProgram:O,currentDayIndex:j,addProgram:H,updateProgram:m,deleteProgram:x,startProgram:T,stopProgram:B,advanceToNextDay:Y,getCurrentDay:k}=ls(n),{localFatigue:$,weeklyStimulus:V,muscleReadiness:z,systemicReadiness:K,lastWorkoutDate:oe,readinessHistory:re,processWorkoutSession:me}=bs(n,u),we=fs(),Se=X=>{const E=u.map(I=>I.timestamp===X.timestamp?X:I);Q.saveUserData("workouts",E,n)},Ne=async X=>{await C(X)},be=async(X,E)=>{if(console.log("ðŸŸ¡ APP handleAutoSave CALLED"),console.log("  Session:",X),console.log("  Session length:",X.length),console.log("  Date:",E),X.length===0){console.log("  âš ï¸ Empty session - skipping");return}try{console.log("  â³ Calling updateSession..."),await y(X,E),console.log("  âœ… handleAutoSave COMPLETE")}catch(I){console.error("  âŒ Auto-save failed:",I)}},Ee=async(X,E,I,b)=>{const R=k(),A=(R==null?void 0:R.isRestDay)||!1,M=O?{activeProgram:O,currentDayIndex:j,lastDayIndex:j>0?j-1:O.days.length-1,isRestDay:A}:null;A?await me([],E,{perceivedFatigue:I,muscleSoreness:b},M):await me(X,E,{perceivedFatigue:I,muscleSoreness:b},M),O&&Y()},ce=async(X,E,I)=>{console.log("ðŸ’¾ handleSaveRecoveryOnly called:"),console.log("  date:",X),console.log("  perceivedFatigue:",E),console.log("  muscleSoreness:",I);try{await me([],X,{perceivedFatigue:E,muscleSoreness:I},null)}catch(b){console.error("Failed to save recovery data:",b)}},ee=()=>{const X=k();return X||(alert("No program day to load"),null)};return o?e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center",children:e.jsx("div",{className:"text-white text-2xl",children:"Loading..."})}):g?e.jsx("div",{className:`min-h-screen p-4 transition-colors duration-300 ${p.themeColor==="blue"?"bg-gradient-to-br from-slate-900 to-blue-900":p.themeColor==="green"?"bg-gradient-to-br from-slate-900 to-green-900":p.themeColor==="purple"?"bg-gradient-to-br from-slate-900 to-purple-900":p.themeColor==="orange"?"bg-gradient-to-br from-slate-900 to-orange-900":p.themeColor==="red"?"bg-gradient-to-br from-slate-900 to-red-900":p.themeColor==="indigo"?"bg-gradient-to-br from-slate-900 to-indigo-900":p.themeColor==="pink"?"bg-gradient-to-br from-slate-900 to-pink-900":p.themeColor==="teal"?"bg-gradient-to-br from-slate-900 to-teal-900":"bg-gradient-to-br from-slate-900 to-slate-800"}`,children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:()=>a(!r),className:"text-white p-2 hover:bg-slate-700 rounded-lg transition-colors","aria-label":"Menu",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"text-white",children:[e.jsx("span",{className:"text-sm opacity-75",children:"Logged in as:"}),e.jsx("span",{className:"ml-2 font-semibold",children:l})]}),e.jsx("button",{onClick:S,className:"text-white text-sm opacity-75 hover:opacity-100 underline transition-opacity",children:"Logout"})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 animate-fadeIn",onClick:()=>a(!1)}),e.jsxs("div",{className:"fixed top-0 left-0 h-full w-64 bg-white shadow-2xl z-50 flex flex-col animate-slideInLeft",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"font-bold text-xl",children:"Menu"}),e.jsx("button",{onClick:()=>a(!1),className:"text-gray-500 hover:text-gray-700 text-2xl transition-transform hover:rotate-90",children:"Ã—"})]}),e.jsxs("nav",{className:"flex-1 overflow-y-auto py-4 stagger-children",children:[e.jsxs("button",{onClick:()=>{s("session"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="session"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ’ª"}),e.jsx("span",{children:"Session"})]}),e.jsxs("button",{onClick:()=>{s("history"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="history"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ“Š"}),e.jsx("span",{children:"History"})]}),e.jsxs("button",{onClick:()=>{s("recovery"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="recovery"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"â¤ï¸"}),e.jsx("span",{children:"Recovery"})]}),e.jsxs("button",{onClick:()=>{s("exercises"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="exercises"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ‹ï¸"}),e.jsx("span",{children:"Exercises"})]}),e.jsxs("button",{onClick:()=>{s("programs"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="programs"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"ðŸ“…"}),e.jsx("span",{children:"Programs"})]}),e.jsx("div",{className:"my-2 border-t"}),e.jsxs("button",{onClick:()=>{s("settings"),a(!1)},className:`w-full text-left px-6 py-4 font-semibold transition-colors flex items-center gap-3 ${t==="settings"?`${d.light} ${d.text} border-l-4 ${d.primary.split(" ")[0].replace("bg-","border-")}`:"hover:bg-slate-50"}`,children:[e.jsx("span",{className:"text-xl",children:"âš™ï¸"}),e.jsx("span",{children:"Settings"})]})]}),e.jsx("div",{className:"p-4 border-t bg-slate-50",children:e.jsx("div",{className:"text-xs text-slate-600 text-center",children:"Workout Tracker v1.0"})})]})]}),t==="session"&&e.jsx(Rs,{exercises:w,workouts:u,muscleReadiness:z,systemicReadiness:K,weeklyStimulus:V,activeProgram:O,currentDayIndex:j,getCurrentDay:k,onSessionComplete:Ee,onAutoSave:be,onSaveRecoveryOnly:ce,onLoadProgramDay:ee,useRestTimer:()=>we,settings:p,theme:d}),t==="history"&&e.jsx(Ds,{workouts:u,readinessHistory:re,onUpdateWorkout:Se,onDeleteWorkout:Ne,theme:d}),t==="recovery"&&e.jsx(Ls,{muscleReadiness:z,systemicReadiness:K,weeklyStimulus:V,localFatigue:$,lastWorkoutDate:oe,workouts:u,theme:d}),t==="exercises"&&e.jsx(Ps,{exercises:w,onAddExercise:h,onUpdateExercise:F,onDeleteExercise:_,onResetToPresets:U,theme:d}),t==="programs"&&e.jsx(Ms,{programs:L,exercises:w,activeProgram:O,currentDayIndex:j,onAddProgram:H,onUpdateProgram:m,onDeleteProgram:x,onStartProgram:T,onStopProgram:B,theme:d}),t==="settings"&&e.jsx(Is,{settings:p,onUpdateSetting:N,onResetSettings:v,themeColors:f})]})}):e.jsx(vs,{onLogin:i})}qe.createRoot(document.getElementById("root")).render(e.jsx(ft.StrictMode,{children:e.jsx(_s,{})}));
